[0m11:48:31.344610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c790098770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c78fd7e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c78fd7f5f0>]}


============================== 11:48:31.349981 | 598261ef-0a5b-4de4-bc67-b33ee48b6c85 ==============================
[0m11:48:31.349981 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:48:31.350616 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'empty': 'False', 'no_print': 'None', 'log_path': '/root/airflow/store_pipeline/logs', 'warn_error': 'None', 'target_path': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'profiles_dir': '/root/.dbt', 'version_check': 'True'}
[0m11:48:31.630317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '598261ef-0a5b-4de4-bc67-b33ee48b6c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c78596b5c0>]}
[0m11:48:31.678573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '598261ef-0a5b-4de4-bc67-b33ee48b6c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c78f491cd0>]}
[0m11:48:31.681782 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m11:48:31.728073 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:48:31.728489 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:48:31.728753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '598261ef-0a5b-4de4-bc67-b33ee48b6c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c78f444dd0>]}
[0m11:48:32.240970 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m11:48:32.244535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '598261ef-0a5b-4de4-bc67-b33ee48b6c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c78f3d64e0>]}
[0m11:48:32.267532 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/store_pipeline/target/manifest.json
[0m11:48:32.269399 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/store_pipeline/target/semantic_manifest.json
[0m11:48:32.288687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '598261ef-0a5b-4de4-bc67-b33ee48b6c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c78f393020>]}
[0m11:48:32.289060 [info ] [MainThread]: Found 444 macros
[0m11:48:32.289351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '598261ef-0a5b-4de4-bc67-b33ee48b6c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c7858f1100>]}
[0m11:48:32.290260 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:48:32.290800 [debug] [MainThread]: Command end result
[0m11:48:32.299834 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/store_pipeline/target/manifest.json
[0m11:48:32.300830 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/store_pipeline/target/semantic_manifest.json
[0m11:48:32.302834 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/store_pipeline/target/run_results.json
[0m11:48:32.304447 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0073261, "process_in_blocks": "125176", "process_kernel_time": 0.199725, "process_mem_max_rss": "133860", "process_out_blocks": "2664", "process_user_time": 1.882522}
[0m11:48:32.304784 [debug] [MainThread]: Command `dbt run` succeeded at 11:48:32.304701 after 1.01 seconds
[0m11:48:32.305062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c7854f8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c7854f8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c78f391070>]}
[0m11:48:32.305286 [debug] [MainThread]: Flushing usage events
[0m11:48:33.260343 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:24.371062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f7e9c5a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f7ec084800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f7ea02faa0>]}


============================== 12:47:24.374675 | 537d546c-72bf-4618-bf8c-5b38f7f90db7 ==============================
[0m12:47:24.374675 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:47:24.375107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'introspect': 'True', 'write_json': 'True', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'empty': 'False', 'quiet': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'target_path': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'warn_error': 'None'}
[0m12:47:24.574139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '537d546c-72bf-4618-bf8c-5b38f7f90db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f7e93b3f20>]}
[0m12:47:24.621209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '537d546c-72bf-4618-bf8c-5b38f7f90db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f7ebc77200>]}
[0m12:47:24.623102 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m12:47:24.670099 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:47:24.733822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m12:47:24.734217 [debug] [MainThread]: Partial parsing: added file: store_pipeline://models/stg/stg_users.sql
[0m12:47:24.734445 [debug] [MainThread]: Partial parsing: added file: store_pipeline://models/stg/stg_carts.sql
[0m12:47:24.734622 [debug] [MainThread]: Partial parsing: added file: store_pipeline://models/stg/stg_products.sql
[0m12:47:24.734846 [debug] [MainThread]: Partial parsing: updated file: store_pipeline://models/source.yml
[0m12:47:25.081320 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m12:47:25.087956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '537d546c-72bf-4618-bf8c-5b38f7f90db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f7df997020>]}
[0m12:47:25.132155 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:47:25.133573 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:47:25.153121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '537d546c-72bf-4618-bf8c-5b38f7f90db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f7e9c592b0>]}
[0m12:47:25.153525 [info ] [MainThread]: Found 3 models, 3 sources, 444 macros
[0m12:47:25.153785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '537d546c-72bf-4618-bf8c-5b38f7f90db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f7dc30f350>]}
[0m12:47:25.155189 [info ] [MainThread]: 
[0m12:47:25.155479 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:25.155689 [info ] [MainThread]: 
[0m12:47:25.156025 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:47:25.160302 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:47:25.187132 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:47:25.187447 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:47:25.187637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:25.202043 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:47:25.203199 [debug] [ThreadPool]: On list_dev: Close
[0m12:47:25.204243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:47:25.204897 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:47:25.209525 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:47:25.209787 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:47:25.210030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:25.211929 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:47:25.212930 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:47:25.213234 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:47:25.213721 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:47:25.213922 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:47:25.214079 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:47:25.214601 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:47:25.215141 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:47:25.215334 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:47:25.215489 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:47:25.215894 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:47:25.216095 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:47:25.217372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:47:25.221483 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:47:25.221764 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:47:25.221954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:25.222638 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:47:25.222886 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:47:25.223058 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:47:25.233718 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:47:25.234861 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:47:25.236067 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:47:25.236305 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:47:25.237358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '537d546c-72bf-4618-bf8c-5b38f7f90db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f7e94087a0>]}
[0m12:47:25.237823 [debug] [MainThread]: Using duckdb connection "master"
[0m12:47:25.238260 [debug] [MainThread]: On master: BEGIN
[0m12:47:25.238429 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:25.239085 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:47:25.239296 [debug] [MainThread]: On master: COMMIT
[0m12:47:25.239555 [debug] [MainThread]: Using duckdb connection "master"
[0m12:47:25.239705 [debug] [MainThread]: On master: COMMIT
[0m12:47:25.240265 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:47:25.240660 [debug] [MainThread]: On master: Close
[0m12:47:25.244538 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m12:47:25.245015 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_carts ..................................... [RUN]
[0m12:47:25.245437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m12:47:25.245660 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m12:47:25.251793 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m12:47:25.252937 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m12:47:25.328601 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_carts"
[0m12:47:25.329837 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:47:25.330198 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: BEGIN
[0m12:47:25.330500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:25.331505 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:47:25.331763 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:47:25.331955 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m12:47:25.335304 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m12:47:25.335607 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:47:25.335929 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: ROLLBACK
[0m12:47:25.340647 [debug] [Thread-1 (]: Failed to rollback 'model.store_pipeline.stg_carts'
[0m12:47:25.341007 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: Close
[0m12:47:25.343026 [debug] [Thread-1 (]: Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^
[0m12:47:25.344592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '537d546c-72bf-4618-bf8c-5b38f7f90db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f7ea3ba930>]}
[0m12:47:25.345169 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_carts ............................ [[31mERROR[0m in 0.10s]
[0m12:47:25.345597 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m12:47:25.345861 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m12:47:25.346188 [debug] [Thread-4 (]: Marking all children of 'model.store_pipeline.stg_carts' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^.
[0m12:47:25.346583 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_products .................................. [RUN]
[0m12:47:25.347466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m12:47:25.347685 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m12:47:25.349472 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m12:47:25.350042 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m12:47:25.352239 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_products"
[0m12:47:25.352696 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:47:25.352916 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: BEGIN
[0m12:47:25.353191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:25.354077 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:47:25.354325 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:47:25.354544 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH raw_products AS(
    SELECT * FROM "dev"."main"."products"
)
SELECT CAST(id AS INT) AS product_id, 
        CAST(title AS VARCHAR) AS product_title,
        CAST(price AS FLOAT) AS product_price,
        CAST(description AS VARCHAR) AS product_description,
        CAST(category AS VARCHAR) AS product_category,
        CAST(rating_rate AS FLOAT) AS product_rating_rate,
        CAST(rating_count AS INT) AS product_rating_count
FROM raw_products
  );

[0m12:47:25.355388 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:47:25.360755 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:47:25.361107 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:47:25.361985 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:47:25.369249 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m12:47:25.369575 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:47:25.369843 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m12:47:25.373700 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:47:25.377958 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:47:25.378290 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m12:47:25.379012 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:47:25.380606 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: Close
[0m12:47:25.381196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '537d546c-72bf-4618-bf8c-5b38f7f90db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f7ebd97440>]}
[0m12:47:25.381607 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.03s]
[0m12:47:25.382006 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m12:47:25.382290 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m12:47:25.382658 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_users ..................................... [RUN]
[0m12:47:25.383089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m12:47:25.383406 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m12:47:25.385589 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m12:47:25.386095 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m12:47:25.387972 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_users"
[0m12:47:25.388349 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:47:25.388565 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: BEGIN
[0m12:47:25.388738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:25.389709 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:47:25.390024 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:47:25.390339 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    WITH raw_users AS(
    SELECT * FROM "dev"."main"."users"
)
SELECT CAST(id AS INT) AS user_id, 
        CAST(email AS VARCHAR) AS user_email,
        CAST(username AS VARCHAR) AS user_username,
        CAST(password AS VARCHAR) AS user_password,
        CAST(name_firstname AS VARCHAR) AS user_name_firstname,
        CAST(name_lastname AS VARCHAR) AS user_name_lastname,
        CAST(address_city AS VARCHAR) AS user_address_city,
        CAST(address_street AS VARCHAR) AS user_address_street,
        CAST(address_number AS INT) AS user_address_number,
        CAST(address_zipcode AS VARCHAR) AS user_address_zipcode,
        CAST(phone AS VARCHAR) AS user_phone
FROM raw_users
  );

[0m12:47:25.391365 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:47:25.393219 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:47:25.393461 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m12:47:25.394005 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:47:25.394871 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m12:47:25.395090 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:47:25.395306 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m12:47:25.398840 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:47:25.401744 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:47:25.402074 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m12:47:25.402748 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:47:25.404161 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: Close
[0m12:47:25.404728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '537d546c-72bf-4618-bf8c-5b38f7f90db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f7df5ad040>]}
[0m12:47:25.405234 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.02s]
[0m12:47:25.405673 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m12:47:25.406792 [debug] [MainThread]: Using duckdb connection "master"
[0m12:47:25.407004 [debug] [MainThread]: On master: BEGIN
[0m12:47:25.407173 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:47:25.407775 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:47:25.407969 [debug] [MainThread]: On master: COMMIT
[0m12:47:25.408128 [debug] [MainThread]: Using duckdb connection "master"
[0m12:47:25.408269 [debug] [MainThread]: On master: COMMIT
[0m12:47:25.408617 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:47:25.408810 [debug] [MainThread]: On master: Close
[0m12:47:25.409108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:25.409383 [debug] [MainThread]: Connection 'model.store_pipeline.stg_users' was properly closed.
[0m12:47:25.409699 [info ] [MainThread]: 
[0m12:47:25.410000 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m12:47:25.410562 [debug] [MainThread]: Command end result
[0m12:47:25.421167 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:47:25.422348 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:47:25.426699 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m12:47:25.426967 [info ] [MainThread]: 
[0m12:47:25.427233 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:47:25.427453 [info ] [MainThread]: 
[0m12:47:25.427688 [error] [MainThread]: [31mFailure in model stg_carts (models/stg/stg_carts.sql)[0m
[0m12:47:25.427905 [error] [MainThread]:   Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^
[0m12:47:25.428092 [info ] [MainThread]: 
[0m12:47:25.428294 [info ] [MainThread]:   compiled code at target/compiled/store_pipeline/models/stg/stg_carts.sql
[0m12:47:25.428483 [info ] [MainThread]: 
[0m12:47:25.428675 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m12:47:25.429340 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1111134, "process_in_blocks": "42112", "process_kernel_time": 0.30055, "process_mem_max_rss": "155700", "process_out_blocks": "2848", "process_user_time": 2.041238}
[0m12:47:25.429700 [debug] [MainThread]: Command `dbt run` failed at 12:47:25.429624 after 1.11 seconds
[0m12:47:25.429974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f7e9c12fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f7ea05ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f7ea05d8e0>]}
[0m12:47:25.430258 [debug] [MainThread]: Flushing usage events
[0m12:47:26.336635 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:48:25.732052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723a4e742e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723a4ed730b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723a4e1b9730>]}


============================== 12:48:25.734442 | f996c117-fb33-4453-ac9a-8ce67356ba40 ==============================
[0m12:48:25.734442 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:48:25.734883 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'introspect': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'fail_fast': 'False', 'version_check': 'True', 'target_path': 'None', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': '/root/.dbt', 'cache_selected_only': 'False', 'empty': 'False'}
[0m12:48:25.910087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f996c117-fb33-4453-ac9a-8ce67356ba40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723a4d3148c0>]}
[0m12:48:25.970733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f996c117-fb33-4453-ac9a-8ce67356ba40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723a437230e0>]}
[0m12:48:25.971841 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m12:48:26.012244 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:48:26.078282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:48:26.078578 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:48:26.083259 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m12:48:26.102218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f996c117-fb33-4453-ac9a-8ce67356ba40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723a4d1e9070>]}
[0m12:48:26.148725 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:48:26.150022 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:48:26.158865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f996c117-fb33-4453-ac9a-8ce67356ba40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723a43393080>]}
[0m12:48:26.159421 [info ] [MainThread]: Found 3 models, 3 sources, 444 macros
[0m12:48:26.160195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f996c117-fb33-4453-ac9a-8ce67356ba40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723a43355eb0>]}
[0m12:48:26.161544 [info ] [MainThread]: 
[0m12:48:26.161877 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:48:26.162083 [info ] [MainThread]: 
[0m12:48:26.162407 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:48:26.165999 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:48:26.190946 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:48:26.191296 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:48:26.191488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:26.203081 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:48:26.204025 [debug] [ThreadPool]: On list_dev: Close
[0m12:48:26.204664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:48:26.205063 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:48:26.209691 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:48:26.210067 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:48:26.210257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:48:26.211605 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:48:26.212734 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:48:26.213029 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:48:26.213610 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:48:26.213884 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:48:26.214042 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:48:26.214600 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:48:26.215190 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:48:26.215395 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:48:26.215591 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:48:26.216034 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:48:26.216276 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:48:26.217294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:48:26.222523 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:48:26.222824 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:48:26.222996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:48:26.223760 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:48:26.224061 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:48:26.224236 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:48:26.233209 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m12:48:26.234265 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:48:26.235047 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:48:26.235250 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:48:26.236293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f996c117-fb33-4453-ac9a-8ce67356ba40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723a4d1c3440>]}
[0m12:48:26.236593 [debug] [MainThread]: Using duckdb connection "master"
[0m12:48:26.236784 [debug] [MainThread]: On master: BEGIN
[0m12:48:26.236938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:26.237674 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:48:26.237986 [debug] [MainThread]: On master: COMMIT
[0m12:48:26.238210 [debug] [MainThread]: Using duckdb connection "master"
[0m12:48:26.238382 [debug] [MainThread]: On master: COMMIT
[0m12:48:26.238954 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:48:26.239182 [debug] [MainThread]: On master: Close
[0m12:48:26.241244 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m12:48:26.241639 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_carts ..................................... [RUN]
[0m12:48:26.242058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m12:48:26.242298 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m12:48:26.247328 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m12:48:26.247997 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m12:48:26.275497 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_carts"
[0m12:48:26.276304 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:48:26.276632 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: BEGIN
[0m12:48:26.276937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:26.278302 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:48:26.278624 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:48:26.278860 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m12:48:26.280141 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m12:48:26.280488 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:48:26.280813 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: ROLLBACK
[0m12:48:26.283404 [debug] [Thread-1 (]: Failed to rollback 'model.store_pipeline.stg_carts'
[0m12:48:26.283800 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: Close
[0m12:48:26.285544 [debug] [Thread-1 (]: Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^
[0m12:48:26.286724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f996c117-fb33-4453-ac9a-8ce67356ba40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723a4274d340>]}
[0m12:48:26.287208 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_carts ............................ [[31mERROR[0m in 0.04s]
[0m12:48:26.287611 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m12:48:26.287891 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m12:48:26.288545 [debug] [Thread-4 (]: Marking all children of 'model.store_pipeline.stg_carts' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^.
[0m12:48:26.288224 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_products .................................. [RUN]
[0m12:48:26.289597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m12:48:26.290050 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m12:48:26.292721 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m12:48:26.293301 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m12:48:26.295551 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_products"
[0m12:48:26.295996 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:48:26.296258 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: BEGIN
[0m12:48:26.296648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:26.297733 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:48:26.298034 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:48:26.298265 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH raw_products AS(
    SELECT * FROM "dev"."main"."products"
)
SELECT CAST(id AS INT) AS product_id, 
        CAST(title AS VARCHAR) AS product_title,
        CAST(price AS FLOAT) AS product_price,
        CAST(description AS VARCHAR) AS product_description,
        CAST(category AS VARCHAR) AS product_category,
        CAST(rating_rate AS FLOAT) AS product_rating_rate,
        CAST(rating_count AS INT) AS product_rating_count
FROM raw_products
  );

[0m12:48:26.298963 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:48:26.303105 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:48:26.303456 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m12:48:26.304180 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:48:26.306074 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:48:26.306449 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:48:26.307020 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:48:26.315554 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m12:48:26.316118 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:48:26.316450 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m12:48:26.320084 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:48:26.324464 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:48:26.324813 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m12:48:26.327818 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:48:26.329868 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: Close
[0m12:48:26.330757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f996c117-fb33-4453-ac9a-8ce67356ba40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723a4fbc32f0>]}
[0m12:48:26.331482 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.04s]
[0m12:48:26.332029 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m12:48:26.332420 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m12:48:26.332779 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_users ..................................... [RUN]
[0m12:48:26.333195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m12:48:26.333412 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m12:48:26.337202 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m12:48:26.337823 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m12:48:26.339773 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_users"
[0m12:48:26.340201 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:48:26.340462 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: BEGIN
[0m12:48:26.340644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:26.341298 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:48:26.341521 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:48:26.341737 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    WITH raw_users AS(
    SELECT * FROM "dev"."main"."users"
)
SELECT CAST(id AS INT) AS user_id, 
        CAST(email AS VARCHAR) AS user_email,
        CAST(username AS VARCHAR) AS user_username,
        CAST(password AS VARCHAR) AS user_password,
        CAST(name_firstname AS VARCHAR) AS user_name_firstname,
        CAST(name_lastname AS VARCHAR) AS user_name_lastname,
        CAST(address_city AS VARCHAR) AS user_address_city,
        CAST(address_street AS VARCHAR) AS user_address_street,
        CAST(address_number AS INT) AS user_address_number,
        CAST(address_zipcode AS VARCHAR) AS user_address_zipcode,
        CAST(phone AS VARCHAR) AS user_phone
FROM raw_users
  );

[0m12:48:26.343107 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:48:26.345022 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:48:26.345302 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m12:48:26.346085 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:48:26.347700 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:48:26.347982 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m12:48:26.348786 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:48:26.350002 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m12:48:26.350330 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:48:26.350533 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m12:48:26.353479 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:48:26.355027 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:48:26.355424 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m12:48:26.358347 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:48:26.359305 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: Close
[0m12:48:26.359743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f996c117-fb33-4453-ac9a-8ce67356ba40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723a4d215940>]}
[0m12:48:26.360162 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.03s]
[0m12:48:26.360525 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m12:48:26.361729 [debug] [MainThread]: Using duckdb connection "master"
[0m12:48:26.362068 [debug] [MainThread]: On master: BEGIN
[0m12:48:26.362258 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:48:26.362968 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:48:26.363198 [debug] [MainThread]: On master: COMMIT
[0m12:48:26.363377 [debug] [MainThread]: Using duckdb connection "master"
[0m12:48:26.363549 [debug] [MainThread]: On master: COMMIT
[0m12:48:26.364000 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:48:26.364218 [debug] [MainThread]: On master: Close
[0m12:48:26.364524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:26.364693 [debug] [MainThread]: Connection 'model.store_pipeline.stg_users' was properly closed.
[0m12:48:26.364915 [info ] [MainThread]: 
[0m12:48:26.365151 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m12:48:26.365757 [debug] [MainThread]: Command end result
[0m12:48:26.376832 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:48:26.378001 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:48:26.382145 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m12:48:26.382449 [info ] [MainThread]: 
[0m12:48:26.382705 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:48:26.382911 [info ] [MainThread]: 
[0m12:48:26.383151 [error] [MainThread]: [31mFailure in model stg_carts (models/stg/stg_carts.sql)[0m
[0m12:48:26.383381 [error] [MainThread]:   Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^
[0m12:48:26.383557 [info ] [MainThread]: 
[0m12:48:26.383769 [info ] [MainThread]:   compiled code at target/compiled/store_pipeline/models/stg/stg_carts.sql
[0m12:48:26.383952 [info ] [MainThread]: 
[0m12:48:26.384139 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m12:48:26.384758 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6941965, "process_in_blocks": "0", "process_kernel_time": 0.203724, "process_mem_max_rss": "151460", "process_out_blocks": "1976", "process_user_time": 1.706194}
[0m12:48:26.385038 [debug] [MainThread]: Command `dbt run` failed at 12:48:26.384979 after 0.69 seconds
[0m12:48:26.385258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723a4da1eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723a4d97d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723a4d2f7bc0>]}
[0m12:48:26.385474 [debug] [MainThread]: Flushing usage events
[0m12:48:27.317387 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:48:28.972508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c952268f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9522c5baa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c952268ef00>]}


============================== 12:48:28.975355 | a3764e8d-6350-4f2c-9a9c-1152a43e2360 ==============================
[0m12:48:28.975355 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:48:28.976095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': '/root/.dbt', 'introspect': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error': 'None', 'version_check': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'debug': 'False', 'target_path': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None'}
[0m12:48:29.170995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3764e8d-6350-4f2c-9a9c-1152a43e2360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c95247844a0>]}
[0m12:48:29.228934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3764e8d-6350-4f2c-9a9c-1152a43e2360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9521db3fb0>]}
[0m12:48:29.230121 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m12:48:29.275751 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:48:29.357037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:48:29.357337 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:48:29.361647 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m12:48:29.380450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3764e8d-6350-4f2c-9a9c-1152a43e2360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9518253170>]}
[0m12:48:29.428250 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:48:29.429598 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:48:29.438962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3764e8d-6350-4f2c-9a9c-1152a43e2360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9517f090a0>]}
[0m12:48:29.440004 [info ] [MainThread]: Found 3 models, 3 sources, 444 macros
[0m12:48:29.440535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3764e8d-6350-4f2c-9a9c-1152a43e2360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9518334a70>]}
[0m12:48:29.442544 [info ] [MainThread]: 
[0m12:48:29.442893 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:48:29.443132 [info ] [MainThread]: 
[0m12:48:29.443476 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:48:29.447543 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:48:29.478875 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:48:29.479464 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:48:29.479809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:29.494095 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:48:29.495236 [debug] [ThreadPool]: On list_dev: Close
[0m12:48:29.496520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:48:29.497552 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:48:29.503942 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:48:29.504371 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:48:29.504773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:48:29.506693 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:48:29.507858 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:48:29.508187 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:48:29.508869 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:48:29.509132 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:48:29.509340 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:48:29.510263 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:48:29.511080 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:48:29.511490 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:48:29.511794 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:48:29.512572 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:48:29.512889 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:48:29.514298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:48:29.519975 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:48:29.520307 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:48:29.520481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:48:29.521458 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:48:29.521891 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:48:29.522170 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:48:29.532532 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:48:29.533816 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:48:29.534665 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:48:29.534904 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:48:29.536167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3764e8d-6350-4f2c-9a9c-1152a43e2360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9521d68530>]}
[0m12:48:29.536599 [debug] [MainThread]: Using duckdb connection "master"
[0m12:48:29.536989 [debug] [MainThread]: On master: BEGIN
[0m12:48:29.537205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:29.538519 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:48:29.538994 [debug] [MainThread]: On master: COMMIT
[0m12:48:29.539250 [debug] [MainThread]: Using duckdb connection "master"
[0m12:48:29.539496 [debug] [MainThread]: On master: COMMIT
[0m12:48:29.540343 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:48:29.540653 [debug] [MainThread]: On master: Close
[0m12:48:29.542837 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m12:48:29.543373 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_carts ..................................... [RUN]
[0m12:48:29.543840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m12:48:29.544136 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m12:48:29.549654 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m12:48:29.550439 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m12:48:29.573182 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_carts"
[0m12:48:29.573759 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:48:29.574151 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: BEGIN
[0m12:48:29.574397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:29.575191 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:48:29.575434 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:48:29.575642 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m12:48:29.576630 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m12:48:29.577188 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:48:29.577711 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: ROLLBACK
[0m12:48:29.580591 [debug] [Thread-1 (]: Failed to rollback 'model.store_pipeline.stg_carts'
[0m12:48:29.580981 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: Close
[0m12:48:29.582677 [debug] [Thread-1 (]: Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^
[0m12:48:29.584222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3764e8d-6350-4f2c-9a9c-1152a43e2360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9521f09e20>]}
[0m12:48:29.584863 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_carts ............................ [[31mERROR[0m in 0.04s]
[0m12:48:29.585373 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m12:48:29.585714 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m12:48:29.586185 [debug] [Thread-4 (]: Marking all children of 'model.store_pipeline.stg_carts' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^.
[0m12:48:29.586611 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_products .................................. [RUN]
[0m12:48:29.587612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m12:48:29.587912 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m12:48:29.590269 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m12:48:29.590883 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m12:48:29.593464 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_products"
[0m12:48:29.594089 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:48:29.594429 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: BEGIN
[0m12:48:29.594623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:29.595332 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:48:29.595648 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:48:29.595949 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH raw_products AS(
    SELECT * FROM "dev"."main"."products"
)
SELECT CAST(id AS INT) AS product_id, 
        CAST(title AS VARCHAR) AS product_title,
        CAST(price AS FLOAT) AS product_price,
        CAST(description AS VARCHAR) AS product_description,
        CAST(category AS VARCHAR) AS product_category,
        CAST(rating_rate AS FLOAT) AS product_rating_rate,
        CAST(rating_count AS INT) AS product_rating_count
FROM raw_products
  );

[0m12:48:29.597890 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:48:29.603802 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:48:29.604259 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m12:48:29.605349 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:48:29.607398 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:48:29.607722 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:48:29.608780 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:48:29.618721 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m12:48:29.619118 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:48:29.619379 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m12:48:29.623374 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:48:29.628077 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:48:29.628974 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m12:48:29.632590 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:48:29.634643 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: Close
[0m12:48:29.635831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3764e8d-6350-4f2c-9a9c-1152a43e2360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c952475f560>]}
[0m12:48:29.636805 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.05s]
[0m12:48:29.637683 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m12:48:29.638297 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m12:48:29.639242 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_users ..................................... [RUN]
[0m12:48:29.640119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m12:48:29.640760 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m12:48:29.649855 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m12:48:29.650784 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m12:48:29.653437 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_users"
[0m12:48:29.654384 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:48:29.654906 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: BEGIN
[0m12:48:29.655306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:29.656588 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:48:29.657259 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:48:29.657933 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    WITH raw_users AS(
    SELECT * FROM "dev"."main"."users"
)
SELECT CAST(id AS INT) AS user_id, 
        CAST(email AS VARCHAR) AS user_email,
        CAST(username AS VARCHAR) AS user_username,
        CAST(password AS VARCHAR) AS user_password,
        CAST(name_firstname AS VARCHAR) AS user_name_firstname,
        CAST(name_lastname AS VARCHAR) AS user_name_lastname,
        CAST(address_city AS VARCHAR) AS user_address_city,
        CAST(address_street AS VARCHAR) AS user_address_street,
        CAST(address_number AS INT) AS user_address_number,
        CAST(address_zipcode AS VARCHAR) AS user_address_zipcode,
        CAST(phone AS VARCHAR) AS user_phone
FROM raw_users
  );

[0m12:48:29.662477 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:48:29.666907 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:48:29.667464 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m12:48:29.668731 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:48:29.671701 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:48:29.672198 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m12:48:29.673188 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:48:29.676212 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m12:48:29.676907 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:48:29.677396 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m12:48:29.683516 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:48:29.686779 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:48:29.687599 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m12:48:29.694114 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m12:48:29.697120 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: Close
[0m12:48:29.698380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3764e8d-6350-4f2c-9a9c-1152a43e2360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c951458acc0>]}
[0m12:48:29.699271 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.06s]
[0m12:48:29.700049 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m12:48:29.702148 [debug] [MainThread]: Using duckdb connection "master"
[0m12:48:29.702651 [debug] [MainThread]: On master: BEGIN
[0m12:48:29.702975 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:48:29.703886 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:48:29.704198 [debug] [MainThread]: On master: COMMIT
[0m12:48:29.704378 [debug] [MainThread]: Using duckdb connection "master"
[0m12:48:29.704536 [debug] [MainThread]: On master: COMMIT
[0m12:48:29.705132 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:48:29.705380 [debug] [MainThread]: On master: Close
[0m12:48:29.705817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:29.706034 [debug] [MainThread]: Connection 'model.store_pipeline.stg_users' was properly closed.
[0m12:48:29.706285 [info ] [MainThread]: 
[0m12:48:29.706568 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m12:48:29.707462 [debug] [MainThread]: Command end result
[0m12:48:29.724145 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:48:29.725733 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:48:29.731390 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m12:48:29.731683 [info ] [MainThread]: 
[0m12:48:29.731952 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:48:29.732198 [info ] [MainThread]: 
[0m12:48:29.732478 [error] [MainThread]: [31mFailure in model stg_carts (models/stg/stg_carts.sql)[0m
[0m12:48:29.732931 [error] [MainThread]:   Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^
[0m12:48:29.733364 [info ] [MainThread]: 
[0m12:48:29.733858 [info ] [MainThread]:   compiled code at target/compiled/store_pipeline/models/stg/stg_carts.sql
[0m12:48:29.734170 [info ] [MainThread]: 
[0m12:48:29.734438 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m12:48:29.735190 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8207736, "process_in_blocks": "0", "process_kernel_time": 0.232043, "process_mem_max_rss": "151496", "process_out_blocks": "1968", "process_user_time": 1.906979}
[0m12:48:29.735578 [debug] [MainThread]: Command `dbt run` failed at 12:48:29.735489 after 0.82 seconds
[0m12:48:29.735862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9522383380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9521f993d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9521eeb950>]}
[0m12:48:29.736137 [debug] [MainThread]: Flushing usage events
[0m12:48:30.497330 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:30.072614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2df8f2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2dffa3a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2dffa0410>]}


============================== 12:49:30.075398 | a81d4abd-1ef6-4628-a601-356a6f930f29 ==============================
[0m12:49:30.075398 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:49:30.075839 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'introspect': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/root/.dbt', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'version_check': 'True', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_format': 'default', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'quiet': 'False'}
[0m12:49:30.263338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a81d4abd-1ef6-4628-a601-356a6f930f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2df928920>]}
[0m12:49:30.317125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a81d4abd-1ef6-4628-a601-356a6f930f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2df928920>]}
[0m12:49:30.318365 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m12:49:30.370684 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:49:30.443510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:49:30.443854 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:49:30.449400 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m12:49:30.469183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a81d4abd-1ef6-4628-a601-356a6f930f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2df113860>]}
[0m12:49:30.520852 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:49:30.522036 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:49:30.532101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a81d4abd-1ef6-4628-a601-356a6f930f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2d511e300>]}
[0m12:49:30.532487 [info ] [MainThread]: Found 3 models, 3 sources, 444 macros
[0m12:49:30.532756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a81d4abd-1ef6-4628-a601-356a6f930f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2d515b7d0>]}
[0m12:49:30.533995 [info ] [MainThread]: 
[0m12:49:30.534279 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:30.534483 [info ] [MainThread]: 
[0m12:49:30.534825 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:49:30.538192 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:49:30.561979 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:49:30.562302 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:49:30.562510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:30.573568 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:49:30.574635 [debug] [ThreadPool]: On list_dev: Close
[0m12:49:30.575381 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:49:30.575713 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:49:30.581018 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:49:30.581326 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:49:30.581503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:30.582504 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:49:30.583410 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:49:30.583640 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:49:30.584674 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:49:30.584995 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:49:30.585313 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:49:30.586166 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:49:30.586746 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:49:30.586941 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:49:30.587099 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:49:30.587545 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:49:30.587754 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:49:30.588906 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:49:30.594094 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:49:30.594387 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:49:30.594578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:30.595465 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:49:30.595825 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:49:30.596117 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:49:30.603573 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m12:49:30.605963 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:49:30.606783 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:49:30.607000 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:49:30.608215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a81d4abd-1ef6-4628-a601-356a6f930f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2e183b1a0>]}
[0m12:49:30.608537 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:30.608749 [debug] [MainThread]: On master: BEGIN
[0m12:49:30.608901 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:49:30.609423 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:49:30.609628 [debug] [MainThread]: On master: COMMIT
[0m12:49:30.609795 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:30.609936 [debug] [MainThread]: On master: COMMIT
[0m12:49:30.610441 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:49:30.610681 [debug] [MainThread]: On master: Close
[0m12:49:30.613126 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m12:49:30.613533 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_carts ..................................... [RUN]
[0m12:49:30.613861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m12:49:30.614118 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m12:49:30.619072 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m12:49:30.619641 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m12:49:30.642679 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_carts"
[0m12:49:30.643196 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:49:30.643806 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: BEGIN
[0m12:49:30.644354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:30.645466 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:49:30.645714 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:49:30.645907 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m12:49:30.646693 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m12:49:30.646969 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:49:30.647258 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: ROLLBACK
[0m12:49:30.649674 [debug] [Thread-1 (]: Failed to rollback 'model.store_pipeline.stg_carts'
[0m12:49:30.650006 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: Close
[0m12:49:30.651862 [debug] [Thread-1 (]: Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^
[0m12:49:30.653398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a81d4abd-1ef6-4628-a601-356a6f930f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2d50243e0>]}
[0m12:49:30.653878 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_carts ............................ [[31mERROR[0m in 0.04s]
[0m12:49:30.654324 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m12:49:30.654611 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m12:49:30.655020 [debug] [Thread-4 (]: Marking all children of 'model.store_pipeline.stg_carts' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^.
[0m12:49:30.655447 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_products .................................. [RUN]
[0m12:49:30.656497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m12:49:30.656752 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m12:49:30.658984 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m12:49:30.659485 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m12:49:30.661573 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_products"
[0m12:49:30.661969 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:49:30.662179 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: BEGIN
[0m12:49:30.662539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:30.663347 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:49:30.664732 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:49:30.665170 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH raw_products AS(
    SELECT * FROM "dev"."main"."products"
)
SELECT CAST(id AS INT) AS product_id, 
        CAST(title AS VARCHAR) AS product_title,
        CAST(price AS FLOAT) AS product_price,
        CAST(description AS VARCHAR) AS product_description,
        CAST(category AS VARCHAR) AS product_category,
        CAST(rating_rate AS FLOAT) AS product_rating_rate,
        CAST(rating_count AS INT) AS product_rating_count
FROM raw_products
  );

[0m12:49:30.666343 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:49:30.670531 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:49:30.670938 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m12:49:30.671822 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:49:30.673749 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:49:30.673973 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:49:30.674476 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:30.682466 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m12:49:30.682821 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:49:30.683017 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m12:49:30.687955 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:49:30.691929 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:49:30.692325 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m12:49:30.696589 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:49:30.698610 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: Close
[0m12:49:30.699230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a81d4abd-1ef6-4628-a601-356a6f930f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2e195b350>]}
[0m12:49:30.699703 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.04s]
[0m12:49:30.700133 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m12:49:30.700402 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m12:49:30.700796 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_users ..................................... [RUN]
[0m12:49:30.701088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m12:49:30.701285 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m12:49:30.704924 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m12:49:30.705441 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m12:49:30.707457 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_users"
[0m12:49:30.707854 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:49:30.708139 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: BEGIN
[0m12:49:30.708327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:30.709087 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:49:30.709311 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:49:30.709521 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    WITH raw_users AS(
    SELECT * FROM "dev"."main"."users"
)
SELECT CAST(id AS INT) AS user_id, 
        CAST(email AS VARCHAR) AS user_email,
        CAST(username AS VARCHAR) AS user_username,
        CAST(password AS VARCHAR) AS user_password,
        CAST(name_firstname AS VARCHAR) AS user_name_firstname,
        CAST(name_lastname AS VARCHAR) AS user_name_lastname,
        CAST(address_city AS VARCHAR) AS user_address_city,
        CAST(address_street AS VARCHAR) AS user_address_street,
        CAST(address_number AS INT) AS user_address_number,
        CAST(address_zipcode AS VARCHAR) AS user_address_zipcode,
        CAST(phone AS VARCHAR) AS user_phone
FROM raw_users
  );

[0m12:49:30.710796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:49:30.712790 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:49:30.713045 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m12:49:30.713655 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:30.715229 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:49:30.715443 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m12:49:30.715940 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:30.716953 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m12:49:30.717293 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:49:30.717519 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m12:49:30.721515 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:49:30.723095 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:49:30.723533 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m12:49:30.727808 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:49:30.728878 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: Close
[0m12:49:30.729347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a81d4abd-1ef6-4628-a601-356a6f930f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2defdaf60>]}
[0m12:49:30.730086 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.03s]
[0m12:49:30.730599 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m12:49:30.731787 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:30.732053 [debug] [MainThread]: On master: BEGIN
[0m12:49:30.732227 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:49:30.732836 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:49:30.733021 [debug] [MainThread]: On master: COMMIT
[0m12:49:30.733177 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:30.733318 [debug] [MainThread]: On master: COMMIT
[0m12:49:30.733721 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:49:30.733903 [debug] [MainThread]: On master: Close
[0m12:49:30.734177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:30.734329 [debug] [MainThread]: Connection 'model.store_pipeline.stg_users' was properly closed.
[0m12:49:30.734523 [info ] [MainThread]: 
[0m12:49:30.734752 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m12:49:30.735260 [debug] [MainThread]: Command end result
[0m12:49:30.746380 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:49:30.747541 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:49:30.752184 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m12:49:30.752483 [info ] [MainThread]: 
[0m12:49:30.752857 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:49:30.753333 [info ] [MainThread]: 
[0m12:49:30.753691 [error] [MainThread]: [31mFailure in model stg_carts (models/stg/stg_carts.sql)[0m
[0m12:49:30.754001 [error] [MainThread]:   Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^
[0m12:49:30.754213 [info ] [MainThread]: 
[0m12:49:30.754408 [info ] [MainThread]:   compiled code at target/compiled/store_pipeline/models/stg/stg_carts.sql
[0m12:49:30.754594 [info ] [MainThread]: 
[0m12:49:30.754807 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m12:49:30.755457 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.72667176, "process_in_blocks": "0", "process_kernel_time": 0.217118, "process_mem_max_rss": "151636", "process_out_blocks": "1984", "process_user_time": 1.787051}
[0m12:49:30.755739 [debug] [MainThread]: Command `dbt run` failed at 12:49:30.755677 after 0.73 seconds
[0m12:49:30.755974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2dffa3a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2dffa0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb2dfe81bb0>]}
[0m12:49:30.756452 [debug] [MainThread]: Flushing usage events
[0m12:49:31.677223 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:32.962261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75407dfc5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75407dee7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75407e6c61e0>]}


============================== 12:49:32.965366 | 04266f29-9fe6-4fb9-b0af-593e0d10a4f5 ==============================
[0m12:49:32.965366 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:49:32.965782 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'quiet': 'False', 'write_json': 'True', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'target_path': 'None', 'warn_error': 'None', 'profiles_dir': '/root/.dbt', 'partial_parse': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'static_parser': 'True', 'debug': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True'}
[0m12:49:33.140753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04266f29-9fe6-4fb9-b0af-593e0d10a4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75407de0ce90>]}
[0m12:49:33.194874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04266f29-9fe6-4fb9-b0af-593e0d10a4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75407df2e9f0>]}
[0m12:49:33.196544 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m12:49:33.240980 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:49:33.310835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:49:33.311165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:49:33.315344 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m12:49:33.337774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04266f29-9fe6-4fb9-b0af-593e0d10a4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754074246630>]}
[0m12:49:33.386581 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:49:33.387734 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:49:33.396837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04266f29-9fe6-4fb9-b0af-593e0d10a4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7540740e94c0>]}
[0m12:49:33.397207 [info ] [MainThread]: Found 3 models, 3 sources, 444 macros
[0m12:49:33.397457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04266f29-9fe6-4fb9-b0af-593e0d10a4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754073f61a60>]}
[0m12:49:33.398592 [info ] [MainThread]: 
[0m12:49:33.398900 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:33.399110 [info ] [MainThread]: 
[0m12:49:33.399444 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:49:33.403578 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:49:33.425274 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:49:33.425627 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:49:33.425823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:33.435180 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m12:49:33.436454 [debug] [ThreadPool]: On list_dev: Close
[0m12:49:33.437293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:49:33.437601 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:49:33.442114 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:49:33.442449 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:49:33.442644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:33.443608 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:49:33.444503 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:49:33.444702 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:49:33.445093 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:49:33.445271 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:49:33.445417 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:49:33.445839 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:49:33.446333 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:49:33.446526 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:49:33.446674 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:49:33.447037 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:49:33.447217 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:49:33.448876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:49:33.454240 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:49:33.454553 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:49:33.454736 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:33.455915 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:49:33.456331 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:49:33.456517 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:49:33.463526 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m12:49:33.464593 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:49:33.465309 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:49:33.465504 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:49:33.466607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04266f29-9fe6-4fb9-b0af-593e0d10a4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7540740411c0>]}
[0m12:49:33.466922 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:33.467089 [debug] [MainThread]: On master: BEGIN
[0m12:49:33.467231 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:49:33.467773 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:49:33.468036 [debug] [MainThread]: On master: COMMIT
[0m12:49:33.468394 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:33.468646 [debug] [MainThread]: On master: COMMIT
[0m12:49:33.469173 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:49:33.469395 [debug] [MainThread]: On master: Close
[0m12:49:33.471721 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m12:49:33.472128 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_carts ..................................... [RUN]
[0m12:49:33.472442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m12:49:33.472641 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m12:49:33.477470 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m12:49:33.477999 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m12:49:33.499300 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_carts"
[0m12:49:33.499876 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:49:33.500196 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: BEGIN
[0m12:49:33.500381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:33.501315 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:49:33.501613 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:49:33.501856 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m12:49:33.502669 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m12:49:33.502937 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:49:33.503201 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: ROLLBACK
[0m12:49:33.505332 [debug] [Thread-1 (]: Failed to rollback 'model.store_pipeline.stg_carts'
[0m12:49:33.505574 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: Close
[0m12:49:33.506888 [debug] [Thread-1 (]: Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^
[0m12:49:33.508496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04266f29-9fe6-4fb9-b0af-593e0d10a4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75407edaef90>]}
[0m12:49:33.509087 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_carts ............................ [[31mERROR[0m in 0.03s]
[0m12:49:33.509510 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m12:49:33.509781 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m12:49:33.510094 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_products .................................. [RUN]
[0m12:49:33.510416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m12:49:33.510638 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m12:49:33.512461 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m12:49:33.512888 [debug] [Thread-4 (]: Marking all children of 'model.store_pipeline.stg_carts' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^.
[0m12:49:33.513773 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m12:49:33.516299 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_products"
[0m12:49:33.516814 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:49:33.517046 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: BEGIN
[0m12:49:33.517247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:33.517860 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:49:33.518064 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:49:33.518245 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH raw_products AS(
    SELECT * FROM "dev"."main"."products"
)
SELECT CAST(id AS INT) AS product_id, 
        CAST(title AS VARCHAR) AS product_title,
        CAST(price AS FLOAT) AS product_price,
        CAST(description AS VARCHAR) AS product_description,
        CAST(category AS VARCHAR) AS product_category,
        CAST(rating_rate AS FLOAT) AS product_rating_rate,
        CAST(rating_count AS INT) AS product_rating_count
FROM raw_products
  );

[0m12:49:33.518901 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:33.522863 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:49:33.523206 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m12:49:33.523932 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:33.525673 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:49:33.525900 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:49:33.526599 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:33.535090 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m12:49:33.535464 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:49:33.535682 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m12:49:33.540182 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:49:33.544441 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:49:33.544747 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m12:49:33.548191 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:49:33.549959 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: Close
[0m12:49:33.550568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04266f29-9fe6-4fb9-b0af-593e0d10a4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75408075b4d0>]}
[0m12:49:33.550986 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.04s]
[0m12:49:33.551371 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m12:49:33.551638 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m12:49:33.552171 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_users ..................................... [RUN]
[0m12:49:33.552496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m12:49:33.552722 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m12:49:33.555983 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m12:49:33.556557 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m12:49:33.558383 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_users"
[0m12:49:33.558771 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:49:33.559104 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: BEGIN
[0m12:49:33.559428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:33.560520 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:49:33.560819 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:49:33.561245 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    WITH raw_users AS(
    SELECT * FROM "dev"."main"."users"
)
SELECT CAST(id AS INT) AS user_id, 
        CAST(email AS VARCHAR) AS user_email,
        CAST(username AS VARCHAR) AS user_username,
        CAST(password AS VARCHAR) AS user_password,
        CAST(name_firstname AS VARCHAR) AS user_name_firstname,
        CAST(name_lastname AS VARCHAR) AS user_name_lastname,
        CAST(address_city AS VARCHAR) AS user_address_city,
        CAST(address_street AS VARCHAR) AS user_address_street,
        CAST(address_number AS INT) AS user_address_number,
        CAST(address_zipcode AS VARCHAR) AS user_address_zipcode,
        CAST(phone AS VARCHAR) AS user_phone
FROM raw_users
  );

[0m12:49:33.562665 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:49:33.564558 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:49:33.564808 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m12:49:33.565387 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:49:33.567141 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:49:33.567470 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m12:49:33.569097 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:49:33.570718 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m12:49:33.571005 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:49:33.571204 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m12:49:33.575633 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:49:33.577330 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:49:33.577582 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m12:49:33.581658 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:49:33.582749 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: Close
[0m12:49:33.583268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04266f29-9fe6-4fb9-b0af-593e0d10a4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7540702fcfe0>]}
[0m12:49:33.583667 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.03s]
[0m12:49:33.584064 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m12:49:33.585241 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:33.585463 [debug] [MainThread]: On master: BEGIN
[0m12:49:33.585630 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:49:33.586204 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:49:33.586406 [debug] [MainThread]: On master: COMMIT
[0m12:49:33.586576 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:33.586727 [debug] [MainThread]: On master: COMMIT
[0m12:49:33.587090 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:49:33.587306 [debug] [MainThread]: On master: Close
[0m12:49:33.587695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:33.587955 [debug] [MainThread]: Connection 'model.store_pipeline.stg_users' was properly closed.
[0m12:49:33.588254 [info ] [MainThread]: 
[0m12:49:33.588540 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m12:49:33.589092 [debug] [MainThread]: Command end result
[0m12:49:33.599506 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:49:33.601109 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:49:33.605156 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m12:49:33.605428 [info ] [MainThread]: 
[0m12:49:33.605675 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:49:33.605849 [info ] [MainThread]: 
[0m12:49:33.606074 [error] [MainThread]: [31mFailure in model stg_carts (models/stg/stg_carts.sql)[0m
[0m12:49:33.606306 [error] [MainThread]:   Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^
[0m12:49:33.606473 [info ] [MainThread]: 
[0m12:49:33.606648 [info ] [MainThread]:   compiled code at target/compiled/store_pipeline/models/stg/stg_carts.sql
[0m12:49:33.606829 [info ] [MainThread]: 
[0m12:49:33.607170 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m12:49:33.608090 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6859233, "process_in_blocks": "0", "process_kernel_time": 0.16229, "process_mem_max_rss": "151312", "process_out_blocks": "1968", "process_user_time": 1.685322}
[0m12:49:33.608490 [debug] [MainThread]: Command `dbt run` failed at 12:49:33.608393 after 0.69 seconds
[0m12:49:33.608742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75407ec57e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75407e3171d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75407e316a50>]}
[0m12:49:33.608959 [debug] [MainThread]: Flushing usage events
[0m12:49:34.414006 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:34.295901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f7886db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f6ed5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f6ed5580>]}


============================== 12:50:34.298585 | 9451b2a1-a208-4142-91d0-301aaf4c4392 ==============================
[0m12:50:34.298585 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:50:34.299006 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'empty': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'invocation_command': 'dbt run', 'printer_width': '80', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'partial_parse': 'True', 'debug': 'False', 'quiet': 'False', 'write_json': 'True'}
[0m12:50:34.466356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9451b2a1-a208-4142-91d0-301aaf4c4392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ecb721e0>]}
[0m12:50:34.518010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9451b2a1-a208-4142-91d0-301aaf4c4392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f65c39b0>]}
[0m12:50:34.519184 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m12:50:34.559044 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:50:34.619862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:50:34.620144 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:50:34.624329 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m12:50:34.642802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9451b2a1-a208-4142-91d0-301aaf4c4392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3eca58c80>]}
[0m12:50:34.687308 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:50:34.688516 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:50:34.697228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9451b2a1-a208-4142-91d0-301aaf4c4392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ec6fd580>]}
[0m12:50:34.697582 [info ] [MainThread]: Found 3 models, 3 sources, 444 macros
[0m12:50:34.697847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9451b2a1-a208-4142-91d0-301aaf4c4392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ec770f20>]}
[0m12:50:34.699069 [info ] [MainThread]: 
[0m12:50:34.699362 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:50:34.699570 [info ] [MainThread]: 
[0m12:50:34.699908 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:50:34.703356 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:50:34.725635 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:50:34.725959 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:50:34.726151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:34.737234 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:50:34.738228 [debug] [ThreadPool]: On list_dev: Close
[0m12:50:34.739052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:50:34.739376 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:50:34.743669 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:50:34.743923 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:50:34.744098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:34.745042 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:50:34.745860 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:50:34.746048 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:50:34.746446 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:50:34.746681 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:50:34.746855 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:50:34.747263 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:50:34.747784 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:50:34.747973 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:50:34.748123 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:50:34.748468 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:50:34.748698 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:50:34.749913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:50:34.754566 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:50:34.754862 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:50:34.755061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:34.755907 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:50:34.756126 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:50:34.756376 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:50:34.772321 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m12:50:34.773576 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:50:34.774457 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:50:34.774796 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:50:34.776153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9451b2a1-a208-4142-91d0-301aaf4c4392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f65c26c0>]}
[0m12:50:34.776612 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:34.776867 [debug] [MainThread]: On master: BEGIN
[0m12:50:34.777057 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:34.778025 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:50:34.778348 [debug] [MainThread]: On master: COMMIT
[0m12:50:34.778755 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:34.779056 [debug] [MainThread]: On master: COMMIT
[0m12:50:34.780105 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:50:34.781592 [debug] [MainThread]: On master: Close
[0m12:50:34.795059 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m12:50:34.797124 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_carts ..................................... [RUN]
[0m12:50:34.797763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m12:50:34.798200 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m12:50:34.808394 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m12:50:34.809651 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m12:50:34.845131 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_carts"
[0m12:50:34.845808 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:50:34.846112 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: BEGIN
[0m12:50:34.846434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:34.847391 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:50:34.847705 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:50:34.847948 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m12:50:34.848803 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m12:50:34.849064 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:50:34.849405 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: ROLLBACK
[0m12:50:34.852028 [debug] [Thread-1 (]: Failed to rollback 'model.store_pipeline.stg_carts'
[0m12:50:34.852441 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: Close
[0m12:50:34.854080 [debug] [Thread-1 (]: Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^
[0m12:50:34.855378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9451b2a1-a208-4142-91d0-301aaf4c4392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f673d970>]}
[0m12:50:34.855831 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_carts ............................ [[31mERROR[0m in 0.06s]
[0m12:50:34.856256 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m12:50:34.856516 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m12:50:34.856865 [debug] [Thread-4 (]: Marking all children of 'model.store_pipeline.stg_carts' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^.
[0m12:50:34.857302 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_products .................................. [RUN]
[0m12:50:34.858279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m12:50:34.858686 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m12:50:34.862242 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m12:50:34.862782 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m12:50:34.864870 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_products"
[0m12:50:34.865299 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:50:34.865589 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: BEGIN
[0m12:50:34.865817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:34.866595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:50:34.866833 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:50:34.867068 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH raw_products AS(
    SELECT * FROM "dev"."main"."products"
)
SELECT CAST(id AS INT) AS product_id, 
        CAST(title AS VARCHAR) AS product_title,
        CAST(price AS FLOAT) AS product_price,
        CAST(description AS VARCHAR) AS product_description,
        CAST(category AS VARCHAR) AS product_category,
        CAST(rating_rate AS FLOAT) AS product_rating_rate,
        CAST(rating_count AS INT) AS product_rating_count
FROM raw_products
  );

[0m12:50:34.867842 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:50:34.871997 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:50:34.872353 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m12:50:34.873208 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:50:34.875440 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:50:34.875719 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:50:34.876406 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:50:34.885184 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m12:50:34.885516 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:50:34.885759 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m12:50:34.889671 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:50:34.894290 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:50:34.894700 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m12:50:34.899029 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:50:34.900905 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: Close
[0m12:50:34.901499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9451b2a1-a208-4142-91d0-301aaf4c4392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f8fc3320>]}
[0m12:50:34.901950 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.04s]
[0m12:50:34.902392 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m12:50:34.902688 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m12:50:34.902987 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_users ..................................... [RUN]
[0m12:50:34.903433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m12:50:34.903667 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m12:50:34.906787 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m12:50:34.907354 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m12:50:34.909426 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_users"
[0m12:50:34.909883 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:50:34.910131 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: BEGIN
[0m12:50:34.910381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:34.911203 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:50:34.911455 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:50:34.911660 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    WITH raw_users AS(
    SELECT * FROM "dev"."main"."users"
)
SELECT CAST(id AS INT) AS user_id, 
        CAST(email AS VARCHAR) AS user_email,
        CAST(username AS VARCHAR) AS user_username,
        CAST(password AS VARCHAR) AS user_password,
        CAST(name_firstname AS VARCHAR) AS user_name_firstname,
        CAST(name_lastname AS VARCHAR) AS user_name_lastname,
        CAST(address_city AS VARCHAR) AS user_address_city,
        CAST(address_street AS VARCHAR) AS user_address_street,
        CAST(address_number AS INT) AS user_address_number,
        CAST(address_zipcode AS VARCHAR) AS user_address_zipcode,
        CAST(phone AS VARCHAR) AS user_phone
FROM raw_users
  );

[0m12:50:34.912414 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:50:34.914503 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:50:34.914835 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m12:50:34.915910 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:50:34.917829 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:50:34.918135 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m12:50:34.919051 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:50:34.920602 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m12:50:34.920990 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:50:34.921224 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m12:50:34.925282 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:50:34.927378 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:50:34.927841 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m12:50:34.931360 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:50:34.932360 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: Close
[0m12:50:34.932837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9451b2a1-a208-4142-91d0-301aaf4c4392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ebbc5d90>]}
[0m12:50:34.933321 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.03s]
[0m12:50:34.933796 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m12:50:34.935375 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:34.935642 [debug] [MainThread]: On master: BEGIN
[0m12:50:34.935824 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:50:34.936447 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:50:34.936651 [debug] [MainThread]: On master: COMMIT
[0m12:50:34.936840 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:34.936999 [debug] [MainThread]: On master: COMMIT
[0m12:50:34.937423 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:50:34.937612 [debug] [MainThread]: On master: Close
[0m12:50:34.937907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:34.938105 [debug] [MainThread]: Connection 'model.store_pipeline.stg_users' was properly closed.
[0m12:50:34.938331 [info ] [MainThread]: 
[0m12:50:34.938609 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m12:50:34.939243 [debug] [MainThread]: Command end result
[0m12:50:34.950834 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:50:34.952084 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:50:34.956707 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m12:50:34.957030 [info ] [MainThread]: 
[0m12:50:34.957306 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:50:34.957511 [info ] [MainThread]: 
[0m12:50:34.957775 [error] [MainThread]: [31mFailure in model stg_carts (models/stg/stg_carts.sql)[0m
[0m12:50:34.958034 [error] [MainThread]:   Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^
[0m12:50:34.958229 [info ] [MainThread]: 
[0m12:50:34.958467 [info ] [MainThread]:   compiled code at target/compiled/store_pipeline/models/stg/stg_carts.sql
[0m12:50:34.958667 [info ] [MainThread]: 
[0m12:50:34.958878 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m12:50:34.959571 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7088533, "process_in_blocks": "0", "process_kernel_time": 0.142466, "process_mem_max_rss": "151912", "process_out_blocks": "1976", "process_user_time": 1.738091}
[0m12:50:34.959899 [debug] [MainThread]: Command `dbt run` failed at 12:50:34.959831 after 0.71 seconds
[0m12:50:34.960134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f6e22ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f75e0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f75e1670>]}
[0m12:50:34.960376 [debug] [MainThread]: Flushing usage events
[0m12:50:35.659148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:51:12.091091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac3ca33e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac3b5afe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac3d717110>]}


============================== 12:51:12.094128 | cd87d182-6b07-40c8-b879-430121535a76 ==============================
[0m12:51:12.094128 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:51:12.094681 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'debug': 'False', 'printer_width': '80', 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': 'True', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'target_path': 'None', 'fail_fast': 'False', 'quiet': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'log_format': 'default', 'write_json': 'True', 'introspect': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error': 'None', 'indirect_selection': 'eager'}
[0m12:51:12.264376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd87d182-6b07-40c8-b879-430121535a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac3b393710>]}
[0m12:51:12.317260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd87d182-6b07-40c8-b879-430121535a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac3b966150>]}
[0m12:51:12.318837 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m12:51:12.359231 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:51:12.427743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:51:12.428013 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:51:12.433678 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m12:51:12.452552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd87d182-6b07-40c8-b879-430121535a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac30f59730>]}
[0m12:51:12.499445 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:51:12.501084 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:51:12.510463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd87d182-6b07-40c8-b879-430121535a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac30bfddc0>]}
[0m12:51:12.510821 [info ] [MainThread]: Found 3 models, 3 sources, 444 macros
[0m12:51:12.511084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd87d182-6b07-40c8-b879-430121535a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac30d4fb60>]}
[0m12:51:12.512367 [info ] [MainThread]: 
[0m12:51:12.512678 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:51:12.512886 [info ] [MainThread]: 
[0m12:51:12.513248 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:51:12.517678 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:51:12.542855 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:51:12.543178 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:51:12.543375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:12.555197 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:51:12.556253 [debug] [ThreadPool]: On list_dev: Close
[0m12:51:12.556960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:51:12.557266 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:51:12.562705 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:51:12.563022 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:51:12.563207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:12.564384 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:51:12.565405 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:51:12.565730 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:51:12.566233 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:51:12.566434 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:51:12.566589 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:51:12.567529 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:51:12.568313 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:51:12.568614 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:51:12.568792 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:51:12.569570 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:51:12.569796 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:51:12.570891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:51:12.575638 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:51:12.575979 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:51:12.576258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:12.577328 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:51:12.577600 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:51:12.577796 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:51:12.585839 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m12:51:12.586962 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:51:12.588187 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:51:12.588442 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:51:12.589715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd87d182-6b07-40c8-b879-430121535a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac369632f0>]}
[0m12:51:12.590038 [debug] [MainThread]: Using duckdb connection "master"
[0m12:51:12.590232 [debug] [MainThread]: On master: BEGIN
[0m12:51:12.590386 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:51:12.590998 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:51:12.591186 [debug] [MainThread]: On master: COMMIT
[0m12:51:12.591340 [debug] [MainThread]: Using duckdb connection "master"
[0m12:51:12.591590 [debug] [MainThread]: On master: COMMIT
[0m12:51:12.591995 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:51:12.592193 [debug] [MainThread]: On master: Close
[0m12:51:12.595432 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m12:51:12.595884 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_carts ..................................... [RUN]
[0m12:51:12.596250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m12:51:12.596476 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m12:51:12.601338 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m12:51:12.601821 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m12:51:12.624038 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_carts"
[0m12:51:12.624758 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:51:12.625141 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: BEGIN
[0m12:51:12.625398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:12.626713 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:12.627027 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:51:12.627578 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m12:51:12.628474 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m12:51:12.628813 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:51:12.629189 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: ROLLBACK
[0m12:51:12.631533 [debug] [Thread-1 (]: Failed to rollback 'model.store_pipeline.stg_carts'
[0m12:51:12.631775 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: Close
[0m12:51:12.633342 [debug] [Thread-1 (]: Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^
[0m12:51:12.634570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd87d182-6b07-40c8-b879-430121535a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac2bfcd610>]}
[0m12:51:12.635027 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_carts ............................ [[31mERROR[0m in 0.04s]
[0m12:51:12.635427 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m12:51:12.635682 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m12:51:12.636346 [debug] [Thread-4 (]: Marking all children of 'model.store_pipeline.stg_carts' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^.
[0m12:51:12.635999 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_products .................................. [RUN]
[0m12:51:12.637387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m12:51:12.637624 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m12:51:12.639372 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m12:51:12.639817 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m12:51:12.642052 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_products"
[0m12:51:12.642486 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:51:12.642725 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: BEGIN
[0m12:51:12.642912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:12.643514 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:12.643733 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:51:12.643924 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH raw_products AS(
    SELECT * FROM "dev"."main"."products"
)
SELECT CAST(id AS INT) AS product_id, 
        CAST(title AS VARCHAR) AS product_title,
        CAST(price AS FLOAT) AS product_price,
        CAST(description AS VARCHAR) AS product_description,
        CAST(category AS VARCHAR) AS product_category,
        CAST(rating_rate AS FLOAT) AS product_rating_rate,
        CAST(rating_count AS INT) AS product_rating_count
FROM raw_products
  );

[0m12:51:12.644695 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:12.649291 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:51:12.649598 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m12:51:12.650583 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:12.652503 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:51:12.652751 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:51:12.653410 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:51:12.661654 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m12:51:12.662007 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:51:12.662314 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m12:51:12.666671 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:51:12.670689 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:51:12.670963 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m12:51:12.674146 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:51:12.675835 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: Close
[0m12:51:12.676435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd87d182-6b07-40c8-b879-430121535a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac3d4b73b0>]}
[0m12:51:12.676919 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.04s]
[0m12:51:12.677278 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m12:51:12.677530 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m12:51:12.677838 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_users ..................................... [RUN]
[0m12:51:12.678199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m12:51:12.678395 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m12:51:12.681331 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m12:51:12.681827 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m12:51:12.683660 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_users"
[0m12:51:12.684027 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:51:12.684237 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: BEGIN
[0m12:51:12.684452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:12.685109 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:12.685523 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:51:12.685973 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    WITH raw_users AS(
    SELECT * FROM "dev"."main"."users"
)
SELECT CAST(id AS INT) AS user_id, 
        CAST(email AS VARCHAR) AS user_email,
        CAST(username AS VARCHAR) AS user_username,
        CAST(password AS VARCHAR) AS user_password,
        CAST(name_firstname AS VARCHAR) AS user_name_firstname,
        CAST(name_lastname AS VARCHAR) AS user_name_lastname,
        CAST(address_city AS VARCHAR) AS user_address_city,
        CAST(address_street AS VARCHAR) AS user_address_street,
        CAST(address_number AS INT) AS user_address_number,
        CAST(address_zipcode AS VARCHAR) AS user_address_zipcode,
        CAST(phone AS VARCHAR) AS user_phone
FROM raw_users
  );

[0m12:51:12.687009 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:12.688852 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:51:12.689084 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m12:51:12.689834 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:12.691464 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:51:12.691716 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m12:51:12.693227 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:51:12.694333 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m12:51:12.694585 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:51:12.694784 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m12:51:12.697680 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:51:12.699418 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:51:12.699775 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m12:51:12.702934 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:51:12.703902 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: Close
[0m12:51:12.704395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd87d182-6b07-40c8-b879-430121535a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac2be901d0>]}
[0m12:51:12.704845 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.03s]
[0m12:51:12.705234 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m12:51:12.706766 [debug] [MainThread]: Using duckdb connection "master"
[0m12:51:12.707033 [debug] [MainThread]: On master: BEGIN
[0m12:51:12.707247 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:51:12.707931 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:51:12.708149 [debug] [MainThread]: On master: COMMIT
[0m12:51:12.708314 [debug] [MainThread]: Using duckdb connection "master"
[0m12:51:12.708542 [debug] [MainThread]: On master: COMMIT
[0m12:51:12.709019 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:51:12.709243 [debug] [MainThread]: On master: Close
[0m12:51:12.709536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:12.709698 [debug] [MainThread]: Connection 'model.store_pipeline.stg_users' was properly closed.
[0m12:51:12.709895 [info ] [MainThread]: 
[0m12:51:12.710244 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m12:51:12.710810 [debug] [MainThread]: Command end result
[0m12:51:12.722164 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:51:12.723270 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:51:12.727777 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m12:51:12.728073 [info ] [MainThread]: 
[0m12:51:12.728333 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:51:12.728527 [info ] [MainThread]: 
[0m12:51:12.728776 [error] [MainThread]: [31mFailure in model stg_carts (models/stg/stg_carts.sql)[0m
[0m12:51:12.728995 [error] [MainThread]:   Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^
[0m12:51:12.729161 [info ] [MainThread]: 
[0m12:51:12.729330 [info ] [MainThread]:   compiled code at target/compiled/store_pipeline/models/stg/stg_carts.sql
[0m12:51:12.729493 [info ] [MainThread]: 
[0m12:51:12.729690 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m12:51:12.730341 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6846927, "process_in_blocks": "0", "process_kernel_time": 0.250816, "process_mem_max_rss": "151500", "process_out_blocks": "1976", "process_user_time": 1.71809}
[0m12:51:12.730631 [debug] [MainThread]: Command `dbt run` failed at 12:51:12.730570 after 0.69 seconds
[0m12:51:12.730840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac3b7c41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac3b3d6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ac3b6e78c0>]}
[0m12:51:12.731044 [debug] [MainThread]: Flushing usage events
[0m12:51:13.535421 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:52:16.377810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767deb323da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767deba88620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767de8f754f0>]}


============================== 12:52:16.380344 | af674654-3a83-4a08-b4d3-8829c9eb1d88 ==============================
[0m12:52:16.380344 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:52:16.380786 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'debug': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'profiles_dir': '/root/.dbt', 'quiet': 'False', 'target_path': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'log_format': 'default', 'warn_error': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m12:52:16.541532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af674654-3a83-4a08-b4d3-8829c9eb1d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767ddf3134d0>]}
[0m12:52:16.595681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af674654-3a83-4a08-b4d3-8829c9eb1d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767de9ddb740>]}
[0m12:52:16.596910 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m12:52:16.636756 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:52:16.697245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:16.697529 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:16.701988 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m12:52:16.719518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af674654-3a83-4a08-b4d3-8829c9eb1d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767ddf216f30>]}
[0m12:52:16.761170 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:52:16.762262 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:52:16.770294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af674654-3a83-4a08-b4d3-8829c9eb1d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767ddef68f80>]}
[0m12:52:16.770639 [info ] [MainThread]: Found 3 models, 3 sources, 444 macros
[0m12:52:16.770898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af674654-3a83-4a08-b4d3-8829c9eb1d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767ddf256ae0>]}
[0m12:52:16.772100 [info ] [MainThread]: 
[0m12:52:16.772454 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:52:16.772675 [info ] [MainThread]: 
[0m12:52:16.773047 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:52:16.776473 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:52:16.799586 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:52:16.799965 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:52:16.800217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:16.811558 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:52:16.812643 [debug] [ThreadPool]: On list_dev: Close
[0m12:52:16.813425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:52:16.813770 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:52:16.818362 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:52:16.818629 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:52:16.818862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:16.820271 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:52:16.821153 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:52:16.821403 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:52:16.822071 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:52:16.822278 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:52:16.822433 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:52:16.822825 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:52:16.823348 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:52:16.823535 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:52:16.823717 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:52:16.824131 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:52:16.824320 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:52:16.825576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:52:16.830019 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:52:16.830281 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:52:16.830448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:16.831159 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:52:16.831363 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:52:16.831545 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:52:16.838683 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m12:52:16.839774 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:52:16.840597 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:52:16.840801 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:52:16.841895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af674654-3a83-4a08-b4d3-8829c9eb1d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767deac02f00>]}
[0m12:52:16.842227 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:16.842395 [debug] [MainThread]: On master: BEGIN
[0m12:52:16.842535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:16.843060 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:52:16.843225 [debug] [MainThread]: On master: COMMIT
[0m12:52:16.843364 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:16.843494 [debug] [MainThread]: On master: COMMIT
[0m12:52:16.843896 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:52:16.844113 [debug] [MainThread]: On master: Close
[0m12:52:16.846794 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m12:52:16.847183 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_carts ..................................... [RUN]
[0m12:52:16.847512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m12:52:16.847727 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m12:52:16.852233 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m12:52:16.852698 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m12:52:16.872366 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_carts"
[0m12:52:16.872948 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:52:16.873195 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: BEGIN
[0m12:52:16.873378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:16.874105 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:52:16.874348 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:52:16.874523 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m12:52:16.875323 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m12:52:16.875561 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:52:16.875816 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: ROLLBACK
[0m12:52:16.878197 [debug] [Thread-1 (]: Failed to rollback 'model.store_pipeline.stg_carts'
[0m12:52:16.878535 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: Close
[0m12:52:16.880286 [debug] [Thread-1 (]: Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^
[0m12:52:16.881386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af674654-3a83-4a08-b4d3-8829c9eb1d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767ddf3c3440>]}
[0m12:52:16.881843 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_carts ............................ [[31mERROR[0m in 0.03s]
[0m12:52:16.882248 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m12:52:16.882504 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m12:52:16.882811 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_products .................................. [RUN]
[0m12:52:16.883185 [debug] [Thread-4 (]: Marking all children of 'model.store_pipeline.stg_carts' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^.
[0m12:52:16.883609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m12:52:16.884664 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m12:52:16.886591 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m12:52:16.887012 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m12:52:16.889010 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_products"
[0m12:52:16.889410 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:52:16.889614 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: BEGIN
[0m12:52:16.889789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:16.890417 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:52:16.890626 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:52:16.890800 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH raw_products AS(
    SELECT * FROM "dev"."main"."products"
)
SELECT CAST(id AS INT) AS product_id, 
        CAST(title AS VARCHAR) AS product_title,
        CAST(price AS FLOAT) AS product_price,
        CAST(description AS VARCHAR) AS product_description,
        CAST(category AS VARCHAR) AS product_category,
        CAST(rating_rate AS FLOAT) AS product_rating_rate,
        CAST(rating_count AS INT) AS product_rating_count
FROM raw_products
  );

[0m12:52:16.891849 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:52:16.896024 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:52:16.896309 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m12:52:16.897001 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:52:16.898828 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:52:16.899115 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:52:16.900102 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:52:16.908918 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m12:52:16.909244 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:52:16.909645 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m12:52:16.913302 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:52:16.917217 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:52:16.917487 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m12:52:16.920497 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:52:16.922156 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: Close
[0m12:52:16.922710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af674654-3a83-4a08-b4d3-8829c9eb1d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767deb79b410>]}
[0m12:52:16.923122 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.04s]
[0m12:52:16.923524 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m12:52:16.923775 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m12:52:16.924132 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_users ..................................... [RUN]
[0m12:52:16.924564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m12:52:16.924824 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m12:52:16.927628 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m12:52:16.928112 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m12:52:16.929892 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_users"
[0m12:52:16.930274 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:52:16.930475 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: BEGIN
[0m12:52:16.930644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:16.931324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:52:16.931585 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:52:16.931785 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    WITH raw_users AS(
    SELECT * FROM "dev"."main"."users"
)
SELECT CAST(id AS INT) AS user_id, 
        CAST(email AS VARCHAR) AS user_email,
        CAST(username AS VARCHAR) AS user_username,
        CAST(password AS VARCHAR) AS user_password,
        CAST(name_firstname AS VARCHAR) AS user_name_firstname,
        CAST(name_lastname AS VARCHAR) AS user_name_lastname,
        CAST(address_city AS VARCHAR) AS user_address_city,
        CAST(address_street AS VARCHAR) AS user_address_street,
        CAST(address_number AS INT) AS user_address_number,
        CAST(address_zipcode AS VARCHAR) AS user_address_zipcode,
        CAST(phone AS VARCHAR) AS user_phone
FROM raw_users
  );

[0m12:52:16.932885 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:52:16.934634 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:52:16.934849 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m12:52:16.935396 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:52:16.937022 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:52:16.937240 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m12:52:16.937890 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:52:16.938896 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m12:52:16.939132 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:52:16.939309 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m12:52:16.943067 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:52:16.944732 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:52:16.945010 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m12:52:16.948067 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:52:16.949003 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: Close
[0m12:52:16.949456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af674654-3a83-4a08-b4d3-8829c9eb1d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767ddc58a270>]}
[0m12:52:16.949887 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.02s]
[0m12:52:16.950271 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m12:52:16.951424 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:16.951652 [debug] [MainThread]: On master: BEGIN
[0m12:52:16.951827 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:16.952603 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:52:16.952889 [debug] [MainThread]: On master: COMMIT
[0m12:52:16.953087 [debug] [MainThread]: Using duckdb connection "master"
[0m12:52:16.953254 [debug] [MainThread]: On master: COMMIT
[0m12:52:16.953818 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:52:16.954034 [debug] [MainThread]: On master: Close
[0m12:52:16.954331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:16.954499 [debug] [MainThread]: Connection 'model.store_pipeline.stg_users' was properly closed.
[0m12:52:16.954723 [info ] [MainThread]: 
[0m12:52:16.954965 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m12:52:16.955543 [debug] [MainThread]: Command end result
[0m12:52:16.967571 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:52:16.968797 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:52:16.973002 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m12:52:16.973294 [info ] [MainThread]: 
[0m12:52:16.973568 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:52:16.973775 [info ] [MainThread]: 
[0m12:52:16.974003 [error] [MainThread]: [31mFailure in model stg_carts (models/stg/stg_carts.sql)[0m
[0m12:52:16.974241 [error] [MainThread]:   Runtime Error in model stg_carts (models/stg/stg_carts.sql)
  Binder Error: Referenced column "date" not found in FROM clause!
  Candidate bindings: "cart_id", "quantity", "cart_date", "product_id"
  
  LINE 11:         CAST(date AS TIMESTAMP) AS cart_date
                        ^
[0m12:52:16.974425 [info ] [MainThread]: 
[0m12:52:16.974605 [info ] [MainThread]:   compiled code at target/compiled/store_pipeline/models/stg/stg_carts.sql
[0m12:52:16.974783 [info ] [MainThread]: 
[0m12:52:16.974996 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m12:52:16.975643 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.638303, "process_in_blocks": "0", "process_kernel_time": 0.20821, "process_mem_max_rss": "151460", "process_out_blocks": "1976", "process_user_time": 1.586564}
[0m12:52:16.975978 [debug] [MainThread]: Command `dbt run` failed at 12:52:16.975909 after 0.64 seconds
[0m12:52:16.976246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767de9d7c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767de9d7ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767de9dd8500>]}
[0m12:52:16.976467 [debug] [MainThread]: Flushing usage events
[0m12:52:17.868115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:32.759280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79595bd90530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79595b16f860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79595a8712b0>]}


============================== 12:53:32.762693 | 950c9467-6fc1-4a73-be55-171d89212d23 ==============================
[0m12:53:32.762693 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:53:32.763208 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': '/root/.dbt', 'introspect': 'True', 'empty': 'False', 'target_path': 'None', 'debug': 'False', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'printer_width': '80', 'no_print': 'None', 'quiet': 'False', 'version_check': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_format': 'default', 'use_experimental_parser': 'False'}
[0m12:53:32.938334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '950c9467-6fc1-4a73-be55-171d89212d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795950c970e0>]}
[0m12:53:32.994746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '950c9467-6fc1-4a73-be55-171d89212d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79595652b440>]}
[0m12:53:32.995960 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m12:53:33.041030 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:53:33.108471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:53:33.108905 [debug] [MainThread]: Partial parsing: updated file: store_pipeline://models/stg/stg_carts.sql
[0m12:53:33.294190 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m12:53:33.304414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '950c9467-6fc1-4a73-be55-171d89212d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7959507e83b0>]}
[0m12:53:33.347585 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:53:33.348818 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:53:33.359121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '950c9467-6fc1-4a73-be55-171d89212d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7959509e9a00>]}
[0m12:53:33.359513 [info ] [MainThread]: Found 3 models, 3 sources, 444 macros
[0m12:53:33.359770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '950c9467-6fc1-4a73-be55-171d89212d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79595070fec0>]}
[0m12:53:33.360899 [info ] [MainThread]: 
[0m12:53:33.361161 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:53:33.361370 [info ] [MainThread]: 
[0m12:53:33.361675 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:53:33.365365 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:53:33.388558 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:53:33.388846 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:53:33.389025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:33.400811 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:53:33.401809 [debug] [ThreadPool]: On list_dev: Close
[0m12:53:33.402444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:53:33.403214 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:53:33.407991 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:53:33.408251 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:53:33.408425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:33.409551 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:53:33.410671 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:53:33.410965 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:53:33.411482 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:53:33.411667 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:53:33.411813 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:53:33.412501 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:53:33.413102 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:53:33.413320 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:53:33.413478 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:53:33.413940 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:53:33.414129 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:53:33.415143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:53:33.419032 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:53:33.419313 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:53:33.419480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:33.420241 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:53:33.420466 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:53:33.420632 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:53:33.429056 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m12:53:33.430691 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:53:33.431476 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:53:33.431693 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:53:33.432841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '950c9467-6fc1-4a73-be55-171d89212d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79595070fc80>]}
[0m12:53:33.433144 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:33.433317 [debug] [MainThread]: On master: BEGIN
[0m12:53:33.433459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:33.433998 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:53:33.434200 [debug] [MainThread]: On master: COMMIT
[0m12:53:33.434420 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:33.434644 [debug] [MainThread]: On master: COMMIT
[0m12:53:33.435032 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:53:33.435209 [debug] [MainThread]: On master: Close
[0m12:53:33.437248 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m12:53:33.437682 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_carts ..................................... [RUN]
[0m12:53:33.438040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m12:53:33.438277 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m12:53:33.443088 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m12:53:33.443671 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m12:53:33.465621 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_carts"
[0m12:53:33.466170 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:53:33.466433 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: BEGIN
[0m12:53:33.466689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:33.467360 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:53:33.467595 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:53:33.467794 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(cart_date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m12:53:33.468562 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:53:33.473543 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:53:33.473875 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts__dbt_tmp" rename to "stg_carts"
[0m12:53:33.474653 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:53:33.481286 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m12:53:33.481611 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:53:33.481811 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m12:53:33.485484 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:53:33.490051 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m12:53:33.490489 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

      drop view if exists "dev"."main"."stg_carts__dbt_backup" cascade
    
[0m12:53:33.491279 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:53:33.492892 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: Close
[0m12:53:33.494158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '950c9467-6fc1-4a73-be55-171d89212d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79595d08f200>]}
[0m12:53:33.494638 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_carts ................................ [[32mOK[0m in 0.06s]
[0m12:53:33.495068 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m12:53:33.495344 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m12:53:33.495818 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_products .................................. [RUN]
[0m12:53:33.496196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m12:53:33.496502 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m12:53:33.498457 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m12:53:33.499031 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m12:53:33.500993 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_products"
[0m12:53:33.501429 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:53:33.501650 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: BEGIN
[0m12:53:33.501834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:33.503024 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:53:33.503327 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:53:33.503535 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH raw_products AS(
    SELECT * FROM "dev"."main"."products"
)
SELECT CAST(id AS INT) AS product_id, 
        CAST(title AS VARCHAR) AS product_title,
        CAST(price AS FLOAT) AS product_price,
        CAST(description AS VARCHAR) AS product_description,
        CAST(category AS VARCHAR) AS product_category,
        CAST(rating_rate AS FLOAT) AS product_rating_rate,
        CAST(rating_count AS INT) AS product_rating_count
FROM raw_products
  );

[0m12:53:33.504451 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:53:33.506461 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:53:33.506763 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m12:53:33.507313 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:53:33.508901 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:53:33.509171 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:53:33.509926 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:53:33.512569 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m12:53:33.512820 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:53:33.513012 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m12:53:33.517548 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:53:33.519325 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m12:53:33.519595 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m12:53:33.522783 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:53:33.523849 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: Close
[0m12:53:33.524396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '950c9467-6fc1-4a73-be55-171d89212d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79594cc31820>]}
[0m12:53:33.524877 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.03s]
[0m12:53:33.525320 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m12:53:33.525671 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m12:53:33.526116 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_users ..................................... [RUN]
[0m12:53:33.526473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m12:53:33.526712 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m12:53:33.528444 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m12:53:33.528841 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m12:53:33.532171 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_users"
[0m12:53:33.532683 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:53:33.532925 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: BEGIN
[0m12:53:33.533101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:33.533730 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:53:33.533943 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:53:33.534143 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    WITH raw_users AS(
    SELECT * FROM "dev"."main"."users"
)
SELECT CAST(id AS INT) AS user_id, 
        CAST(email AS VARCHAR) AS user_email,
        CAST(username AS VARCHAR) AS user_username,
        CAST(password AS VARCHAR) AS user_password,
        CAST(name_firstname AS VARCHAR) AS user_name_firstname,
        CAST(name_lastname AS VARCHAR) AS user_name_lastname,
        CAST(address_city AS VARCHAR) AS user_address_city,
        CAST(address_street AS VARCHAR) AS user_address_street,
        CAST(address_number AS INT) AS user_address_number,
        CAST(address_zipcode AS VARCHAR) AS user_address_zipcode,
        CAST(phone AS VARCHAR) AS user_phone
FROM raw_users
  );

[0m12:53:33.535196 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:53:33.587545 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:53:33.587887 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m12:53:33.588745 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:53:33.591010 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:53:33.591305 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m12:53:33.592268 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:53:33.593194 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m12:53:33.593410 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:53:33.593584 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m12:53:33.597239 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:53:33.598951 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m12:53:33.599187 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m12:53:33.602427 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:53:33.603789 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: Close
[0m12:53:33.604777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '950c9467-6fc1-4a73-be55-171d89212d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79594cbdc890>]}
[0m12:53:33.605210 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.08s]
[0m12:53:33.605596 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m12:53:33.606743 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:33.606962 [debug] [MainThread]: On master: BEGIN
[0m12:53:33.607135 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:33.607719 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:53:33.607925 [debug] [MainThread]: On master: COMMIT
[0m12:53:33.608108 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:33.608314 [debug] [MainThread]: On master: COMMIT
[0m12:53:33.608922 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:53:33.609172 [debug] [MainThread]: On master: Close
[0m12:53:33.609516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:33.609706 [debug] [MainThread]: Connection 'model.store_pipeline.stg_users' was properly closed.
[0m12:53:33.609934 [info ] [MainThread]: 
[0m12:53:33.610165 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m12:53:33.610825 [debug] [MainThread]: Command end result
[0m12:53:33.621001 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:53:33.622790 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:53:33.627044 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m12:53:33.627294 [info ] [MainThread]: 
[0m12:53:33.627553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:33.627738 [info ] [MainThread]: 
[0m12:53:33.627953 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m12:53:33.628726 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9173853, "process_in_blocks": "0", "process_kernel_time": 0.205572, "process_mem_max_rss": "152720", "process_out_blocks": "2872", "process_user_time": 1.992797}
[0m12:53:33.629135 [debug] [MainThread]: Command `dbt run` succeeded at 12:53:33.629053 after 0.92 seconds
[0m12:53:33.629443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79595d378200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7959508dbfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79594cbcc920>]}
[0m12:53:33.629699 [debug] [MainThread]: Flushing usage events
[0m12:53:34.523842 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:55:35.705184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cdc5dd6f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cdc4c0b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cdc4aa4e90>]}


============================== 12:55:35.707759 | 3e8f69c0-a389-4a29-af52-b27549e390d4 ==============================
[0m12:55:35.707759 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:55:35.708531 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'warn_error': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'quiet': 'False', 'empty': 'None', 'write_json': 'True', 'log_format': 'default', 'version_check': 'True', 'invocation_command': 'dbt docs generate', 'profiles_dir': '/root/.dbt', 'target_path': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'no_print': 'None', 'indirect_selection': 'eager'}
[0m12:55:35.852393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e8f69c0-a389-4a29-af52-b27549e390d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cdbf9b94f0>]}
[0m12:55:35.893904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e8f69c0-a389-4a29-af52-b27549e390d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cdc3bc8c50>]}
[0m12:55:35.895075 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m12:55:35.934533 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:55:35.993229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:55:35.993533 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:55:35.997528 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m12:55:36.016169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e8f69c0-a389-4a29-af52-b27549e390d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cdba0cf590>]}
[0m12:55:36.028251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e8f69c0-a389-4a29-af52-b27549e390d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cdc3baa150>]}
[0m12:55:36.028620 [info ] [MainThread]: Found 3 models, 3 sources, 444 macros
[0m12:55:36.028905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e8f69c0-a389-4a29-af52-b27549e390d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cdbf98e240>]}
[0m12:55:36.030196 [info ] [MainThread]: 
[0m12:55:36.030658 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:55:36.031053 [info ] [MainThread]: 
[0m12:55:36.031490 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:55:36.034794 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m12:55:36.059353 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:55:36.059789 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:55:36.060002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:36.069766 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:55:36.070084 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:55:36.070256 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:55:36.077598 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m12:55:36.078658 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:55:36.079382 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:55:36.079660 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:55:36.080945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e8f69c0-a389-4a29-af52-b27549e390d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cdc3bcb650>]}
[0m12:55:36.083594 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m12:55:36.084119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m12:55:36.084342 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m12:55:36.088797 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m12:55:36.089210 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m12:55:36.089658 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m12:55:36.089934 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m12:55:36.090187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m12:55:36.090409 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m12:55:36.092020 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m12:55:36.092507 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m12:55:36.092927 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m12:55:36.093167 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m12:55:36.093390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m12:55:36.093601 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m12:55:36.095225 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m12:55:36.095977 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m12:55:36.096692 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m12:55:36.097874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:36.098094 [debug] [MainThread]: Connection 'model.store_pipeline.stg_users' was properly closed.
[0m12:55:36.098577 [debug] [MainThread]: Command end result
[0m12:55:36.139733 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:55:36.140820 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:55:36.144739 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m12:55:36.150675 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m12:55:36.150916 [info ] [MainThread]: Building catalog
[0m12:55:36.156739 [debug] [ThreadPool]: Acquiring new duckdb connection 'dev.information_schema'
[0m12:55:36.161249 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m12:55:36.161793 [debug] [ThreadPool]: On dev.information_schema: BEGIN
[0m12:55:36.162003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:36.162669 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:55:36.162844 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m12:55:36.162996 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "dev.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dev'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dev'
    )
    select
        'dev' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m12:55:36.171883 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m12:55:36.174144 [debug] [ThreadPool]: On dev.information_schema: ROLLBACK
[0m12:55:36.174711 [debug] [ThreadPool]: Failed to rollback 'dev.information_schema'
[0m12:55:36.174895 [debug] [ThreadPool]: On dev.information_schema: Close
[0m12:55:36.182621 [debug] [MainThread]: Wrote artifact CatalogArtifact to /root/airflow/dags/store_pipeline/target/catalog.json
[0m12:55:36.192684 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m12:55:36.193833 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m12:55:36.194090 [info ] [MainThread]: Catalog written to /root/airflow/dags/store_pipeline/target/catalog.json
[0m12:55:36.194858 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.5268673, "process_in_blocks": "6376", "process_kernel_time": 0.176095, "process_mem_max_rss": "151260", "process_out_blocks": "5248", "process_user_time": 1.34168}
[0m12:55:36.195228 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:55:36.195157 after 0.53 seconds
[0m12:55:36.195486 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:55:36.195650 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.
[0m12:55:36.195845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cdc44bb080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cdc6082240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cdba0cc500>]}
[0m12:55:36.196058 [debug] [MainThread]: Flushing usage events
[0m12:55:37.007614 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:55:42.109473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f2ee031fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f2ee25e7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f2ee0331a0>]}


============================== 12:55:42.112806 | e7e3e2a9-bf97-49f9-bc71-f3cbff8fc4f1 ==============================
[0m12:55:42.112806 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:55:42.113179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'profiles_dir': '/root/.dbt', 'partial_parse': 'True', 'debug': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'write_json': 'True', 'quiet': 'False', 'empty': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs serve'}
[0m12:55:42.264673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7e3e2a9-bf97-49f9-bc71-f3cbff8fc4f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f2ede28c20>]}
[0m12:55:42.308802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7e3e2a9-bf97-49f9-bc71-f3cbff8fc4f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f2e391af30>]}
[0m12:55:43.129376 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m12:55:43.131414 [error] [MainThread]: Traceback (most recent call last):
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m12:55:43.132216 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.0609852, "process_in_blocks": "128", "process_kernel_time": 0.162575, "process_mem_max_rss": "132024", "process_out_blocks": "3352", "process_user_time": 1.138028}
[0m12:55:43.132568 [debug] [MainThread]: Command `dbt docs serve` failed at 12:55:43.132487 after 1.06 seconds
[0m12:55:43.132833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f2ee12d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f2e391a660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f2e3878950>]}
[0m12:55:43.133110 [debug] [MainThread]: Flushing usage events
[0m12:55:43.949440 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:55:57.238873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc251752720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc252222ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc253fd24e0>]}


============================== 12:55:57.241317 | 4cdf40cb-0b2e-48f0-88df-749fe61edf57 ==============================
[0m12:55:57.241317 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:55:57.241823 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'target_path': 'None', 'fail_fast': 'False', 'empty': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs serve', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'write_json': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None'}
[0m12:55:57.402171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cdf40cb-0b2e-48f0-88df-749fe61edf57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc25365bf50>]}
[0m12:55:57.447585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cdf40cb-0b2e-48f0-88df-749fe61edf57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc252ac2f60>]}
[0m12:55:58.858257 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m12:55:58.859985 [error] [MainThread]: Traceback (most recent call last):
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m12:55:58.860696 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.6606141, "process_in_blocks": "0", "process_kernel_time": 0.190184, "process_mem_max_rss": "131880", "process_out_blocks": "3360", "process_user_time": 1.221409}
[0m12:55:58.861028 [debug] [MainThread]: Command `dbt docs serve` failed at 12:55:58.860958 after 1.66 seconds
[0m12:55:58.861237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc251516c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc2471145f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dc2518c2360>]}
[0m12:55:58.861440 [debug] [MainThread]: Flushing usage events
[0m12:55:59.687786 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:13.182971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b355b9d9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b355d87c560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b355bbaab70>]}


============================== 12:56:13.185631 | 8f99b5d6-1554-41ea-b8cb-81c1bc9d44b4 ==============================
[0m12:56:13.185631 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:56:13.186086 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'version_check': 'True', 'target_path': 'None', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'fail_fast': 'False', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'cache_selected_only': 'False', 'empty': 'None', 'debug': 'False', 'no_print': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'printer_width': '80', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'profiles_dir': '/root/.dbt', 'use_experimental_parser': 'False', 'warn_error': 'None'}
[0m12:56:13.341488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f99b5d6-1554-41ea-b8cb-81c1bc9d44b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3551148800>]}
[0m12:56:13.385033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f99b5d6-1554-41ea-b8cb-81c1bc9d44b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b355ab7cfb0>]}
[0m12:56:14.381998 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m12:56:14.383996 [error] [MainThread]: Traceback (most recent call last):
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/venvs/airflow_3.1.0/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m12:56:14.386797 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.2410316, "process_in_blocks": "0", "process_kernel_time": 0.156769, "process_mem_max_rss": "132064", "process_out_blocks": "3360", "process_user_time": 1.139757}
[0m12:56:14.387159 [debug] [MainThread]: Command `dbt docs serve` failed at 12:56:14.387087 after 1.24 seconds
[0m12:56:14.387378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b355bceb860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b355acfb920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b355abf17c0>]}
[0m12:56:14.387589 [debug] [MainThread]: Flushing usage events
[0m12:56:15.193230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:39.479798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bdbf7823c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bdbfc05b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bdc161d580>]}


============================== 12:56:39.483545 | 23c0eaaa-292a-4d58-b1ca-74e4637e2334 ==============================
[0m12:56:39.483545 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:56:39.484054 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'empty': 'None', 'fail_fast': 'False', 'quiet': 'False', 'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'printer_width': '80', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'log_cache_events': 'False', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'indirect_selection': 'eager', 'profiles_dir': '/root/.dbt', 'use_experimental_parser': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'partial_parse': 'True'}
[0m12:56:39.714535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23c0eaaa-292a-4d58-b1ca-74e4637e2334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bdbf6bf800>]}
[0m12:56:39.759116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23c0eaaa-292a-4d58-b1ca-74e4637e2334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bdbfc04fe0>]}
[0m13:08:24.091889 [error] [MainThread]: Encountered an error:

[0m13:08:24.101131 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m13:08:24.102812 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 672.42566, "process_in_blocks": "111736", "process_kernel_time": 0.315355, "process_mem_max_rss": "131028", "process_out_blocks": "3368", "process_user_time": 1.252897}
[0m13:08:24.103270 [debug] [MainThread]: Command `dbt docs serve` failed at 13:08:24.103182 after 672.43 seconds
[0m13:08:24.103613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bdbed7deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bdb5041cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bdb5006570>]}
[0m13:08:24.103969 [debug] [MainThread]: Flushing usage events
[0m13:12:51.448853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3515fef4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35156ab3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35158e5f70>]}


============================== 13:12:51.452583 | 145e3e84-bb92-4cf2-b97b-077ead50a1a8 ==============================
[0m13:12:51.452583 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:12:51.452995 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'empty': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'partial_parse': 'True', 'introspect': 'True', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'write_json': 'True', 'invocation_command': 'dbt run', 'debug': 'False', 'quiet': 'False', 'no_print': 'None'}
[0m13:12:51.662105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '145e3e84-bb92-4cf2-b97b-077ead50a1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3515fef620>]}
[0m13:12:51.717761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '145e3e84-bb92-4cf2-b97b-077ead50a1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350b51f4d0>]}
[0m13:12:51.720100 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:12:51.767207 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:12:51.863594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m13:12:51.864006 [debug] [MainThread]: Partial parsing: added file: store_pipeline://models/schema/fact_sales.sql
[0m13:12:51.864225 [debug] [MainThread]: Partial parsing: added file: store_pipeline://models/schema/users_dim.sql
[0m13:12:51.864402 [debug] [MainThread]: Partial parsing: added file: store_pipeline://models/schema/products_dim.sql
[0m13:12:51.864569 [debug] [MainThread]: Partial parsing: added file: store_pipeline://models/schema/carts_dim.sql
[0m13:12:52.090064 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m13:12:52.099320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '145e3e84-bb92-4cf2-b97b-077ead50a1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350b08cb90>]}
[0m13:12:52.145113 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:12:52.147343 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:12:52.170089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '145e3e84-bb92-4cf2-b97b-077ead50a1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350af0e570>]}
[0m13:12:52.170508 [info ] [MainThread]: Found 7 models, 3 sources, 444 macros
[0m13:12:52.170905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '145e3e84-bb92-4cf2-b97b-077ead50a1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350b044dd0>]}
[0m13:12:52.172673 [info ] [MainThread]: 
[0m13:12:52.174005 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:12:52.174722 [info ] [MainThread]: 
[0m13:12:52.175249 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:12:52.179814 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:12:52.207953 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:12:52.208471 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:12:52.208680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:52.223742 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:12:52.224739 [debug] [ThreadPool]: On list_dev: Close
[0m13:12:52.225567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:12:52.226035 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:12:52.231013 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:12:52.231304 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:12:52.231474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:52.232663 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:12:52.233662 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:12:52.233890 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:12:52.234388 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:12:52.234732 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:12:52.234897 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:12:52.235892 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:12:52.236522 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:12:52.236721 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:12:52.236879 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:12:52.237293 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:12:52.237507 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:12:52.238708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:12:52.242583 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:12:52.242939 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:12:52.243317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:52.244227 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:12:52.244440 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:12:52.244624 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:12:52.255185 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m13:12:52.256210 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:12:52.257503 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:12:52.257747 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:12:52.259104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '145e3e84-bb92-4cf2-b97b-077ead50a1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350b01dbb0>]}
[0m13:12:52.259807 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:52.260386 [debug] [MainThread]: On master: BEGIN
[0m13:12:52.260733 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:52.261858 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:12:52.262101 [debug] [MainThread]: On master: COMMIT
[0m13:12:52.262384 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:52.262538 [debug] [MainThread]: On master: COMMIT
[0m13:12:52.263177 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:12:52.263434 [debug] [MainThread]: On master: Close
[0m13:12:52.267883 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m13:12:52.268366 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_carts ..................................... [RUN]
[0m13:12:52.268798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m13:12:52.269034 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m13:12:52.275370 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m13:12:52.275867 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m13:12:52.297792 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_carts"
[0m13:12:52.298510 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:12:52.298846 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: BEGIN
[0m13:12:52.299153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:52.300288 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.300747 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:12:52.301136 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(cart_date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m13:12:52.302076 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.306730 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:12:52.307214 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts" rename to "stg_carts__dbt_backup"
[0m13:12:52.308023 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.309865 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:12:52.310095 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts__dbt_tmp" rename to "stg_carts"
[0m13:12:52.310602 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:12:52.319301 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m13:12:52.319722 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:12:52.319961 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m13:12:52.324115 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:12:52.328240 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:12:52.328582 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

      drop view if exists "dev"."main"."stg_carts__dbt_backup" cascade
    
[0m13:12:52.331339 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:12:52.333244 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: Close
[0m13:12:52.335199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '145e3e84-bb92-4cf2-b97b-077ead50a1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35179973b0>]}
[0m13:12:52.335669 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_carts ................................ [[32mOK[0m in 0.07s]
[0m13:12:52.336056 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m13:12:52.336324 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m13:12:52.336636 [info ] [Thread-1 (]: 2 of 7 START sql view model main.stg_products .................................. [RUN]
[0m13:12:52.336992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m13:12:52.337341 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m13:12:52.339448 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m13:12:52.339944 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m13:12:52.341939 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_products"
[0m13:12:52.342331 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:12:52.342536 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: BEGIN
[0m13:12:52.342735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:52.343538 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.343775 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:12:52.343967 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH raw_products AS(
    SELECT * FROM "dev"."main"."products"
)
SELECT CAST(id AS INT) AS product_id, 
        CAST(title AS VARCHAR) AS product_title,
        CAST(price AS FLOAT) AS product_price,
        CAST(description AS VARCHAR) AS product_description,
        CAST(category AS VARCHAR) AS product_category,
        CAST(rating_rate AS FLOAT) AS product_rating_rate,
        CAST(rating_count AS INT) AS product_rating_count
FROM raw_products
  );

[0m13:12:52.344979 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.347311 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:12:52.347602 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m13:12:52.348431 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.350220 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:12:52.350476 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:12:52.351119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:12:52.352259 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m13:12:52.352571 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:12:52.352790 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m13:12:52.356354 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:12:52.359058 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:12:52.359468 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m13:12:52.363009 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:12:52.363960 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: Close
[0m13:12:52.365011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '145e3e84-bb92-4cf2-b97b-077ead50a1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34ad7021b0>]}
[0m13:12:52.365597 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.03s]
[0m13:12:52.366025 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m13:12:52.366290 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m13:12:52.366825 [info ] [Thread-1 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m13:12:52.367229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m13:12:52.367440 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m13:12:52.418806 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m13:12:52.419375 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m13:12:52.421576 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_users"
[0m13:12:52.422081 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:12:52.422370 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: BEGIN
[0m13:12:52.422565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:52.423293 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.423523 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:12:52.423743 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    WITH raw_users AS(
    SELECT * FROM "dev"."main"."users"
)
SELECT CAST(id AS INT) AS user_id, 
        CAST(email AS VARCHAR) AS user_email,
        CAST(username AS VARCHAR) AS user_username,
        CAST(password AS VARCHAR) AS user_password,
        CAST(name_firstname AS VARCHAR) AS user_name_firstname,
        CAST(name_lastname AS VARCHAR) AS user_name_lastname,
        CAST(address_city AS VARCHAR) AS user_address_city,
        CAST(address_street AS VARCHAR) AS user_address_street,
        CAST(address_number AS INT) AS user_address_number,
        CAST(address_zipcode AS VARCHAR) AS user_address_zipcode,
        CAST(phone AS VARCHAR) AS user_phone
FROM raw_users
  );

[0m13:12:52.425030 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.427324 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:12:52.427611 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m13:12:52.428338 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:12:52.430110 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:12:52.430415 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:12:52.432133 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.433421 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m13:12:52.433698 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:12:52.433966 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m13:12:52.436754 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:12:52.438696 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:12:52.439061 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m13:12:52.442281 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:12:52.443295 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: Close
[0m13:12:52.444094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '145e3e84-bb92-4cf2-b97b-077ead50a1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3515839f10>]}
[0m13:12:52.444604 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.08s]
[0m13:12:52.445149 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m13:12:52.445457 [debug] [Thread-1 (]: Began running node model.store_pipeline.products_dim
[0m13:12:52.446197 [info ] [Thread-1 (]: 4 of 7 START sql view model main.products_dim .................................. [RUN]
[0m13:12:52.446810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_users, now model.store_pipeline.products_dim)
[0m13:12:52.447313 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.products_dim
[0m13:12:52.449238 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.products_dim"
[0m13:12:52.449874 [debug] [Thread-1 (]: Began executing node model.store_pipeline.products_dim
[0m13:12:52.452038 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.products_dim"
[0m13:12:52.452741 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:12:52.453004 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: BEGIN
[0m13:12:52.453200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:52.453896 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.454202 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:12:52.454419 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

  
  create view "dev"."main"."products_dim__dbt_tmp" as (
    WITH products_dim AS(
    SELECT * FROM "dev"."main"."stg_products"
)
SELECT * FROM products_dim
  );

[0m13:12:52.455490 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.457494 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:12:52.457970 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */
alter view "dev"."main"."products_dim__dbt_tmp" rename to "products_dim"
[0m13:12:52.459052 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.460105 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m13:12:52.460346 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:12:52.460634 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m13:12:52.463501 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:12:52.465505 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:12:52.465829 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

      drop view if exists "dev"."main"."products_dim__dbt_backup" cascade
    
[0m13:12:52.466549 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:12:52.467537 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: Close
[0m13:12:52.467983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '145e3e84-bb92-4cf2-b97b-077ead50a1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f351589c200>]}
[0m13:12:52.468379 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.products_dim ............................. [[32mOK[0m in 0.02s]
[0m13:12:52.468741 [debug] [Thread-1 (]: Finished running node model.store_pipeline.products_dim
[0m13:12:52.469029 [debug] [Thread-1 (]: Began running node model.store_pipeline.carts_dim
[0m13:12:52.469484 [info ] [Thread-1 (]: 5 of 7 START sql view model main.carts_dim ..................................... [RUN]
[0m13:12:52.469807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.products_dim, now model.store_pipeline.carts_dim)
[0m13:12:52.470023 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.carts_dim
[0m13:12:52.472619 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.carts_dim"
[0m13:12:52.473215 [debug] [Thread-1 (]: Began executing node model.store_pipeline.carts_dim
[0m13:12:52.476876 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.carts_dim"
[0m13:12:52.478177 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:12:52.478763 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: BEGIN
[0m13:12:52.479018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:52.479884 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.480366 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:12:52.481134 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

  
  create view "dev"."main"."carts_dim__dbt_tmp" as (
    WITH user_dim AS(
    SELECT * FROM "dev"."main"."stg_users"
)
SELECT * FROM user_dim
  );

[0m13:12:52.482202 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.484368 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:12:52.484859 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */
alter view "dev"."main"."carts_dim__dbt_tmp" rename to "carts_dim"
[0m13:12:52.485812 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.486795 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m13:12:52.487037 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:12:52.487288 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m13:12:52.491267 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:12:52.493097 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:12:52.493365 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

      drop view if exists "dev"."main"."carts_dim__dbt_backup" cascade
    
[0m13:12:52.494203 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.495120 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: Close
[0m13:12:52.495669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '145e3e84-bb92-4cf2-b97b-077ead50a1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350b143ce0>]}
[0m13:12:52.496105 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.carts_dim ................................ [[32mOK[0m in 0.03s]
[0m13:12:52.496478 [debug] [Thread-1 (]: Finished running node model.store_pipeline.carts_dim
[0m13:12:52.496738 [debug] [Thread-1 (]: Began running node model.store_pipeline.users_dim
[0m13:12:52.497041 [info ] [Thread-1 (]: 6 of 7 START sql view model main.users_dim ..................................... [RUN]
[0m13:12:52.498424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.carts_dim, now model.store_pipeline.users_dim)
[0m13:12:52.498904 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.users_dim
[0m13:12:52.500862 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.users_dim"
[0m13:12:52.501272 [debug] [Thread-1 (]: Began executing node model.store_pipeline.users_dim
[0m13:12:52.503385 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.users_dim"
[0m13:12:52.504011 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:12:52.504363 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: BEGIN
[0m13:12:52.504654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:52.505477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.505714 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:12:52.505894 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

  
  create view "dev"."main"."users_dim__dbt_tmp" as (
    WITH users_dim AS (
    SELECT * FROM "dev"."main"."stg_users"
)
SELECT * FROM users_dim
  );

[0m13:12:52.506969 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.508790 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:12:52.509014 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */
alter view "dev"."main"."users_dim__dbt_tmp" rename to "users_dim"
[0m13:12:52.509589 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:12:52.510560 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m13:12:52.511270 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:12:52.511603 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m13:12:52.515694 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:12:52.517853 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:12:52.518586 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

      drop view if exists "dev"."main"."users_dim__dbt_backup" cascade
    
[0m13:12:52.520295 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.521455 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: Close
[0m13:12:52.522038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '145e3e84-bb92-4cf2-b97b-077ead50a1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35150a91f0>]}
[0m13:12:52.522535 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.users_dim ................................ [[32mOK[0m in 0.02s]
[0m13:12:52.522956 [debug] [Thread-1 (]: Finished running node model.store_pipeline.users_dim
[0m13:12:52.523620 [debug] [Thread-1 (]: Began running node model.store_pipeline.fact_sales
[0m13:12:52.524264 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fact_sales ................................... [RUN]
[0m13:12:52.525102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.users_dim, now model.store_pipeline.fact_sales)
[0m13:12:52.525718 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.fact_sales
[0m13:12:52.528878 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.fact_sales"
[0m13:12:52.529332 [debug] [Thread-1 (]: Began executing node model.store_pipeline.fact_sales
[0m13:12:52.546396 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.fact_sales"
[0m13:12:52.546957 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:12:52.547262 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: BEGIN
[0m13:12:52.547451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:52.548115 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:52.548336 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:12:52.548529 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

  
    
    

    create  table
      "dev"."main"."fact_sales__dbt_tmp"
  
    as (
      
WITH carts AS(
    SELECT * FROM "dev"."main"."carts_dim"
),
users AS(
    SELECT * FROM "dev"."main"."users_dim"
),
products AS(
    SELECT * FROM "dev"."main"."products_dim"
)
SELECT u.user_id, c.cart_id, p.product_id, p.product_price, p.product_rating_count,
         p.product_rating_count, c.cart_date
FROM carts c 
JOIN users u ON c.user_id = u.user_id
JOIN products p ON c.product_id = p.product_id
    );
  
  
[0m13:12:52.559307 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

  
    
    

    create  table
      "dev"."main"."fact_sales__dbt_tmp"
  
    as (
      
WITH carts AS(
    SELECT * FROM "dev"."main"."carts_dim"
),
users AS(
    SELECT * FROM "dev"."main"."users_dim"
),
products AS(
    SELECT * FROM "dev"."main"."products_dim"
)
SELECT u.user_id, c.cart_id, p.product_id, p.product_price, p.product_rating_count,
         p.product_rating_count, c.cart_date
FROM carts c 
JOIN users u ON c.user_id = u.user_id
JOIN products p ON c.product_id = p.product_id
    );
  
  
[0m13:12:52.559702 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:12:52.560003 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: ROLLBACK
[0m13:12:52.566762 [debug] [Thread-1 (]: Failed to rollback 'model.store_pipeline.fact_sales'
[0m13:12:52.567147 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: Close
[0m13:12:52.568888 [debug] [Thread-1 (]: Runtime Error in model fact_sales (models/schema/fact_sales.sql)
  Binder Error: Values list "c" does not have a column named "product_id"
  
  LINE 25: JOIN products p ON c.product_id = p.product_id
                              ^
[0m13:12:52.569241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '145e3e84-bb92-4cf2-b97b-077ead50a1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35178d64b0>]}
[0m13:12:52.569669 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model main.fact_sales .......................... [[31mERROR[0m in 0.04s]
[0m13:12:52.570201 [debug] [Thread-1 (]: Finished running node model.store_pipeline.fact_sales
[0m13:12:52.570703 [debug] [Thread-4 (]: Marking all children of 'model.store_pipeline.fact_sales' to be skipped because of status 'error'.  Reason: Runtime Error in model fact_sales (models/schema/fact_sales.sql)
  Binder Error: Values list "c" does not have a column named "product_id"
  
  LINE 25: JOIN products p ON c.product_id = p.product_id
                              ^.
[0m13:12:52.572585 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:52.572824 [debug] [MainThread]: On master: BEGIN
[0m13:12:52.572990 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:12:52.573777 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:12:52.574170 [debug] [MainThread]: On master: COMMIT
[0m13:12:52.574484 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:52.574772 [debug] [MainThread]: On master: COMMIT
[0m13:12:52.575386 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:12:52.575622 [debug] [MainThread]: On master: Close
[0m13:12:52.575930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:52.576111 [debug] [MainThread]: Connection 'model.store_pipeline.fact_sales' was properly closed.
[0m13:12:52.576326 [info ] [MainThread]: 
[0m13:12:52.576569 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m13:12:52.577452 [debug] [MainThread]: Command end result
[0m13:12:52.590220 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:12:52.591728 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:12:52.595881 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m13:12:52.596114 [info ] [MainThread]: 
[0m13:12:52.596433 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:12:52.596646 [info ] [MainThread]: 
[0m13:12:52.596907 [error] [MainThread]: [31mFailure in model fact_sales (models/schema/fact_sales.sql)[0m
[0m13:12:52.597186 [error] [MainThread]:   Runtime Error in model fact_sales (models/schema/fact_sales.sql)
  Binder Error: Values list "c" does not have a column named "product_id"
  
  LINE 25: JOIN products p ON c.product_id = p.product_id
                              ^
[0m13:12:52.597380 [info ] [MainThread]: 
[0m13:12:52.597598 [info ] [MainThread]:   compiled code at target/compiled/store_pipeline/models/schema/fact_sales.sql
[0m13:12:52.597914 [info ] [MainThread]: 
[0m13:12:52.598124 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m13:12:52.598770 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1966312, "process_in_blocks": "43968", "process_kernel_time": 0.239643, "process_mem_max_rss": "154652", "process_out_blocks": "3080", "process_user_time": 2.228264}
[0m13:12:52.599208 [debug] [MainThread]: Command `dbt run` failed at 13:12:52.599133 after 1.20 seconds
[0m13:12:52.599698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3515a05040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3515782360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350b1453a0>]}
[0m13:12:52.600026 [debug] [MainThread]: Flushing usage events
[0m13:12:53.691878 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:13:56.317720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f46f66dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f47147c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f46f4854f0>]}


============================== 13:13:56.320258 | 525bea53-54fc-4730-a12c-866d32406462 ==============================
[0m13:13:56.320258 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:13:56.320637 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'use_colors': 'True', 'profiles_dir': '/root/.dbt', 'write_json': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'quiet': 'False', 'version_check': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'target_path': 'None', 'warn_error': 'None', 'empty': 'False', 'cache_selected_only': 'False', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'static_parser': 'True', 'introspect': 'True'}
[0m13:13:56.489021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '525bea53-54fc-4730-a12c-866d32406462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f46f4854f0>]}
[0m13:13:56.538101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '525bea53-54fc-4730-a12c-866d32406462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f46e8b33b0>]}
[0m13:13:56.539183 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:13:56.578543 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:13:56.643593 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:13:56.643864 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:13:56.648527 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m13:13:56.668643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '525bea53-54fc-4730-a12c-866d32406462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f464c273e0>]}
[0m13:13:56.715970 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:13:56.717204 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:13:56.726913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '525bea53-54fc-4730-a12c-866d32406462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f464920080>]}
[0m13:13:56.728308 [info ] [MainThread]: Found 7 models, 3 sources, 444 macros
[0m13:13:56.728645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '525bea53-54fc-4730-a12c-866d32406462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f46497eea0>]}
[0m13:13:56.729917 [info ] [MainThread]: 
[0m13:13:56.730199 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:13:56.730404 [info ] [MainThread]: 
[0m13:13:56.730722 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:13:56.734370 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:13:56.759393 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:13:56.759749 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:13:56.759999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:56.774338 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:13:56.775505 [debug] [ThreadPool]: On list_dev: Close
[0m13:13:56.776359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:13:56.776868 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:13:56.782318 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:13:56.782646 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:13:56.782833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:56.783906 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:13:56.785076 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:13:56.785366 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:13:56.786187 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:13:56.786438 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:13:56.786598 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:13:56.787123 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:13:56.787798 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:13:56.788046 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:13:56.788242 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:13:56.788783 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:13:56.788998 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:13:56.790677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:13:56.795781 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:13:56.796093 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:13:56.796347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:56.797532 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:13:56.797834 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:13:56.798032 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:13:56.807095 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m13:13:56.808216 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:13:56.809037 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:13:56.809243 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:13:56.811428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '525bea53-54fc-4730-a12c-866d32406462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f46f3d23c0>]}
[0m13:13:56.811836 [debug] [MainThread]: Using duckdb connection "master"
[0m13:13:56.812086 [debug] [MainThread]: On master: BEGIN
[0m13:13:56.812312 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:13:56.813150 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:13:56.813430 [debug] [MainThread]: On master: COMMIT
[0m13:13:56.813632 [debug] [MainThread]: Using duckdb connection "master"
[0m13:13:56.813935 [debug] [MainThread]: On master: COMMIT
[0m13:13:56.814452 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:13:56.814685 [debug] [MainThread]: On master: Close
[0m13:13:56.817173 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m13:13:56.817608 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_carts ..................................... [RUN]
[0m13:13:56.818009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m13:13:56.818241 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m13:13:56.823316 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m13:13:56.823875 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m13:13:56.847035 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_carts"
[0m13:13:56.847616 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:13:56.847908 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: BEGIN
[0m13:13:56.848198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:56.849040 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:56.849291 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:13:56.849502 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(cart_date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m13:13:56.850477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:56.855267 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:13:56.855603 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts" rename to "stg_carts__dbt_backup"
[0m13:13:56.856489 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:56.858574 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:13:56.858886 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts__dbt_tmp" rename to "stg_carts"
[0m13:13:56.859655 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:56.868754 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m13:13:56.869131 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:13:56.869333 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m13:13:56.873922 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:13:56.879284 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:13:56.879701 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

      drop view if exists "dev"."main"."stg_carts__dbt_backup" cascade
    
[0m13:13:56.883719 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:13:56.885731 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: Close
[0m13:13:56.887218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '525bea53-54fc-4730-a12c-866d32406462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f4711bb350>]}
[0m13:13:56.887775 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_carts ................................ [[32mOK[0m in 0.07s]
[0m13:13:56.888283 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m13:13:56.888611 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m13:13:56.889057 [info ] [Thread-1 (]: 2 of 7 START sql view model main.stg_products .................................. [RUN]
[0m13:13:56.889402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m13:13:56.889620 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m13:13:56.891989 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m13:13:56.892620 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m13:13:56.894791 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_products"
[0m13:13:56.895263 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:13:56.895492 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: BEGIN
[0m13:13:56.895668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:56.896591 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:56.896863 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:13:56.897064 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH raw_products AS(
    SELECT * FROM "dev"."main"."products"
)
SELECT CAST(id AS INT) AS product_id, 
        CAST(title AS VARCHAR) AS product_title,
        CAST(price AS FLOAT) AS product_price,
        CAST(description AS VARCHAR) AS product_description,
        CAST(category AS VARCHAR) AS product_category,
        CAST(rating_rate AS FLOAT) AS product_rating_rate,
        CAST(rating_count AS INT) AS product_rating_count
FROM raw_products
  );

[0m13:13:56.898004 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:56.901023 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:13:56.901343 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m13:13:56.902102 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:13:56.903742 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:13:56.904080 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:13:56.905143 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:56.906478 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m13:13:56.906757 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:13:56.906952 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m13:13:56.911123 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:13:56.912858 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:13:56.913134 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m13:13:56.916433 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:13:56.917769 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: Close
[0m13:13:56.918554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '525bea53-54fc-4730-a12c-866d32406462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f463d007d0>]}
[0m13:13:56.919206 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.03s]
[0m13:13:56.919829 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m13:13:56.920319 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m13:13:56.920824 [info ] [Thread-1 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m13:13:56.921407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m13:13:56.921801 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m13:13:56.924062 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m13:13:56.925276 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m13:13:56.927589 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_users"
[0m13:13:56.928141 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:13:56.928450 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: BEGIN
[0m13:13:56.928654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:56.930388 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:56.930772 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:13:56.931058 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    WITH raw_users AS(
    SELECT * FROM "dev"."main"."users"
)
SELECT CAST(id AS INT) AS user_id, 
        CAST(email AS VARCHAR) AS user_email,
        CAST(username AS VARCHAR) AS user_username,
        CAST(password AS VARCHAR) AS user_password,
        CAST(name_firstname AS VARCHAR) AS user_name_firstname,
        CAST(name_lastname AS VARCHAR) AS user_name_lastname,
        CAST(address_city AS VARCHAR) AS user_address_city,
        CAST(address_street AS VARCHAR) AS user_address_street,
        CAST(address_number AS INT) AS user_address_number,
        CAST(address_zipcode AS VARCHAR) AS user_address_zipcode,
        CAST(phone AS VARCHAR) AS user_phone
FROM raw_users
  );

[0m13:13:56.932084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:56.934154 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:13:56.934433 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m13:13:56.935526 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:56.938423 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:13:56.938796 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:13:56.939749 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:56.941466 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m13:13:56.941910 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:13:56.942165 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m13:13:56.945783 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:13:56.947545 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:13:56.947807 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m13:13:56.951236 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:13:56.952490 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: Close
[0m13:13:56.953051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '525bea53-54fc-4730-a12c-866d32406462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f4607426f0>]}
[0m13:13:56.953521 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.03s]
[0m13:13:56.953897 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m13:13:56.954155 [debug] [Thread-1 (]: Began running node model.store_pipeline.products_dim
[0m13:13:56.954720 [info ] [Thread-1 (]: 4 of 7 START sql view model main.products_dim .................................. [RUN]
[0m13:13:56.955135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_users, now model.store_pipeline.products_dim)
[0m13:13:56.955368 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.products_dim
[0m13:13:56.957424 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.products_dim"
[0m13:13:56.958046 [debug] [Thread-1 (]: Began executing node model.store_pipeline.products_dim
[0m13:13:56.960431 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.products_dim"
[0m13:13:56.960954 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:13:56.961245 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: BEGIN
[0m13:13:56.961434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:56.962197 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:56.962458 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:13:56.962680 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

  
  create view "dev"."main"."products_dim__dbt_tmp" as (
    WITH products_dim AS(
    SELECT * FROM "dev"."main"."stg_products"
)
SELECT * FROM products_dim
  );

[0m13:13:56.963764 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:56.966638 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:13:56.966978 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */
alter view "dev"."main"."products_dim" rename to "products_dim__dbt_backup"
[0m13:13:56.967787 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:56.969587 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:13:56.971035 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */
alter view "dev"."main"."products_dim__dbt_tmp" rename to "products_dim"
[0m13:13:56.972131 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:56.973319 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m13:13:56.973647 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:13:56.973877 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m13:13:56.977223 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:13:56.979539 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:13:56.979993 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

      drop view if exists "dev"."main"."products_dim__dbt_backup" cascade
    
[0m13:13:56.984568 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:13:56.985742 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: Close
[0m13:13:56.986338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '525bea53-54fc-4730-a12c-866d32406462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f4607706e0>]}
[0m13:13:56.986749 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.products_dim ............................. [[32mOK[0m in 0.03s]
[0m13:13:56.987136 [debug] [Thread-1 (]: Finished running node model.store_pipeline.products_dim
[0m13:13:56.987382 [debug] [Thread-1 (]: Began running node model.store_pipeline.carts_dim
[0m13:13:56.987663 [info ] [Thread-1 (]: 5 of 7 START sql view model main.carts_dim ..................................... [RUN]
[0m13:13:56.988043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.products_dim, now model.store_pipeline.carts_dim)
[0m13:13:56.988312 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.carts_dim
[0m13:13:56.990002 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.carts_dim"
[0m13:13:56.990584 [debug] [Thread-1 (]: Began executing node model.store_pipeline.carts_dim
[0m13:13:56.992884 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.carts_dim"
[0m13:13:56.993366 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:13:56.993603 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: BEGIN
[0m13:13:56.993777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:56.994701 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:56.994998 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:13:56.995208 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

  
  create view "dev"."main"."carts_dim__dbt_tmp" as (
    WITH user_dim AS(
    SELECT * FROM "dev"."main"."stg_users"
)
SELECT * FROM user_dim
  );

[0m13:13:56.996206 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:56.998292 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:13:56.998554 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */
alter view "dev"."main"."carts_dim" rename to "carts_dim__dbt_backup"
[0m13:13:56.999396 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:57.001227 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:13:57.001480 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */
alter view "dev"."main"."carts_dim__dbt_tmp" rename to "carts_dim"
[0m13:13:57.002081 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:13:57.003013 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m13:13:57.003253 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:13:57.003480 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m13:13:57.007439 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:13:57.010168 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:13:57.010666 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

      drop view if exists "dev"."main"."carts_dim__dbt_backup" cascade
    
[0m13:13:57.014124 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:13:57.015454 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: Close
[0m13:13:57.016020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '525bea53-54fc-4730-a12c-866d32406462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f4649af7d0>]}
[0m13:13:57.016744 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.carts_dim ................................ [[32mOK[0m in 0.03s]
[0m13:13:57.017157 [debug] [Thread-1 (]: Finished running node model.store_pipeline.carts_dim
[0m13:13:57.017550 [debug] [Thread-1 (]: Began running node model.store_pipeline.users_dim
[0m13:13:57.018033 [info ] [Thread-1 (]: 6 of 7 START sql view model main.users_dim ..................................... [RUN]
[0m13:13:57.018431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.carts_dim, now model.store_pipeline.users_dim)
[0m13:13:57.018749 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.users_dim
[0m13:13:57.020533 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.users_dim"
[0m13:13:57.020956 [debug] [Thread-1 (]: Began executing node model.store_pipeline.users_dim
[0m13:13:57.022925 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.users_dim"
[0m13:13:57.023378 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:13:57.023629 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: BEGIN
[0m13:13:57.023811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:57.024873 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:57.025170 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:13:57.025370 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

  
  create view "dev"."main"."users_dim__dbt_tmp" as (
    WITH users_dim AS (
    SELECT * FROM "dev"."main"."stg_users"
)
SELECT * FROM users_dim
  );

[0m13:13:57.026298 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:57.028463 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:13:57.028875 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */
alter view "dev"."main"."users_dim" rename to "users_dim__dbt_backup"
[0m13:13:57.029855 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:57.032025 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:13:57.032316 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */
alter view "dev"."main"."users_dim__dbt_tmp" rename to "users_dim"
[0m13:13:57.032964 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:13:57.033944 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m13:13:57.034219 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:13:57.034421 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m13:13:57.037727 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:13:57.040595 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:13:57.040929 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

      drop view if exists "dev"."main"."users_dim__dbt_backup" cascade
    
[0m13:13:57.043843 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:13:57.044832 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: Close
[0m13:13:57.045310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '525bea53-54fc-4730-a12c-866d32406462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f4607a9f40>]}
[0m13:13:57.045735 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.users_dim ................................ [[32mOK[0m in 0.03s]
[0m13:13:57.046091 [debug] [Thread-1 (]: Finished running node model.store_pipeline.users_dim
[0m13:13:57.046768 [debug] [Thread-1 (]: Began running node model.store_pipeline.fact_sales
[0m13:13:57.047075 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fact_sales ................................... [RUN]
[0m13:13:57.047380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.users_dim, now model.store_pipeline.fact_sales)
[0m13:13:57.047600 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.fact_sales
[0m13:13:57.049512 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.fact_sales"
[0m13:13:57.049898 [debug] [Thread-1 (]: Began executing node model.store_pipeline.fact_sales
[0m13:13:57.105372 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.fact_sales"
[0m13:13:57.105906 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:13:57.106154 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: BEGIN
[0m13:13:57.106327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:57.107358 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:57.107842 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:13:57.108297 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

  
    
    

    create  table
      "dev"."main"."fact_sales__dbt_tmp"
  
    as (
      
WITH carts AS(
    SELECT * FROM "dev"."main"."carts_dim"
),
users AS(
    SELECT * FROM "dev"."main"."users_dim"
),
products AS(
    SELECT * FROM "dev"."main"."products_dim"
)
SELECT u.user_id, c.cart_id, p.product_id, p.product_price, p.product_rating_count,
         p.product_rating_count, c.cart_date
FROM carts c 
JOIN users u ON c.user_id = u.user_id
JOIN products p ON c.product_id = p.product_id
    );
  
  
[0m13:13:57.110375 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

  
    
    

    create  table
      "dev"."main"."fact_sales__dbt_tmp"
  
    as (
      
WITH carts AS(
    SELECT * FROM "dev"."main"."carts_dim"
),
users AS(
    SELECT * FROM "dev"."main"."users_dim"
),
products AS(
    SELECT * FROM "dev"."main"."products_dim"
)
SELECT u.user_id, c.cart_id, p.product_id, p.product_price, p.product_rating_count,
         p.product_rating_count, c.cart_date
FROM carts c 
JOIN users u ON c.user_id = u.user_id
JOIN products p ON c.product_id = p.product_id
    );
  
  
[0m13:13:57.110629 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:13:57.110887 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: ROLLBACK
[0m13:13:57.113198 [debug] [Thread-1 (]: Failed to rollback 'model.store_pipeline.fact_sales'
[0m13:13:57.113443 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: Close
[0m13:13:57.115556 [debug] [Thread-1 (]: Runtime Error in model fact_sales (models/schema/fact_sales.sql)
  Binder Error: Values list "c" does not have a column named "product_id"
  
  LINE 25: JOIN products p ON c.product_id = p.product_id
                              ^
[0m13:13:57.115910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '525bea53-54fc-4730-a12c-866d32406462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f4607a89b0>]}
[0m13:13:57.116352 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model main.fact_sales .......................... [[31mERROR[0m in 0.07s]
[0m13:13:57.116748 [debug] [Thread-1 (]: Finished running node model.store_pipeline.fact_sales
[0m13:13:57.117143 [debug] [Thread-4 (]: Marking all children of 'model.store_pipeline.fact_sales' to be skipped because of status 'error'.  Reason: Runtime Error in model fact_sales (models/schema/fact_sales.sql)
  Binder Error: Values list "c" does not have a column named "product_id"
  
  LINE 25: JOIN products p ON c.product_id = p.product_id
                              ^.
[0m13:13:57.118800 [debug] [MainThread]: Using duckdb connection "master"
[0m13:13:57.119033 [debug] [MainThread]: On master: BEGIN
[0m13:13:57.119216 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:13:57.119822 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:13:57.120018 [debug] [MainThread]: On master: COMMIT
[0m13:13:57.120277 [debug] [MainThread]: Using duckdb connection "master"
[0m13:13:57.120483 [debug] [MainThread]: On master: COMMIT
[0m13:13:57.120879 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:13:57.121067 [debug] [MainThread]: On master: Close
[0m13:13:57.121383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:57.121536 [debug] [MainThread]: Connection 'model.store_pipeline.fact_sales' was properly closed.
[0m13:13:57.121735 [info ] [MainThread]: 
[0m13:13:57.121964 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m13:13:57.122691 [debug] [MainThread]: Command end result
[0m13:13:57.134116 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:13:57.136018 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:13:57.140506 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m13:13:57.140763 [info ] [MainThread]: 
[0m13:13:57.141016 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:13:57.141201 [info ] [MainThread]: 
[0m13:13:57.141434 [error] [MainThread]: [31mFailure in model fact_sales (models/schema/fact_sales.sql)[0m
[0m13:13:57.141650 [error] [MainThread]:   Runtime Error in model fact_sales (models/schema/fact_sales.sql)
  Binder Error: Values list "c" does not have a column named "product_id"
  
  LINE 25: JOIN products p ON c.product_id = p.product_id
                              ^
[0m13:13:57.141839 [info ] [MainThread]: 
[0m13:13:57.142029 [info ] [MainThread]:   compiled code at target/compiled/store_pipeline/models/schema/fact_sales.sql
[0m13:13:57.142300 [info ] [MainThread]: 
[0m13:13:57.142548 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m13:13:57.143149 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.868968, "process_in_blocks": "0", "process_kernel_time": 0.221725, "process_mem_max_rss": "151996", "process_out_blocks": "2200", "process_user_time": 1.824005}
[0m13:13:57.143448 [debug] [MainThread]: Command `dbt run` failed at 13:13:57.143382 after 0.87 seconds
[0m13:13:57.143725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f46eeb3500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f46f0de3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f46f0dd6d0>]}
[0m13:13:57.143961 [debug] [MainThread]: Flushing usage events
[0m13:13:58.001121 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:15:48.432531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d266e71be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d266103ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d26689f590>]}


============================== 13:15:48.435824 | 17a475eb-1987-4b4b-b9af-1375a00f805d ==============================
[0m13:15:48.435824 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:15:48.436211 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'printer_width': '80', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'use_experimental_parser': 'False', 'quiet': 'False', 'fail_fast': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'profiles_dir': '/root/.dbt', 'empty': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True'}
[0m13:15:48.616696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17a475eb-1987-4b4b-b9af-1375a00f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d2661b2270>]}
[0m13:15:48.667316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17a475eb-1987-4b4b-b9af-1375a00f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d265f80ec0>]}
[0m13:15:48.668454 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:15:48.708694 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:15:48.786703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:15:48.787130 [debug] [MainThread]: Partial parsing: updated file: store_pipeline://models/schema/carts_dim.sql
[0m13:15:48.979616 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m13:15:48.989032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17a475eb-1987-4b4b-b9af-1375a00f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d25c0d9f40>]}
[0m13:15:49.034428 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:15:49.036133 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:15:49.046255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17a475eb-1987-4b4b-b9af-1375a00f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d25a927650>]}
[0m13:15:49.046599 [info ] [MainThread]: Found 7 models, 3 sources, 444 macros
[0m13:15:49.046886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17a475eb-1987-4b4b-b9af-1375a00f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d25c1041a0>]}
[0m13:15:49.048077 [info ] [MainThread]: 
[0m13:15:49.048355 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:15:49.048654 [info ] [MainThread]: 
[0m13:15:49.049352 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:15:49.053507 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:15:49.077078 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:15:49.077413 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:15:49.077612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:49.089495 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m13:15:49.090848 [debug] [ThreadPool]: On list_dev: Close
[0m13:15:49.091579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:15:49.091909 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:15:49.096794 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:15:49.097151 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:15:49.097488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:49.098647 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:15:49.099493 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:15:49.099678 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:15:49.100095 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:15:49.100274 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:15:49.100413 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:15:49.100797 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:15:49.101321 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:15:49.101519 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:15:49.101700 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:15:49.102428 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:15:49.102733 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:15:49.104356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:15:49.108047 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:15:49.108367 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:15:49.108577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:49.109476 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:15:49.109786 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:15:49.110018 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:15:49.118851 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m13:15:49.119957 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:15:49.120666 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:15:49.120879 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:15:49.123051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17a475eb-1987-4b4b-b9af-1375a00f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d25a90ea50>]}
[0m13:15:49.123459 [debug] [MainThread]: Using duckdb connection "master"
[0m13:15:49.123663 [debug] [MainThread]: On master: BEGIN
[0m13:15:49.123830 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:15:49.124632 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:15:49.124844 [debug] [MainThread]: On master: COMMIT
[0m13:15:49.125047 [debug] [MainThread]: Using duckdb connection "master"
[0m13:15:49.125207 [debug] [MainThread]: On master: COMMIT
[0m13:15:49.125648 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:15:49.125923 [debug] [MainThread]: On master: Close
[0m13:15:49.128503 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m13:15:49.129085 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_carts ..................................... [RUN]
[0m13:15:49.129707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m13:15:49.130054 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m13:15:49.135180 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m13:15:49.135840 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m13:15:49.159463 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_carts"
[0m13:15:49.159992 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:15:49.160417 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: BEGIN
[0m13:15:49.160649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:49.162048 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.162892 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:15:49.163163 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(cart_date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m13:15:49.164071 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.168157 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:15:49.168564 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts" rename to "stg_carts__dbt_backup"
[0m13:15:49.169410 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.171291 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:15:49.171532 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts__dbt_tmp" rename to "stg_carts"
[0m13:15:49.172164 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:15:49.180274 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m13:15:49.180609 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:15:49.180808 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m13:15:49.185566 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:15:49.189791 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:15:49.190200 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

      drop view if exists "dev"."main"."stg_carts__dbt_backup" cascade
    
[0m13:15:49.194372 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:15:49.196341 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: Close
[0m13:15:49.197830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17a475eb-1987-4b4b-b9af-1375a00f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d2689bbd70>]}
[0m13:15:49.198351 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_carts ................................ [[32mOK[0m in 0.07s]
[0m13:15:49.198729 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m13:15:49.198980 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m13:15:49.199267 [info ] [Thread-1 (]: 2 of 7 START sql view model main.stg_products .................................. [RUN]
[0m13:15:49.199620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m13:15:49.199904 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m13:15:49.202441 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m13:15:49.203495 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m13:15:49.205835 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_products"
[0m13:15:49.206334 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:15:49.206560 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: BEGIN
[0m13:15:49.206816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:49.207646 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.207932 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:15:49.208204 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH raw_products AS(
    SELECT * FROM "dev"."main"."products"
)
SELECT CAST(id AS INT) AS product_id, 
        CAST(title AS VARCHAR) AS product_title,
        CAST(price AS FLOAT) AS product_price,
        CAST(description AS VARCHAR) AS product_description,
        CAST(category AS VARCHAR) AS product_category,
        CAST(rating_rate AS FLOAT) AS product_rating_rate,
        CAST(rating_count AS INT) AS product_rating_count
FROM raw_products
  );

[0m13:15:49.209302 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.211512 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:15:49.211770 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m13:15:49.212376 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:15:49.214442 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:15:49.215273 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:15:49.216242 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.217346 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m13:15:49.217606 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:15:49.217840 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m13:15:49.221254 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:15:49.223406 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:15:49.223719 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m13:15:49.226921 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:15:49.228068 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: Close
[0m13:15:49.229076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17a475eb-1987-4b4b-b9af-1375a00f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d258601d30>]}
[0m13:15:49.229984 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.03s]
[0m13:15:49.230408 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m13:15:49.230693 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m13:15:49.230991 [info ] [Thread-1 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m13:15:49.231545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m13:15:49.231854 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m13:15:49.234759 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m13:15:49.235536 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m13:15:49.286709 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_users"
[0m13:15:49.287441 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:15:49.287844 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: BEGIN
[0m13:15:49.288327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:49.289106 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.289376 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:15:49.289605 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    WITH raw_users AS(
    SELECT * FROM "dev"."main"."users"
)
SELECT CAST(id AS INT) AS user_id, 
        CAST(email AS VARCHAR) AS user_email,
        CAST(username AS VARCHAR) AS user_username,
        CAST(password AS VARCHAR) AS user_password,
        CAST(name_firstname AS VARCHAR) AS user_name_firstname,
        CAST(name_lastname AS VARCHAR) AS user_name_lastname,
        CAST(address_city AS VARCHAR) AS user_address_city,
        CAST(address_street AS VARCHAR) AS user_address_street,
        CAST(address_number AS INT) AS user_address_number,
        CAST(address_zipcode AS VARCHAR) AS user_address_zipcode,
        CAST(phone AS VARCHAR) AS user_phone
FROM raw_users
  );

[0m13:15:49.290587 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.292603 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:15:49.292860 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m13:15:49.293487 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:15:49.296457 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:15:49.296797 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:15:49.297550 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:15:49.298733 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m13:15:49.298978 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:15:49.299175 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m13:15:49.302845 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:15:49.304570 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:15:49.304800 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m13:15:49.308933 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:15:49.310107 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: Close
[0m13:15:49.311005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17a475eb-1987-4b4b-b9af-1375a00f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d25c2df950>]}
[0m13:15:49.311452 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.08s]
[0m13:15:49.311904 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m13:15:49.312172 [debug] [Thread-1 (]: Began running node model.store_pipeline.carts_dim
[0m13:15:49.312683 [info ] [Thread-1 (]: 4 of 7 START sql view model main.carts_dim ..................................... [RUN]
[0m13:15:49.313109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_users, now model.store_pipeline.carts_dim)
[0m13:15:49.313378 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.carts_dim
[0m13:15:49.315845 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.carts_dim"
[0m13:15:49.316458 [debug] [Thread-1 (]: Began executing node model.store_pipeline.carts_dim
[0m13:15:49.318621 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.carts_dim"
[0m13:15:49.319064 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:15:49.319297 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: BEGIN
[0m13:15:49.319500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:49.320327 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.320690 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:15:49.321268 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

  
  create view "dev"."main"."carts_dim__dbt_tmp" as (
    WITH carts_dim AS(
    SELECT * FROM "dev"."main"."stg_carts"
)
SELECT * FROM carts_dim
  );

[0m13:15:49.322453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.324437 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:15:49.324678 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */
alter view "dev"."main"."carts_dim" rename to "carts_dim__dbt_backup"
[0m13:15:49.325259 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:15:49.326994 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:15:49.327323 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */
alter view "dev"."main"."carts_dim__dbt_tmp" rename to "carts_dim"
[0m13:15:49.328431 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.329616 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m13:15:49.329921 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:15:49.330139 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m13:15:49.333748 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:15:49.335934 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:15:49.336258 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

      drop view if exists "dev"."main"."carts_dim__dbt_backup" cascade
    
[0m13:15:49.339045 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:15:49.340256 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: Close
[0m13:15:49.340860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17a475eb-1987-4b4b-b9af-1375a00f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d2660225d0>]}
[0m13:15:49.341542 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.carts_dim ................................ [[32mOK[0m in 0.03s]
[0m13:15:49.341975 [debug] [Thread-1 (]: Finished running node model.store_pipeline.carts_dim
[0m13:15:49.342257 [debug] [Thread-1 (]: Began running node model.store_pipeline.products_dim
[0m13:15:49.342617 [info ] [Thread-1 (]: 5 of 7 START sql view model main.products_dim .................................. [RUN]
[0m13:15:49.343106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.carts_dim, now model.store_pipeline.products_dim)
[0m13:15:49.343316 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.products_dim
[0m13:15:49.345049 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.products_dim"
[0m13:15:49.345509 [debug] [Thread-1 (]: Began executing node model.store_pipeline.products_dim
[0m13:15:49.349118 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.products_dim"
[0m13:15:49.350581 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:15:49.351084 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: BEGIN
[0m13:15:49.351367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:49.352210 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.352547 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:15:49.352788 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

  
  create view "dev"."main"."products_dim__dbt_tmp" as (
    WITH products_dim AS(
    SELECT * FROM "dev"."main"."stg_products"
)
SELECT * FROM products_dim
  );

[0m13:15:49.354780 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:15:49.356988 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:15:49.357250 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */
alter view "dev"."main"."products_dim" rename to "products_dim__dbt_backup"
[0m13:15:49.358127 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.359690 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:15:49.360088 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */
alter view "dev"."main"."products_dim__dbt_tmp" rename to "products_dim"
[0m13:15:49.361050 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.362134 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m13:15:49.362398 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:15:49.362695 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m13:15:49.365954 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:15:49.368341 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:15:49.368701 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

      drop view if exists "dev"."main"."products_dim__dbt_backup" cascade
    
[0m13:15:49.371698 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:15:49.372792 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: Close
[0m13:15:49.373283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17a475eb-1987-4b4b-b9af-1375a00f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d25c107260>]}
[0m13:15:49.373824 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.products_dim ............................. [[32mOK[0m in 0.03s]
[0m13:15:49.374493 [debug] [Thread-1 (]: Finished running node model.store_pipeline.products_dim
[0m13:15:49.374969 [debug] [Thread-1 (]: Began running node model.store_pipeline.users_dim
[0m13:15:49.375583 [info ] [Thread-1 (]: 6 of 7 START sql view model main.users_dim ..................................... [RUN]
[0m13:15:49.376013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.products_dim, now model.store_pipeline.users_dim)
[0m13:15:49.376226 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.users_dim
[0m13:15:49.378038 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.users_dim"
[0m13:15:49.378503 [debug] [Thread-1 (]: Began executing node model.store_pipeline.users_dim
[0m13:15:49.381020 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.users_dim"
[0m13:15:49.381821 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:15:49.382318 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: BEGIN
[0m13:15:49.382771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:49.383558 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.383833 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:15:49.384053 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

  
  create view "dev"."main"."users_dim__dbt_tmp" as (
    WITH users_dim AS (
    SELECT * FROM "dev"."main"."stg_users"
)
SELECT * FROM users_dim
  );

[0m13:15:49.385145 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.388530 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:15:49.388909 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */
alter view "dev"."main"."users_dim" rename to "users_dim__dbt_backup"
[0m13:15:49.389772 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.391774 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:15:49.392088 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */
alter view "dev"."main"."users_dim__dbt_tmp" rename to "users_dim"
[0m13:15:49.392999 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.394465 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m13:15:49.394904 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:15:49.395125 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m13:15:49.398432 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:15:49.400292 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:15:49.400685 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

      drop view if exists "dev"."main"."users_dim__dbt_backup" cascade
    
[0m13:15:49.403693 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:15:49.404788 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: Close
[0m13:15:49.405347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17a475eb-1987-4b4b-b9af-1375a00f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d25c446120>]}
[0m13:15:49.405783 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.users_dim ................................ [[32mOK[0m in 0.03s]
[0m13:15:49.406528 [debug] [Thread-1 (]: Finished running node model.store_pipeline.users_dim
[0m13:15:49.407658 [debug] [Thread-1 (]: Began running node model.store_pipeline.fact_sales
[0m13:15:49.408430 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fact_sales ................................... [RUN]
[0m13:15:49.409011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.users_dim, now model.store_pipeline.fact_sales)
[0m13:15:49.409334 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.fact_sales
[0m13:15:49.411757 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.fact_sales"
[0m13:15:49.412262 [debug] [Thread-1 (]: Began executing node model.store_pipeline.fact_sales
[0m13:15:49.427840 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.fact_sales"
[0m13:15:49.428529 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:15:49.428904 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: BEGIN
[0m13:15:49.429170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:49.430103 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.430369 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:15:49.430591 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

  
    
    

    create  table
      "dev"."main"."fact_sales__dbt_tmp"
  
    as (
      
WITH carts AS(
    SELECT * FROM "dev"."main"."carts_dim"
),
users AS(
    SELECT * FROM "dev"."main"."users_dim"
),
products AS(
    SELECT * FROM "dev"."main"."products_dim"
)
SELECT u.user_id, c.cart_id, p.product_id, p.product_price, p.product_rating_count,
         p.product_rating_count, c.cart_date
FROM carts c 
JOIN users u ON c.user_id = u.user_id
JOIN products p ON c.product_id = p.product_id
    );
  
  
[0m13:15:49.444684 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m13:15:49.448581 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:15:49.448994 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */
alter table "dev"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m13:15:49.449820 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.453563 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: COMMIT
[0m13:15:49.453975 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:15:49.454224 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: COMMIT
[0m13:15:49.457566 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:15:49.459203 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:15:49.459526 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

      drop table if exists "dev"."main"."fact_sales__dbt_backup" cascade
    
[0m13:15:49.460622 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:49.461780 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: Close
[0m13:15:49.462857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17a475eb-1987-4b4b-b9af-1375a00f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d25c1435f0>]}
[0m13:15:49.463295 [info ] [Thread-1 (]: 7 of 7 OK created sql table model main.fact_sales .............................. [[32mOK[0m in 0.05s]
[0m13:15:49.463686 [debug] [Thread-1 (]: Finished running node model.store_pipeline.fact_sales
[0m13:15:49.464765 [debug] [MainThread]: Using duckdb connection "master"
[0m13:15:49.464996 [debug] [MainThread]: On master: BEGIN
[0m13:15:49.465204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:15:49.465817 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:15:49.466107 [debug] [MainThread]: On master: COMMIT
[0m13:15:49.466437 [debug] [MainThread]: Using duckdb connection "master"
[0m13:15:49.466670 [debug] [MainThread]: On master: COMMIT
[0m13:15:49.467263 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:15:49.467524 [debug] [MainThread]: On master: Close
[0m13:15:49.467873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:49.468062 [debug] [MainThread]: Connection 'model.store_pipeline.fact_sales' was properly closed.
[0m13:15:49.468306 [info ] [MainThread]: 
[0m13:15:49.468542 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m13:15:49.469374 [debug] [MainThread]: Command end result
[0m13:15:49.481647 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:15:49.482993 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:15:49.487908 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m13:15:49.488207 [info ] [MainThread]: 
[0m13:15:49.488489 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:15:49.488713 [info ] [MainThread]: 
[0m13:15:49.488982 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m13:15:49.489675 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1088837, "process_in_blocks": "3240", "process_kernel_time": 0.220226, "process_mem_max_rss": "156412", "process_out_blocks": "3096", "process_user_time": 2.147208}
[0m13:15:49.489999 [debug] [MainThread]: Command `dbt run` succeeded at 13:15:49.489933 after 1.11 seconds
[0m13:15:49.490215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d266f905c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d266121af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d266122c00>]}
[0m13:15:49.490426 [debug] [MainThread]: Flushing usage events
[0m13:15:50.396419 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:27.917036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1cde0e6540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1cdf192420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1cddc25070>]}


============================== 13:16:27.920457 | d3a1a174-cdcf-4c9a-bde8-bf54db92df44 ==============================
[0m13:16:27.920457 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:16:27.921029 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/root/.dbt', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'version_check': 'True', 'empty': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'debug': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:16:28.097102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3a1a174-cdcf-4c9a-bde8-bf54db92df44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1cd39ebb60>]}
[0m13:16:28.141824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3a1a174-cdcf-4c9a-bde8-bf54db92df44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1cd3808830>]}
[0m13:16:29.373332 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m13:16:29.374488 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m13:16:29.375263 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.4960825, "process_in_blocks": "43224", "process_kernel_time": 0.169101, "process_mem_max_rss": "130720", "process_out_blocks": "3360", "process_user_time": 1.196396}
[0m13:16:29.375635 [debug] [MainThread]: Command `dbt docs serve` failed at 13:16:29.375555 after 1.50 seconds
[0m13:16:29.375860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1cdd37f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1cdd37f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1cdd410ad0>]}
[0m13:16:29.376080 [debug] [MainThread]: Flushing usage events
[0m13:16:30.216391 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:38.551299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce464f6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce463e9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce45d5de50>]}


============================== 13:16:38.553491 | 63fb4cff-8f57-4140-a6d9-e22b3231b069 ==============================
[0m13:16:38.553491 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:16:38.553855 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'indirect_selection': 'eager', 'quiet': 'False', 'warn_error': 'None', 'version_check': 'True', 'target_path': 'None', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'debug': 'False', 'empty': 'None', 'write_json': 'True', 'invocation_command': 'dbt docs serve', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'no_print': 'None', 'static_parser': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False'}
[0m13:16:38.702913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63fb4cff-8f57-4140-a6d9-e22b3231b069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce4791b320>]}
[0m13:16:38.745097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63fb4cff-8f57-4140-a6d9-e22b3231b069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce453abdd0>]}
[0m13:16:39.683999 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m13:16:39.685206 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m13:16:39.685931 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.1712708, "process_in_blocks": "0", "process_kernel_time": 0.186048, "process_mem_max_rss": "130552", "process_out_blocks": "3344", "process_user_time": 1.104159}
[0m13:16:39.686253 [debug] [MainThread]: Command `dbt docs serve` failed at 13:16:39.686183 after 1.17 seconds
[0m13:16:39.686470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce463e9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce46168b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3b90a0c0>]}
[0m13:16:39.686727 [debug] [MainThread]: Flushing usage events
[0m13:16:40.574459 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:50.481562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72790c942000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72790c810e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72790c1269c0>]}


============================== 13:16:50.483915 | 51398e49-72df-4da4-8e14-7bdbd86fe527 ==============================
[0m13:16:50.483915 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:16:50.484295 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/root/.dbt', 'static_parser': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'fail_fast': 'False', 'empty': 'None', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'printer_width': '80', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate'}
[0m13:16:50.630443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51398e49-72df-4da4-8e14-7bdbd86fe527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72790b90b740>]}
[0m13:16:50.673434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51398e49-72df-4da4-8e14-7bdbd86fe527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727901cf8830>]}
[0m13:16:50.676477 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:16:50.718984 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:16:50.805035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:16:50.805335 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:16:50.809608 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m13:16:50.829376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51398e49-72df-4da4-8e14-7bdbd86fe527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727901dd5700>]}
[0m13:16:50.842165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51398e49-72df-4da4-8e14-7bdbd86fe527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727901de8bc0>]}
[0m13:16:50.842547 [info ] [MainThread]: Found 7 models, 3 sources, 444 macros
[0m13:16:50.842803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51398e49-72df-4da4-8e14-7bdbd86fe527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72790e03cf50>]}
[0m13:16:50.844172 [info ] [MainThread]: 
[0m13:16:50.844480 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:16:50.844760 [info ] [MainThread]: 
[0m13:16:50.845213 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:16:50.848502 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m13:16:50.886946 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:16:50.887249 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:16:50.887434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:50.906073 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m13:16:50.906429 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:16:50.906665 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:16:50.926713 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m13:16:50.928426 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:16:50.930004 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:16:50.930238 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:16:50.931766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51398e49-72df-4da4-8e14-7bdbd86fe527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72790b7d0f50>]}
[0m13:16:50.933697 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m13:16:50.934001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m13:16:50.934219 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m13:16:50.938832 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m13:16:50.939246 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m13:16:50.939671 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m13:16:50.939914 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m13:16:50.940482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m13:16:50.940731 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m13:16:50.942358 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m13:16:50.942756 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m13:16:50.943168 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m13:16:50.943405 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m13:16:50.943654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m13:16:50.944048 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m13:16:50.945914 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m13:16:50.946257 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m13:16:50.946646 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m13:16:50.946889 [debug] [Thread-1 (]: Began running node model.store_pipeline.carts_dim
[0m13:16:50.947139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_users, now model.store_pipeline.carts_dim)
[0m13:16:50.947374 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.carts_dim
[0m13:16:50.948802 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.carts_dim"
[0m13:16:50.949555 [debug] [Thread-1 (]: Began executing node model.store_pipeline.carts_dim
[0m13:16:50.949953 [debug] [Thread-1 (]: Finished running node model.store_pipeline.carts_dim
[0m13:16:50.950192 [debug] [Thread-1 (]: Began running node model.store_pipeline.products_dim
[0m13:16:50.950588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.carts_dim, now model.store_pipeline.products_dim)
[0m13:16:50.950820 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.products_dim
[0m13:16:50.952291 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.products_dim"
[0m13:16:50.952606 [debug] [Thread-1 (]: Began executing node model.store_pipeline.products_dim
[0m13:16:50.953070 [debug] [Thread-1 (]: Finished running node model.store_pipeline.products_dim
[0m13:16:50.953320 [debug] [Thread-1 (]: Began running node model.store_pipeline.users_dim
[0m13:16:50.953687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.products_dim, now model.store_pipeline.users_dim)
[0m13:16:50.953908 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.users_dim
[0m13:16:50.955258 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.users_dim"
[0m13:16:50.955569 [debug] [Thread-1 (]: Began executing node model.store_pipeline.users_dim
[0m13:16:50.955946 [debug] [Thread-1 (]: Finished running node model.store_pipeline.users_dim
[0m13:16:50.956510 [debug] [Thread-1 (]: Began running node model.store_pipeline.fact_sales
[0m13:16:50.956802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.users_dim, now model.store_pipeline.fact_sales)
[0m13:16:50.957089 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.fact_sales
[0m13:16:50.959161 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.fact_sales"
[0m13:16:50.959510 [debug] [Thread-1 (]: Began executing node model.store_pipeline.fact_sales
[0m13:16:50.959905 [debug] [Thread-1 (]: Finished running node model.store_pipeline.fact_sales
[0m13:16:50.960737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:50.960979 [debug] [MainThread]: Connection 'model.store_pipeline.fact_sales' was properly closed.
[0m13:16:50.961700 [debug] [MainThread]: Command end result
[0m13:16:51.002319 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:16:51.004534 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:16:51.008600 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m13:16:51.010128 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m13:16:51.010330 [info ] [MainThread]: Building catalog
[0m13:16:51.016306 [debug] [ThreadPool]: Acquiring new duckdb connection 'dev.information_schema'
[0m13:16:51.020054 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m13:16:51.020310 [debug] [ThreadPool]: On dev.information_schema: BEGIN
[0m13:16:51.020476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:51.021401 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:16:51.021648 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m13:16:51.021839 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "dev.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dev'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dev'
    )
    select
        'dev' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m13:16:51.033152 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:16:51.035840 [debug] [ThreadPool]: On dev.information_schema: ROLLBACK
[0m13:16:51.036463 [debug] [ThreadPool]: Failed to rollback 'dev.information_schema'
[0m13:16:51.036663 [debug] [ThreadPool]: On dev.information_schema: Close
[0m13:16:51.044874 [debug] [MainThread]: Wrote artifact CatalogArtifact to /root/airflow/dags/store_pipeline/target/catalog.json
[0m13:16:51.055418 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:16:51.056662 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:16:51.056944 [info ] [MainThread]: Catalog written to /root/airflow/dags/store_pipeline/target/catalog.json
[0m13:16:51.057743 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.61568373, "process_in_blocks": "17816", "process_kernel_time": 0.191721, "process_mem_max_rss": "150716", "process_out_blocks": "5344", "process_user_time": 1.404571}
[0m13:16:51.058072 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:16:51.057996 after 0.62 seconds
[0m13:16:51.058272 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:16:51.058437 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.
[0m13:16:51.058638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72790e2ddbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72790191bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72790bcd3800>]}
[0m13:16:51.058839 [debug] [MainThread]: Flushing usage events
[0m13:16:51.905350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:54.390993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6e3bafa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6e3916570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6e3626d80>]}


============================== 13:16:54.393318 | b0f128a5-6df1-44f6-8a11-f82d20d1c45e ==============================
[0m13:16:54.393318 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:16:54.393834 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'fail_fast': 'False', 'debug': 'False', 'empty': 'None', 'printer_width': '80', 'partial_parse': 'True', 'invocation_command': 'dbt docs serve', 'cache_selected_only': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'profiles_dir': '/root/.dbt', 'write_json': 'True', 'log_format': 'default', 'no_print': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:16:54.543959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0f128a5-6df1-44f6-8a11-f82d20d1c45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6e2fc08f0>]}
[0m13:16:54.586181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0f128a5-6df1-44f6-8a11-f82d20d1c45e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6e3516330>]}
[0m13:16:55.608347 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m13:16:55.609730 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m13:16:55.612918 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.2587335, "process_in_blocks": "0", "process_kernel_time": 0.16312, "process_mem_max_rss": "130888", "process_out_blocks": "3352", "process_user_time": 1.084752}
[0m13:16:55.613382 [debug] [MainThread]: Command `dbt docs serve` failed at 13:16:55.613254 after 1.26 seconds
[0m13:16:55.613681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6e3716ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6e2bc4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6d8f4b560>]}
[0m13:16:55.613926 [debug] [MainThread]: Flushing usage events
[0m13:16:56.400481 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:17:07.122174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799401d137d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7994032d5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799401978f20>]}


============================== 13:17:07.124488 | 491210ff-cd94-4992-bb80-21136de64557 ==============================
[0m13:17:07.124488 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:17:07.124909 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/root/.dbt', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'fail_fast': 'False', 'log_format': 'default', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'target_path': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'debug': 'False', 'no_print': 'None', 'introspect': 'True', 'write_json': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False'}
[0m13:17:07.272173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '491210ff-cd94-4992-bb80-21136de64557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7994013a60f0>]}
[0m13:17:07.315065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '491210ff-cd94-4992-bb80-21136de64557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7994013a5220>]}
[0m13:17:08.629723 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m13:17:08.631706 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m13:17:08.632534 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.548203, "process_in_blocks": "0", "process_kernel_time": 0.158776, "process_mem_max_rss": "130748", "process_out_blocks": "3352", "process_user_time": 1.115613}
[0m13:17:08.632969 [debug] [MainThread]: Command `dbt docs serve` failed at 13:17:08.632870 after 1.55 seconds
[0m13:17:08.633280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799403cbb470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7993f794afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7993f794b860>]}
[0m13:17:08.633818 [debug] [MainThread]: Flushing usage events
[0m13:17:09.445046 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:17:38.640598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762b91a9a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762b9158fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762b91a9a780>]}


============================== 13:17:38.643598 | 2192c29e-2d1e-41bf-a24e-66de8eb59993 ==============================
[0m13:17:38.643598 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:17:38.644306 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'invocation_command': 'dbt docs generate', 'debug': 'False', 'target_path': 'None', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'indirect_selection': 'eager', 'printer_width': '80', 'write_json': 'True', 'static_parser': 'True', 'empty': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'no_print': 'None', 'log_format': 'default', 'fail_fast': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'introspect': 'True'}
[0m13:17:38.787327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2192c29e-2d1e-41bf-a24e-66de8eb59993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762b90beb440>]}
[0m13:17:38.829392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2192c29e-2d1e-41bf-a24e-66de8eb59993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762b8c9a8590>]}
[0m13:17:38.830456 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:17:38.865593 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:17:38.923020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:17:38.923305 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:17:38.927419 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m13:17:38.945377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2192c29e-2d1e-41bf-a24e-66de8eb59993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762b86f29e50>]}
[0m13:17:38.956311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2192c29e-2d1e-41bf-a24e-66de8eb59993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762b86c8d520>]}
[0m13:17:38.956651 [info ] [MainThread]: Found 7 models, 3 sources, 444 macros
[0m13:17:38.957119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2192c29e-2d1e-41bf-a24e-66de8eb59993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762b8c961340>]}
[0m13:17:38.958463 [info ] [MainThread]: 
[0m13:17:38.958755 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:17:38.958994 [info ] [MainThread]: 
[0m13:17:38.959389 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:17:38.962661 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m13:17:38.987287 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:17:38.987560 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:17:38.987736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:38.998506 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:17:38.999151 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:17:38.999416 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:17:39.007500 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m13:17:39.008582 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:17:39.009256 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:17:39.009463 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:17:39.011078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2192c29e-2d1e-41bf-a24e-66de8eb59993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762b86c29e80>]}
[0m13:17:39.013377 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m13:17:39.013662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m13:17:39.013857 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m13:17:39.018366 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m13:17:39.018757 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m13:17:39.019191 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m13:17:39.019438 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m13:17:39.019769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m13:17:39.020024 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m13:17:39.022794 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m13:17:39.023385 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m13:17:39.023880 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m13:17:39.024114 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m13:17:39.024442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m13:17:39.024771 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m13:17:39.026675 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m13:17:39.027142 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m13:17:39.027600 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m13:17:39.027831 [debug] [Thread-1 (]: Began running node model.store_pipeline.carts_dim
[0m13:17:39.028085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_users, now model.store_pipeline.carts_dim)
[0m13:17:39.028309 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.carts_dim
[0m13:17:39.029768 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.carts_dim"
[0m13:17:39.030334 [debug] [Thread-1 (]: Began executing node model.store_pipeline.carts_dim
[0m13:17:39.030715 [debug] [Thread-1 (]: Finished running node model.store_pipeline.carts_dim
[0m13:17:39.031033 [debug] [Thread-1 (]: Began running node model.store_pipeline.products_dim
[0m13:17:39.031392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.carts_dim, now model.store_pipeline.products_dim)
[0m13:17:39.031601 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.products_dim
[0m13:17:39.032990 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.products_dim"
[0m13:17:39.033301 [debug] [Thread-1 (]: Began executing node model.store_pipeline.products_dim
[0m13:17:39.033706 [debug] [Thread-1 (]: Finished running node model.store_pipeline.products_dim
[0m13:17:39.033931 [debug] [Thread-1 (]: Began running node model.store_pipeline.users_dim
[0m13:17:39.034196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.products_dim, now model.store_pipeline.users_dim)
[0m13:17:39.034567 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.users_dim
[0m13:17:39.035965 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.users_dim"
[0m13:17:39.036301 [debug] [Thread-1 (]: Began executing node model.store_pipeline.users_dim
[0m13:17:39.036670 [debug] [Thread-1 (]: Finished running node model.store_pipeline.users_dim
[0m13:17:39.037168 [debug] [Thread-1 (]: Began running node model.store_pipeline.fact_sales
[0m13:17:39.037444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.users_dim, now model.store_pipeline.fact_sales)
[0m13:17:39.037719 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.fact_sales
[0m13:17:39.039633 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.fact_sales"
[0m13:17:39.040114 [debug] [Thread-1 (]: Began executing node model.store_pipeline.fact_sales
[0m13:17:39.040495 [debug] [Thread-1 (]: Finished running node model.store_pipeline.fact_sales
[0m13:17:39.041311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:39.041501 [debug] [MainThread]: Connection 'model.store_pipeline.fact_sales' was properly closed.
[0m13:17:39.042179 [debug] [MainThread]: Command end result
[0m13:17:39.081625 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:17:39.082856 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:17:39.086949 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m13:17:39.088459 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m13:17:39.088658 [info ] [MainThread]: Building catalog
[0m13:17:39.094419 [debug] [ThreadPool]: Acquiring new duckdb connection 'dev.information_schema'
[0m13:17:39.099324 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m13:17:39.099735 [debug] [ThreadPool]: On dev.information_schema: BEGIN
[0m13:17:39.100045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:39.100710 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:17:39.100898 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m13:17:39.101062 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "dev.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dev'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dev'
    )
    select
        'dev' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m13:17:39.106634 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m13:17:39.109045 [debug] [ThreadPool]: On dev.information_schema: ROLLBACK
[0m13:17:39.109581 [debug] [ThreadPool]: Failed to rollback 'dev.information_schema'
[0m13:17:39.109747 [debug] [ThreadPool]: On dev.information_schema: Close
[0m13:17:39.118655 [debug] [MainThread]: Wrote artifact CatalogArtifact to /root/airflow/dags/store_pipeline/target/catalog.json
[0m13:17:39.129104 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:17:39.130381 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:17:39.130655 [info ] [MainThread]: Catalog written to /root/airflow/dags/store_pipeline/target/catalog.json
[0m13:17:39.131461 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.53045195, "process_in_blocks": "0", "process_kernel_time": 0.150021, "process_mem_max_rss": "150912", "process_out_blocks": "5344", "process_user_time": 1.379367}
[0m13:17:39.131808 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:17:39.131739 after 0.53 seconds
[0m13:17:39.131987 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:17:39.132125 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.
[0m13:17:39.132290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762b90fc05c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762b91b24e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762b8c925550>]}
[0m13:17:39.132476 [debug] [MainThread]: Flushing usage events
[0m13:17:40.010993 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:17:46.083080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f44d9e960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f446867e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f44a1cf80>]}


============================== 13:17:46.085294 | 144cebc8-e4b9-460d-bd95-c871d2198f80 ==============================
[0m13:17:46.085294 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:17:46.085686 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'printer_width': '80', 'no_print': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'quiet': 'False', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True'}
[0m13:17:46.237842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '144cebc8-e4b9-460d-bd95-c871d2198f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f43ade300>]}
[0m13:17:46.281829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '144cebc8-e4b9-460d-bd95-c871d2198f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f43b14ad0>]}
[0m13:20:31.136410 [error] [MainThread]: Encountered an error:

[0m13:20:31.140170 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m13:20:31.141284 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 157.34618, "process_in_blocks": "152", "process_kernel_time": 0.15604, "process_mem_max_rss": "131636", "process_out_blocks": "3360", "process_user_time": 1.155544}
[0m13:20:31.141711 [debug] [MainThread]: Command `dbt docs serve` failed at 13:20:31.141626 after 157.35 seconds
[0m13:20:31.142072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f445775c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f44264b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753f439db380>]}
[0m13:20:31.142322 [debug] [MainThread]: Flushing usage events
[0m13:34:50.961050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78373dd27bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78373d8b4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78373ff7c3b0>]}


============================== 13:34:50.965949 | 3d453d0d-41ec-4ec0-a8bf-898dc6dca09e ==============================
[0m13:34:50.965949 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:34:50.966401 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'quiet': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'static_parser': 'True', 'log_format': 'default', 'use_colors': 'True', 'empty': 'False', 'write_json': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'introspect': 'True', 'version_check': 'True', 'cache_selected_only': 'False'}
[0m13:34:51.162825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d453d0d-41ec-4ec0-a8bf-898dc6dca09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78373fce4290>]}
[0m13:34:51.212591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d453d0d-41ec-4ec0-a8bf-898dc6dca09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783733812c90>]}
[0m13:34:51.215355 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:34:51.262348 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:34:51.359378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:34:51.359962 [debug] [MainThread]: Partial parsing: updated file: store_pipeline://models/schema/fact_sales.sql
[0m13:34:51.530698 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m13:34:51.540311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d453d0d-41ec-4ec0-a8bf-898dc6dca09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78373330bdd0>]}
[0m13:34:51.581770 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:34:51.584644 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:34:51.605805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d453d0d-41ec-4ec0-a8bf-898dc6dca09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783730541400>]}
[0m13:34:51.606133 [info ] [MainThread]: Found 7 models, 3 sources, 444 macros
[0m13:34:51.606397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d453d0d-41ec-4ec0-a8bf-898dc6dca09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78373352f0b0>]}
[0m13:34:51.607609 [info ] [MainThread]: 
[0m13:34:51.607907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:34:51.608127 [info ] [MainThread]: 
[0m13:34:51.608452 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:34:51.611575 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:34:51.642051 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:34:51.642345 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:34:51.642535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:51.662770 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m13:34:51.663845 [debug] [ThreadPool]: On list_dev: Close
[0m13:34:51.664553 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:34:51.664866 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:34:51.669209 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:34:51.669445 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:34:51.669612 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:51.671102 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:34:51.671978 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:34:51.672169 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:34:51.672581 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:34:51.672779 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:34:51.672929 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:34:51.673795 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:34:51.674362 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:34:51.674588 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:34:51.674742 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:34:51.675690 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:34:51.675944 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:34:51.677372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:34:51.680956 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:34:51.681354 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:34:51.681548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:51.682091 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:34:51.682271 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:34:51.682415 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:34:51.694878 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m13:34:51.695984 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:34:51.697510 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:34:51.697721 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:34:51.699267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d453d0d-41ec-4ec0-a8bf-898dc6dca09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78373fb93230>]}
[0m13:34:51.699606 [debug] [MainThread]: Using duckdb connection "master"
[0m13:34:51.699859 [debug] [MainThread]: On master: BEGIN
[0m13:34:51.700055 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:34:51.700763 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:34:51.700974 [debug] [MainThread]: On master: COMMIT
[0m13:34:51.701146 [debug] [MainThread]: Using duckdb connection "master"
[0m13:34:51.701305 [debug] [MainThread]: On master: COMMIT
[0m13:34:51.701786 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:34:51.701989 [debug] [MainThread]: On master: Close
[0m13:34:51.706424 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m13:34:51.706904 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_carts ..................................... [RUN]
[0m13:34:51.707306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m13:34:51.707553 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m13:34:51.712435 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m13:34:51.713451 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m13:34:51.736299 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_carts"
[0m13:34:51.736879 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:34:51.737184 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: BEGIN
[0m13:34:51.737381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:51.738261 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:34:51.738491 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:34:51.738669 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(cart_date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m13:34:51.739392 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:34:51.743479 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:34:51.743769 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts" rename to "stg_carts__dbt_backup"
[0m13:34:51.744495 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:34:51.746125 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:34:51.746331 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts__dbt_tmp" rename to "stg_carts"
[0m13:34:51.746874 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:34:51.754685 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m13:34:51.754973 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:34:51.755186 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m13:34:51.762531 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:34:51.766469 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:34:51.766725 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

      drop view if exists "dev"."main"."stg_carts__dbt_backup" cascade
    
[0m13:34:51.770775 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:34:51.772497 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: Close
[0m13:34:51.774126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d453d0d-41ec-4ec0-a8bf-898dc6dca09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837338c9250>]}
[0m13:34:51.774569 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_carts ................................ [[32mOK[0m in 0.07s]
[0m13:34:51.775001 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m13:34:51.775283 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m13:34:51.775783 [info ] [Thread-1 (]: 2 of 7 START sql view model main.stg_products .................................. [RUN]
[0m13:34:51.776322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m13:34:51.776563 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m13:34:51.778308 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m13:34:51.778677 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m13:34:51.781210 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_products"
[0m13:34:51.781716 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:34:51.782047 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: BEGIN
[0m13:34:51.782265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:51.782931 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:34:51.783154 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:34:51.783351 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH raw_products AS(
    SELECT * FROM "dev"."main"."products"
)
SELECT CAST(id AS INT) AS product_id, 
        CAST(title AS VARCHAR) AS product_title,
        CAST(price AS FLOAT) AS product_price,
        CAST(description AS VARCHAR) AS product_description,
        CAST(category AS VARCHAR) AS product_category,
        CAST(rating_rate AS FLOAT) AS product_rating_rate,
        CAST(rating_count AS INT) AS product_rating_count
FROM raw_products
  );

[0m13:34:51.784473 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:34:51.786361 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:34:51.786595 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m13:34:51.787151 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:34:51.788861 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:34:51.789096 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:34:51.789632 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:34:51.790498 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m13:34:51.790713 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:34:51.790889 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m13:34:51.794745 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:34:51.796543 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:34:51.796842 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m13:34:51.800012 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:34:51.801302 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: Close
[0m13:34:51.801831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d453d0d-41ec-4ec0-a8bf-898dc6dca09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783730237710>]}
[0m13:34:51.802265 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.03s]
[0m13:34:51.803446 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m13:34:51.803920 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m13:34:51.804689 [info ] [Thread-1 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m13:34:51.805096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m13:34:51.805354 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m13:34:51.808169 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m13:34:51.808592 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m13:34:51.858256 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_users"
[0m13:34:51.858840 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:34:51.859113 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: BEGIN
[0m13:34:51.859324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:51.860162 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:34:51.860422 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:34:51.860661 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    WITH raw_users AS(
    SELECT * FROM "dev"."main"."users"
)
SELECT CAST(id AS INT) AS user_id, 
        CAST(email AS VARCHAR) AS user_email,
        CAST(username AS VARCHAR) AS user_username,
        CAST(password AS VARCHAR) AS user_password,
        CAST(name_firstname AS VARCHAR) AS user_name_firstname,
        CAST(name_lastname AS VARCHAR) AS user_name_lastname,
        CAST(address_city AS VARCHAR) AS user_address_city,
        CAST(address_street AS VARCHAR) AS user_address_street,
        CAST(address_number AS INT) AS user_address_number,
        CAST(address_zipcode AS VARCHAR) AS user_address_zipcode,
        CAST(phone AS VARCHAR) AS user_phone
FROM raw_users
  );

[0m13:34:51.861485 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:34:51.863306 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:34:51.863525 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m13:34:51.864171 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:34:51.865725 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:34:51.865937 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:34:51.866503 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:34:51.867328 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m13:34:51.867524 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:34:51.867711 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m13:34:51.872158 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:34:51.873760 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:34:51.873992 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m13:34:51.877846 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:34:51.878686 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: Close
[0m13:34:51.879447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d453d0d-41ec-4ec0-a8bf-898dc6dca09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783733715520>]}
[0m13:34:51.879961 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.07s]
[0m13:34:51.880352 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m13:34:51.880675 [debug] [Thread-1 (]: Began running node model.store_pipeline.carts_dim
[0m13:34:51.881060 [info ] [Thread-1 (]: 4 of 7 START sql view model main.carts_dim ..................................... [RUN]
[0m13:34:51.881654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_users, now model.store_pipeline.carts_dim)
[0m13:34:51.881943 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.carts_dim
[0m13:34:51.883562 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.carts_dim"
[0m13:34:51.883992 [debug] [Thread-1 (]: Began executing node model.store_pipeline.carts_dim
[0m13:34:51.887304 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.carts_dim"
[0m13:34:51.887921 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:34:51.888174 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: BEGIN
[0m13:34:51.888357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:51.889024 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:34:51.889240 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:34:51.889441 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

  
  create view "dev"."main"."carts_dim__dbt_tmp" as (
    WITH carts_dim AS(
    SELECT * FROM "dev"."main"."stg_carts"
)
SELECT * FROM carts_dim
  );

[0m13:34:51.890464 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:34:51.892195 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:34:51.892418 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */
alter view "dev"."main"."carts_dim" rename to "carts_dim__dbt_backup"
[0m13:34:51.892937 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:34:51.894535 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:34:51.894756 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */
alter view "dev"."main"."carts_dim__dbt_tmp" rename to "carts_dim"
[0m13:34:51.895229 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:34:51.896181 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m13:34:51.896404 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:34:51.896580 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m13:34:51.899814 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:34:51.901789 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:34:51.902108 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

      drop view if exists "dev"."main"."carts_dim__dbt_backup" cascade
    
[0m13:34:51.906239 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:34:51.907379 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: Close
[0m13:34:51.907930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d453d0d-41ec-4ec0-a8bf-898dc6dca09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837301cbda0>]}
[0m13:34:51.908355 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.carts_dim ................................ [[32mOK[0m in 0.03s]
[0m13:34:51.908757 [debug] [Thread-1 (]: Finished running node model.store_pipeline.carts_dim
[0m13:34:51.909016 [debug] [Thread-1 (]: Began running node model.store_pipeline.products_dim
[0m13:34:51.909393 [info ] [Thread-1 (]: 5 of 7 START sql view model main.products_dim .................................. [RUN]
[0m13:34:51.909742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.carts_dim, now model.store_pipeline.products_dim)
[0m13:34:51.910032 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.products_dim
[0m13:34:51.912015 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.products_dim"
[0m13:34:51.912511 [debug] [Thread-1 (]: Began executing node model.store_pipeline.products_dim
[0m13:34:51.915995 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.products_dim"
[0m13:34:51.916786 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:34:51.917108 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: BEGIN
[0m13:34:51.917495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:51.918587 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:34:51.918881 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:34:51.919074 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

  
  create view "dev"."main"."products_dim__dbt_tmp" as (
    WITH products_dim AS(
    SELECT * FROM "dev"."main"."stg_products"
)
SELECT * FROM products_dim
  );

[0m13:34:51.919978 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:34:51.921807 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:34:51.922044 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */
alter view "dev"."main"."products_dim" rename to "products_dim__dbt_backup"
[0m13:34:51.922696 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:34:51.924908 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:34:51.925304 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */
alter view "dev"."main"."products_dim__dbt_tmp" rename to "products_dim"
[0m13:34:51.926042 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:34:51.926979 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m13:34:51.927208 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:34:51.927415 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m13:34:51.930199 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:34:51.932017 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:34:51.932264 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

      drop view if exists "dev"."main"."products_dim__dbt_backup" cascade
    
[0m13:34:51.935078 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:34:51.936032 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: Close
[0m13:34:51.936605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d453d0d-41ec-4ec0-a8bf-898dc6dca09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837302a1d30>]}
[0m13:34:51.937045 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.products_dim ............................. [[32mOK[0m in 0.03s]
[0m13:34:51.937408 [debug] [Thread-1 (]: Finished running node model.store_pipeline.products_dim
[0m13:34:51.937755 [debug] [Thread-1 (]: Began running node model.store_pipeline.users_dim
[0m13:34:51.938085 [info ] [Thread-1 (]: 6 of 7 START sql view model main.users_dim ..................................... [RUN]
[0m13:34:51.938504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.products_dim, now model.store_pipeline.users_dim)
[0m13:34:51.938752 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.users_dim
[0m13:34:51.940400 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.users_dim"
[0m13:34:51.940773 [debug] [Thread-1 (]: Began executing node model.store_pipeline.users_dim
[0m13:34:51.942572 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.users_dim"
[0m13:34:51.942953 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:34:51.943245 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: BEGIN
[0m13:34:51.943432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:51.944151 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:34:51.944359 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:34:51.944648 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

  
  create view "dev"."main"."users_dim__dbt_tmp" as (
    WITH users_dim AS (
    SELECT * FROM "dev"."main"."stg_users"
)
SELECT * FROM users_dim
  );

[0m13:34:51.945638 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:34:51.947888 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:34:51.948194 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */
alter view "dev"."main"."users_dim" rename to "users_dim__dbt_backup"
[0m13:34:51.948943 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:34:51.951043 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:34:51.951472 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */
alter view "dev"."main"."users_dim__dbt_tmp" rename to "users_dim"
[0m13:34:51.952291 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:34:51.953289 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m13:34:51.953535 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:34:51.953718 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m13:34:51.956918 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:34:51.958403 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:34:51.958625 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

      drop view if exists "dev"."main"."users_dim__dbt_backup" cascade
    
[0m13:34:51.961852 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:34:51.962807 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: Close
[0m13:34:51.963244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d453d0d-41ec-4ec0-a8bf-898dc6dca09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837301a9940>]}
[0m13:34:51.963698 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.users_dim ................................ [[32mOK[0m in 0.02s]
[0m13:34:51.964115 [debug] [Thread-1 (]: Finished running node model.store_pipeline.users_dim
[0m13:34:51.964820 [debug] [Thread-1 (]: Began running node model.store_pipeline.fact_sales
[0m13:34:51.965153 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fact_sales ................................... [RUN]
[0m13:34:51.965478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.users_dim, now model.store_pipeline.fact_sales)
[0m13:34:51.965706 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.fact_sales
[0m13:34:51.967825 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.fact_sales"
[0m13:34:51.968262 [debug] [Thread-1 (]: Began executing node model.store_pipeline.fact_sales
[0m13:34:51.982501 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.fact_sales"
[0m13:34:51.983091 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:34:51.983338 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: BEGIN
[0m13:34:51.983516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:51.984346 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:34:51.984626 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:34:51.984861 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

  
    
    

    create  table
      "dev"."main"."fact_sales__dbt_tmp"
  
    as (
      
WITH carts AS(
    SELECT * FROM "dev"."main"."carts_dim"
),
users AS(
    SELECT * FROM "dev"."main"."users_dim"
),
products AS(
    SELECT * FROM "dev"."main"."products_dim"
)
SELECT u.user_id, c.cart_id, p.product_id, p.product_price, p.product_rating_count,
         p.product_rating_count, c.cart_date, (c.quantity * p.product_price) AS total_amount,
FROM carts c 
JOIN users u ON c.user_id = u.user_id
JOIN products p ON c.product_id = p.product_id
    );
  
  
[0m13:34:51.998066 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

  
    
    

    create  table
      "dev"."main"."fact_sales__dbt_tmp"
  
    as (
      
WITH carts AS(
    SELECT * FROM "dev"."main"."carts_dim"
),
users AS(
    SELECT * FROM "dev"."main"."users_dim"
),
products AS(
    SELECT * FROM "dev"."main"."products_dim"
)
SELECT u.user_id, c.cart_id, p.product_id, p.product_price, p.product_rating_count,
         p.product_rating_count, c.cart_date, (c.quantity * p.product_price) AS total_amount,
FROM carts c 
JOIN users u ON c.user_id = u.user_id
JOIN products p ON c.product_id = p.product_id
    );
  
  
[0m13:34:51.998552 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:34:51.998996 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: ROLLBACK
[0m13:34:52.004619 [debug] [Thread-1 (]: Failed to rollback 'model.store_pipeline.fact_sales'
[0m13:34:52.004906 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: Close
[0m13:34:52.006595 [debug] [Thread-1 (]: Runtime Error in model fact_sales (models/schema/fact_sales.sql)
  Binder Error: Values list "c" does not have a column named "quantity"
  
  LINE 22:          p.product_rating_count, c.cart_date, (c.quantity * p.product_price) AS total_amount,
                                                          ^
[0m13:34:52.006930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d453d0d-41ec-4ec0-a8bf-898dc6dca09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783733439130>]}
[0m13:34:52.007340 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model main.fact_sales .......................... [[31mERROR[0m in 0.04s]
[0m13:34:52.007800 [debug] [Thread-1 (]: Finished running node model.store_pipeline.fact_sales
[0m13:34:52.008201 [debug] [Thread-4 (]: Marking all children of 'model.store_pipeline.fact_sales' to be skipped because of status 'error'.  Reason: Runtime Error in model fact_sales (models/schema/fact_sales.sql)
  Binder Error: Values list "c" does not have a column named "quantity"
  
  LINE 22:          p.product_rating_count, c.cart_date, (c.quantity * p.product_price) AS total_amount,
                                                          ^.
[0m13:34:52.009678 [debug] [MainThread]: Using duckdb connection "master"
[0m13:34:52.009889 [debug] [MainThread]: On master: BEGIN
[0m13:34:52.010063 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:34:52.010745 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:34:52.010959 [debug] [MainThread]: On master: COMMIT
[0m13:34:52.011128 [debug] [MainThread]: Using duckdb connection "master"
[0m13:34:52.011274 [debug] [MainThread]: On master: COMMIT
[0m13:34:52.011749 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:34:52.011963 [debug] [MainThread]: On master: Close
[0m13:34:52.012256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:52.012417 [debug] [MainThread]: Connection 'model.store_pipeline.fact_sales' was properly closed.
[0m13:34:52.012622 [info ] [MainThread]: 
[0m13:34:52.012857 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m13:34:52.013760 [debug] [MainThread]: Command end result
[0m13:34:52.027078 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:34:52.028597 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:34:52.033047 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m13:34:52.033328 [info ] [MainThread]: 
[0m13:34:52.033589 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:34:52.033822 [info ] [MainThread]: 
[0m13:34:52.034070 [error] [MainThread]: [31mFailure in model fact_sales (models/schema/fact_sales.sql)[0m
[0m13:34:52.034338 [error] [MainThread]:   Runtime Error in model fact_sales (models/schema/fact_sales.sql)
  Binder Error: Values list "c" does not have a column named "quantity"
  
  LINE 22:          p.product_rating_count, c.cart_date, (c.quantity * p.product_price) AS total_amount,
                                                          ^
[0m13:34:52.034532 [info ] [MainThread]: 
[0m13:34:52.034748 [info ] [MainThread]:   compiled code at target/compiled/store_pipeline/models/schema/fact_sales.sql
[0m13:34:52.034942 [info ] [MainThread]: 
[0m13:34:52.035135 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m13:34:52.036460 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1178792, "process_in_blocks": "86744", "process_kernel_time": 0.199917, "process_mem_max_rss": "154696", "process_out_blocks": "3104", "process_user_time": 1.876772}
[0m13:34:52.036797 [debug] [MainThread]: Command `dbt run` failed at 13:34:52.036711 after 1.12 seconds
[0m13:34:52.037052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78373d85fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78373d99af00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78373d7e8170>]}
[0m13:34:52.037291 [debug] [MainThread]: Flushing usage events
[0m13:34:53.181616 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:35:04.866134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a18cfa750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a189ba8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a184fd460>]}


============================== 13:35:04.868292 | 5dbc6101-50fe-4a62-b3b7-2387b0ab407f ==============================
[0m13:35:04.868292 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:35:04.869006 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'static_parser': 'True', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'partial_parse': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'target_path': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'warn_error': 'None', 'empty': 'False', 'introspect': 'True', 'profiles_dir': '/root/.dbt', 'use_experimental_parser': 'False', 'write_json': 'True', 'quiet': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:35:05.015297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dbc6101-50fe-4a62-b3b7-2387b0ab407f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a179ebf20>]}
[0m13:35:05.058008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dbc6101-50fe-4a62-b3b7-2387b0ab407f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a17b3f8c0>]}
[0m13:35:05.059127 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:35:05.097154 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:35:05.157909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:35:05.158528 [debug] [MainThread]: Partial parsing: updated file: store_pipeline://models/schema/fact_sales.sql
[0m13:35:05.324503 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m13:35:05.332982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dbc6101-50fe-4a62-b3b7-2387b0ab407f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a0dade2d0>]}
[0m13:35:05.373766 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:35:05.374921 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:35:05.383232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dbc6101-50fe-4a62-b3b7-2387b0ab407f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a0c1211f0>]}
[0m13:35:05.383548 [info ] [MainThread]: Found 7 models, 3 sources, 444 macros
[0m13:35:05.383869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dbc6101-50fe-4a62-b3b7-2387b0ab407f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a0db21b20>]}
[0m13:35:05.385290 [info ] [MainThread]: 
[0m13:35:05.385640 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:35:05.386103 [info ] [MainThread]: 
[0m13:35:05.386473 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:35:05.390460 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:35:05.413249 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:35:05.413577 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:35:05.413769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:05.424236 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m13:35:05.425666 [debug] [ThreadPool]: On list_dev: Close
[0m13:35:05.426403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:35:05.426693 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:35:05.430783 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:35:05.430993 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:35:05.431145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:05.432175 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:35:05.432991 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:35:05.433179 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:35:05.433637 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:05.433803 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:35:05.433950 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:35:05.434527 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:05.435025 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:35:05.435197 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:35:05.435396 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:35:05.435758 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:05.435940 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:35:05.437285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:35:05.440680 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:35:05.440945 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:35:05.441144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:05.441878 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:35:05.442208 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:35:05.442391 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:35:05.449298 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m13:35:05.450272 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:35:05.450957 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:35:05.451166 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:35:05.452589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dbc6101-50fe-4a62-b3b7-2387b0ab407f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a0dc2b890>]}
[0m13:35:05.452882 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:05.453044 [debug] [MainThread]: On master: BEGIN
[0m13:35:05.453299 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:35:05.453769 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:35:05.453975 [debug] [MainThread]: On master: COMMIT
[0m13:35:05.454243 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:05.454403 [debug] [MainThread]: On master: COMMIT
[0m13:35:05.454918 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:35:05.455146 [debug] [MainThread]: On master: Close
[0m13:35:05.457047 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m13:35:05.457365 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_carts ..................................... [RUN]
[0m13:35:05.457675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m13:35:05.457904 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m13:35:05.462225 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m13:35:05.462612 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m13:35:05.486615 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_carts"
[0m13:35:05.487152 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:35:05.487417 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: BEGIN
[0m13:35:05.487591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:05.488519 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:05.488749 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:35:05.488922 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(cart_date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m13:35:05.489634 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:05.493484 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:35:05.493755 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts" rename to "stg_carts__dbt_backup"
[0m13:35:05.494395 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:05.495963 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:35:05.496167 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts__dbt_tmp" rename to "stg_carts"
[0m13:35:05.496656 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:05.504151 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m13:35:05.504421 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:35:05.504618 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m13:35:05.508070 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:05.511630 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:35:05.511883 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

      drop view if exists "dev"."main"."stg_carts__dbt_backup" cascade
    
[0m13:35:05.514696 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:05.516302 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: Close
[0m13:35:05.517559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dbc6101-50fe-4a62-b3b7-2387b0ab407f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a1a393620>]}
[0m13:35:05.518065 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_carts ................................ [[32mOK[0m in 0.06s]
[0m13:35:05.518471 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m13:35:05.518781 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m13:35:05.519110 [info ] [Thread-1 (]: 2 of 7 START sql view model main.stg_products .................................. [RUN]
[0m13:35:05.519655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m13:35:05.519943 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m13:35:05.521615 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m13:35:05.521993 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m13:35:05.523840 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_products"
[0m13:35:05.524212 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:35:05.524419 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: BEGIN
[0m13:35:05.524650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:05.525222 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:05.525432 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:35:05.525618 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH raw_products AS(
    SELECT * FROM "dev"."main"."products"
)
SELECT CAST(id AS INT) AS product_id, 
        CAST(title AS VARCHAR) AS product_title,
        CAST(price AS FLOAT) AS product_price,
        CAST(description AS VARCHAR) AS product_description,
        CAST(category AS VARCHAR) AS product_category,
        CAST(rating_rate AS FLOAT) AS product_rating_rate,
        CAST(rating_count AS INT) AS product_rating_count
FROM raw_products
  );

[0m13:35:05.526356 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:05.528032 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:35:05.528239 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m13:35:05.528772 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:05.531520 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:35:05.531924 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:35:05.532761 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:05.533757 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m13:35:05.534011 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:35:05.534233 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m13:35:05.537445 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:05.539131 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:35:05.539404 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m13:35:05.542302 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:05.543193 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: Close
[0m13:35:05.546277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dbc6101-50fe-4a62-b3b7-2387b0ab407f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819ede0f890>]}
[0m13:35:05.546900 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.03s]
[0m13:35:05.547455 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m13:35:05.547990 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m13:35:05.548357 [info ] [Thread-1 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m13:35:05.548746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m13:35:05.549026 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m13:35:05.551877 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m13:35:05.552666 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m13:35:05.601555 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_users"
[0m13:35:05.602216 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:35:05.602512 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: BEGIN
[0m13:35:05.602729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:05.603456 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:05.603722 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:35:05.604023 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    WITH raw_users AS(
    SELECT * FROM "dev"."main"."users"
)
SELECT CAST(id AS INT) AS user_id, 
        CAST(email AS VARCHAR) AS user_email,
        CAST(username AS VARCHAR) AS user_username,
        CAST(password AS VARCHAR) AS user_password,
        CAST(name_firstname AS VARCHAR) AS user_name_firstname,
        CAST(name_lastname AS VARCHAR) AS user_name_lastname,
        CAST(address_city AS VARCHAR) AS user_address_city,
        CAST(address_street AS VARCHAR) AS user_address_street,
        CAST(address_number AS INT) AS user_address_number,
        CAST(address_zipcode AS VARCHAR) AS user_address_zipcode,
        CAST(phone AS VARCHAR) AS user_phone
FROM raw_users
  );

[0m13:35:05.604959 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:05.606753 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:35:05.606975 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m13:35:05.607666 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:05.609213 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:35:05.609429 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:35:05.609945 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:05.610804 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m13:35:05.611026 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:35:05.611226 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m13:35:05.615357 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:35:05.616875 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:35:05.617110 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m13:35:05.620594 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:05.621620 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: Close
[0m13:35:05.622512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dbc6101-50fe-4a62-b3b7-2387b0ab407f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a1a122a50>]}
[0m13:35:05.622968 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.07s]
[0m13:35:05.623341 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m13:35:05.623708 [debug] [Thread-1 (]: Began running node model.store_pipeline.carts_dim
[0m13:35:05.624096 [info ] [Thread-1 (]: 4 of 7 START sql view model main.carts_dim ..................................... [RUN]
[0m13:35:05.624679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_users, now model.store_pipeline.carts_dim)
[0m13:35:05.624911 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.carts_dim
[0m13:35:05.626547 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.carts_dim"
[0m13:35:05.626965 [debug] [Thread-1 (]: Began executing node model.store_pipeline.carts_dim
[0m13:35:05.628916 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.carts_dim"
[0m13:35:05.629296 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:35:05.629507 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: BEGIN
[0m13:35:05.629691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:05.630374 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:05.630593 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:35:05.630810 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

  
  create view "dev"."main"."carts_dim__dbt_tmp" as (
    WITH carts_dim AS(
    SELECT * FROM "dev"."main"."stg_carts"
)
SELECT * FROM carts_dim
  );

[0m13:35:05.631554 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:05.633284 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:35:05.633517 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */
alter view "dev"."main"."carts_dim" rename to "carts_dim__dbt_backup"
[0m13:35:05.634210 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:05.636858 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:35:05.637335 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */
alter view "dev"."main"."carts_dim__dbt_tmp" rename to "carts_dim"
[0m13:35:05.638624 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:05.639719 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m13:35:05.639967 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:35:05.640146 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m13:35:05.643413 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:05.645004 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:35:05.645298 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

      drop view if exists "dev"."main"."carts_dim__dbt_backup" cascade
    
[0m13:35:05.648119 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:05.649009 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: Close
[0m13:35:05.649420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dbc6101-50fe-4a62-b3b7-2387b0ab407f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a1bdbc0b0>]}
[0m13:35:05.649834 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.carts_dim ................................ [[32mOK[0m in 0.02s]
[0m13:35:05.650333 [debug] [Thread-1 (]: Finished running node model.store_pipeline.carts_dim
[0m13:35:05.650798 [debug] [Thread-1 (]: Began running node model.store_pipeline.products_dim
[0m13:35:05.651249 [info ] [Thread-1 (]: 5 of 7 START sql view model main.products_dim .................................. [RUN]
[0m13:35:05.652210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.carts_dim, now model.store_pipeline.products_dim)
[0m13:35:05.652547 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.products_dim
[0m13:35:05.654460 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.products_dim"
[0m13:35:05.654880 [debug] [Thread-1 (]: Began executing node model.store_pipeline.products_dim
[0m13:35:05.657718 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.products_dim"
[0m13:35:05.658282 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:35:05.658531 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: BEGIN
[0m13:35:05.658714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:05.659517 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:05.659755 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:35:05.659977 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

  
  create view "dev"."main"."products_dim__dbt_tmp" as (
    WITH products_dim AS(
    SELECT * FROM "dev"."main"."stg_products"
)
SELECT * FROM products_dim
  );

[0m13:35:05.660805 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:05.662505 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:35:05.662736 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */
alter view "dev"."main"."products_dim" rename to "products_dim__dbt_backup"
[0m13:35:05.663372 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:05.665100 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:35:05.665491 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */
alter view "dev"."main"."products_dim__dbt_tmp" rename to "products_dim"
[0m13:35:05.666493 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:05.667573 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m13:35:05.667833 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:35:05.668032 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m13:35:05.671129 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:05.672854 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:35:05.673142 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

      drop view if exists "dev"."main"."products_dim__dbt_backup" cascade
    
[0m13:35:05.676020 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:05.676898 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: Close
[0m13:35:05.677465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dbc6101-50fe-4a62-b3b7-2387b0ab407f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819edfadd90>]}
[0m13:35:05.677925 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.products_dim ............................. [[32mOK[0m in 0.03s]
[0m13:35:05.678329 [debug] [Thread-1 (]: Finished running node model.store_pipeline.products_dim
[0m13:35:05.678619 [debug] [Thread-1 (]: Began running node model.store_pipeline.users_dim
[0m13:35:05.678941 [info ] [Thread-1 (]: 6 of 7 START sql view model main.users_dim ..................................... [RUN]
[0m13:35:05.679418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.products_dim, now model.store_pipeline.users_dim)
[0m13:35:05.679669 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.users_dim
[0m13:35:05.681630 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.users_dim"
[0m13:35:05.682249 [debug] [Thread-1 (]: Began executing node model.store_pipeline.users_dim
[0m13:35:05.684310 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.users_dim"
[0m13:35:05.684797 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:35:05.685064 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: BEGIN
[0m13:35:05.685252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:05.686176 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:05.686427 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:35:05.686623 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

  
  create view "dev"."main"."users_dim__dbt_tmp" as (
    WITH users_dim AS (
    SELECT * FROM "dev"."main"."stg_users"
)
SELECT * FROM users_dim
  );

[0m13:35:05.687460 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:05.689251 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:35:05.689467 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */
alter view "dev"."main"."users_dim" rename to "users_dim__dbt_backup"
[0m13:35:05.690040 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:05.691779 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:35:05.692024 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */
alter view "dev"."main"."users_dim__dbt_tmp" rename to "users_dim"
[0m13:35:05.692539 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:05.693436 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m13:35:05.693651 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:35:05.693833 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m13:35:05.697020 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:05.698943 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:35:05.699252 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

      drop view if exists "dev"."main"."users_dim__dbt_backup" cascade
    
[0m13:35:05.702110 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:05.703100 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: Close
[0m13:35:05.703550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dbc6101-50fe-4a62-b3b7-2387b0ab407f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819edecb140>]}
[0m13:35:05.704025 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.users_dim ................................ [[32mOK[0m in 0.02s]
[0m13:35:05.704412 [debug] [Thread-1 (]: Finished running node model.store_pipeline.users_dim
[0m13:35:05.705142 [debug] [Thread-1 (]: Began running node model.store_pipeline.fact_sales
[0m13:35:05.705430 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fact_sales ................................... [RUN]
[0m13:35:05.705724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.users_dim, now model.store_pipeline.fact_sales)
[0m13:35:05.705953 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.fact_sales
[0m13:35:05.707966 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.fact_sales"
[0m13:35:05.708352 [debug] [Thread-1 (]: Began executing node model.store_pipeline.fact_sales
[0m13:35:05.721678 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.fact_sales"
[0m13:35:05.722345 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:35:05.722607 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: BEGIN
[0m13:35:05.722804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:05.723536 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:05.723763 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:35:05.723953 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

  
    
    

    create  table
      "dev"."main"."fact_sales__dbt_tmp"
  
    as (
      
WITH carts AS(
    SELECT * FROM "dev"."main"."carts_dim"
),
users AS(
    SELECT * FROM "dev"."main"."users_dim"
),
products AS(
    SELECT * FROM "dev"."main"."products_dim"
)
SELECT u.user_id, c.cart_id, p.product_id, p.product_price, p.product_rating_count,
         p.product_rating_count, c.cart_date, (c.quantity * p.product_price) AS total_amount
FROM carts c 
JOIN users u ON c.user_id = u.user_id
JOIN products p ON c.product_id = p.product_id
    );
  
  
[0m13:35:05.725892 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

  
    
    

    create  table
      "dev"."main"."fact_sales__dbt_tmp"
  
    as (
      
WITH carts AS(
    SELECT * FROM "dev"."main"."carts_dim"
),
users AS(
    SELECT * FROM "dev"."main"."users_dim"
),
products AS(
    SELECT * FROM "dev"."main"."products_dim"
)
SELECT u.user_id, c.cart_id, p.product_id, p.product_price, p.product_rating_count,
         p.product_rating_count, c.cart_date, (c.quantity * p.product_price) AS total_amount
FROM carts c 
JOIN users u ON c.user_id = u.user_id
JOIN products p ON c.product_id = p.product_id
    );
  
  
[0m13:35:05.726258 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:35:05.726551 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: ROLLBACK
[0m13:35:05.728641 [debug] [Thread-1 (]: Failed to rollback 'model.store_pipeline.fact_sales'
[0m13:35:05.728876 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: Close
[0m13:35:05.730562 [debug] [Thread-1 (]: Runtime Error in model fact_sales (models/schema/fact_sales.sql)
  Binder Error: Values list "c" does not have a column named "quantity"
  
  LINE 22:          p.product_rating_count, c.cart_date, (c.quantity * p.product_price) AS total_amount
                                                          ^
[0m13:35:05.730889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dbc6101-50fe-4a62-b3b7-2387b0ab407f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819ede0e540>]}
[0m13:35:05.731310 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model main.fact_sales .......................... [[31mERROR[0m in 0.03s]
[0m13:35:05.731681 [debug] [Thread-1 (]: Finished running node model.store_pipeline.fact_sales
[0m13:35:05.732051 [debug] [Thread-4 (]: Marking all children of 'model.store_pipeline.fact_sales' to be skipped because of status 'error'.  Reason: Runtime Error in model fact_sales (models/schema/fact_sales.sql)
  Binder Error: Values list "c" does not have a column named "quantity"
  
  LINE 22:          p.product_rating_count, c.cart_date, (c.quantity * p.product_price) AS total_amount
                                                          ^.
[0m13:35:05.733970 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:05.734327 [debug] [MainThread]: On master: BEGIN
[0m13:35:05.734583 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:35:05.735385 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:35:05.735640 [debug] [MainThread]: On master: COMMIT
[0m13:35:05.735815 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:05.735977 [debug] [MainThread]: On master: COMMIT
[0m13:35:05.736425 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:35:05.736646 [debug] [MainThread]: On master: Close
[0m13:35:05.736996 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:05.737172 [debug] [MainThread]: Connection 'model.store_pipeline.fact_sales' was properly closed.
[0m13:35:05.737409 [info ] [MainThread]: 
[0m13:35:05.737647 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m13:35:05.738736 [debug] [MainThread]: Command end result
[0m13:35:05.750689 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:35:05.751859 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:35:05.756090 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m13:35:05.756419 [info ] [MainThread]: 
[0m13:35:05.756714 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:35:05.756947 [info ] [MainThread]: 
[0m13:35:05.757221 [error] [MainThread]: [31mFailure in model fact_sales (models/schema/fact_sales.sql)[0m
[0m13:35:05.757491 [error] [MainThread]:   Runtime Error in model fact_sales (models/schema/fact_sales.sql)
  Binder Error: Values list "c" does not have a column named "quantity"
  
  LINE 22:          p.product_rating_count, c.cart_date, (c.quantity * p.product_price) AS total_amount
                                                          ^
[0m13:35:05.757686 [info ] [MainThread]: 
[0m13:35:05.757920 [info ] [MainThread]:   compiled code at target/compiled/store_pipeline/models/schema/fact_sales.sql
[0m13:35:05.758162 [info ] [MainThread]: 
[0m13:35:05.758398 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m13:35:05.759184 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.92891616, "process_in_blocks": "0", "process_kernel_time": 0.174237, "process_mem_max_rss": "154708", "process_out_blocks": "3096", "process_user_time": 1.746428}
[0m13:35:05.759582 [debug] [MainThread]: Command `dbt run` failed at 13:35:05.759512 after 0.93 seconds
[0m13:35:05.759823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a19fc3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781a0da16bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7819ec095a90>]}
[0m13:35:05.760056 [debug] [MainThread]: Flushing usage events
[0m13:35:06.772494 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:35:11.382773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acc22752e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acc212ff830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acc21380b30>]}


============================== 13:35:11.385169 | ac0f4b1f-062b-41e2-83b5-aaaa3cdbb1c5 ==============================
[0m13:35:11.385169 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:35:11.385550 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'static_parser': 'True', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'printer_width': '80', 'log_format': 'default', 'profiles_dir': '/root/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'write_json': 'True', 'fail_fast': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'quiet': 'False', 'partial_parse': 'True'}
[0m13:35:11.526074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac0f4b1f-062b-41e2-83b5-aaaa3cdbb1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acc208a3bf0>]}
[0m13:35:11.566562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac0f4b1f-062b-41e2-83b5-aaaa3cdbb1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acc20f22c00>]}
[0m13:35:11.567532 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:35:11.604543 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:35:11.658936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:35:11.659179 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:35:11.663063 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m13:35:11.682325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac0f4b1f-062b-41e2-83b5-aaaa3cdbb1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acc16d452b0>]}
[0m13:35:11.719600 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:35:11.720567 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:35:11.728645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac0f4b1f-062b-41e2-83b5-aaaa3cdbb1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acc16a3c5c0>]}
[0m13:35:11.729112 [info ] [MainThread]: Found 7 models, 3 sources, 444 macros
[0m13:35:11.729430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac0f4b1f-062b-41e2-83b5-aaaa3cdbb1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acc21382120>]}
[0m13:35:11.730878 [info ] [MainThread]: 
[0m13:35:11.731216 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:35:11.731435 [info ] [MainThread]: 
[0m13:35:11.731946 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:35:11.735334 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:35:11.759552 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:35:11.759845 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:35:11.760014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:11.775845 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m13:35:11.776766 [debug] [ThreadPool]: On list_dev: Close
[0m13:35:11.777515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:35:11.777813 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:35:11.782589 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:35:11.782891 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:35:11.783100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:11.784266 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:35:11.785425 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:35:11.785635 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:35:11.786512 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:35:11.786869 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:35:11.787148 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:35:11.788133 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:35:11.788684 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:35:11.788872 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:35:11.789011 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:35:11.789411 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:35:11.789598 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:35:11.790751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:35:11.795097 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:35:11.795320 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:35:11.795474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:11.796065 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:35:11.796248 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:35:11.796389 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:35:11.803178 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m13:35:11.804050 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:35:11.804689 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:35:11.804875 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:35:11.806345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac0f4b1f-062b-41e2-83b5-aaaa3cdbb1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acc208ef9e0>]}
[0m13:35:11.806647 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:11.806808 [debug] [MainThread]: On master: BEGIN
[0m13:35:11.806935 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:35:11.807389 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:35:11.807547 [debug] [MainThread]: On master: COMMIT
[0m13:35:11.807679 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:11.807846 [debug] [MainThread]: On master: COMMIT
[0m13:35:11.808210 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:35:11.808371 [debug] [MainThread]: On master: Close
[0m13:35:11.810414 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m13:35:11.810734 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_carts ..................................... [RUN]
[0m13:35:11.811020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m13:35:11.811232 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m13:35:11.815741 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m13:35:11.816836 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m13:35:11.835621 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_carts"
[0m13:35:11.836126 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:35:11.836367 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: BEGIN
[0m13:35:11.836539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:11.837284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:11.837533 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:35:11.837731 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(cart_date AS TIMESTAMP) AS cart_date
FROM raw_carts
  );

[0m13:35:11.838592 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:11.842875 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:35:11.843215 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts" rename to "stg_carts__dbt_backup"
[0m13:35:11.844082 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:11.845888 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:35:11.846192 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts__dbt_tmp" rename to "stg_carts"
[0m13:35:11.846786 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:11.854304 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m13:35:11.854595 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:35:11.854771 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m13:35:11.858385 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:11.861771 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:35:11.862056 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

      drop view if exists "dev"."main"."stg_carts__dbt_backup" cascade
    
[0m13:35:11.864960 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:11.866492 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: Close
[0m13:35:11.867622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac0f4b1f-062b-41e2-83b5-aaaa3cdbb1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acc15d1c170>]}
[0m13:35:11.868021 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_carts ................................ [[32mOK[0m in 0.06s]
[0m13:35:11.868394 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m13:35:11.868666 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m13:35:11.868936 [info ] [Thread-1 (]: 2 of 7 START sql view model main.stg_products .................................. [RUN]
[0m13:35:11.869387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m13:35:11.869733 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m13:35:11.871502 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m13:35:11.871969 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m13:35:11.873769 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_products"
[0m13:35:11.874139 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:35:11.874339 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: BEGIN
[0m13:35:11.874504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:11.875178 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:11.875362 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:35:11.875523 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH raw_products AS(
    SELECT * FROM "dev"."main"."products"
)
SELECT CAST(id AS INT) AS product_id, 
        CAST(title AS VARCHAR) AS product_title,
        CAST(price AS FLOAT) AS product_price,
        CAST(description AS VARCHAR) AS product_description,
        CAST(category AS VARCHAR) AS product_category,
        CAST(rating_rate AS FLOAT) AS product_rating_rate,
        CAST(rating_count AS INT) AS product_rating_count
FROM raw_products
  );

[0m13:35:11.876161 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:11.878593 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:35:11.878834 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m13:35:11.879349 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:11.880742 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:35:11.880940 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:35:11.881398 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:11.882353 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m13:35:11.882558 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:35:11.882719 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m13:35:11.886940 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:35:11.888701 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:35:11.888983 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m13:35:11.891835 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:11.892721 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: Close
[0m13:35:11.893258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac0f4b1f-062b-41e2-83b5-aaaa3cdbb1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acc15e23bf0>]}
[0m13:35:11.893703 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.02s]
[0m13:35:11.894135 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m13:35:11.894417 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m13:35:11.894759 [info ] [Thread-1 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m13:35:11.895329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m13:35:11.895599 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m13:35:11.897531 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m13:35:11.898092 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m13:35:11.900648 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_users"
[0m13:35:11.901192 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:35:11.901438 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: BEGIN
[0m13:35:11.901632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:11.902289 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:11.902487 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:35:11.902656 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    WITH raw_users AS(
    SELECT * FROM "dev"."main"."users"
)
SELECT CAST(id AS INT) AS user_id, 
        CAST(email AS VARCHAR) AS user_email,
        CAST(username AS VARCHAR) AS user_username,
        CAST(password AS VARCHAR) AS user_password,
        CAST(name_firstname AS VARCHAR) AS user_name_firstname,
        CAST(name_lastname AS VARCHAR) AS user_name_lastname,
        CAST(address_city AS VARCHAR) AS user_address_city,
        CAST(address_street AS VARCHAR) AS user_address_street,
        CAST(address_number AS INT) AS user_address_number,
        CAST(address_zipcode AS VARCHAR) AS user_address_zipcode,
        CAST(phone AS VARCHAR) AS user_phone
FROM raw_users
  );

[0m13:35:11.904052 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:11.905949 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:35:11.906269 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m13:35:11.906817 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:11.908330 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:35:11.908529 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:35:11.908979 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:11.909839 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m13:35:11.910058 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:35:11.910226 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m13:35:11.913093 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:11.914702 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:35:11.914952 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m13:35:11.917608 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:35:11.918520 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: Close
[0m13:35:11.918979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac0f4b1f-062b-41e2-83b5-aaaa3cdbb1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acc16d81d30>]}
[0m13:35:11.919396 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.02s]
[0m13:35:11.919728 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m13:35:11.919947 [debug] [Thread-1 (]: Began running node model.store_pipeline.carts_dim
[0m13:35:11.920237 [info ] [Thread-1 (]: 4 of 7 START sql view model main.carts_dim ..................................... [RUN]
[0m13:35:11.920703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_users, now model.store_pipeline.carts_dim)
[0m13:35:11.920958 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.carts_dim
[0m13:35:11.922590 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.carts_dim"
[0m13:35:11.923097 [debug] [Thread-1 (]: Began executing node model.store_pipeline.carts_dim
[0m13:35:11.925018 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.carts_dim"
[0m13:35:11.925431 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:35:11.925693 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: BEGIN
[0m13:35:11.925899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:11.926801 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:11.927053 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:35:11.927234 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

  
  create view "dev"."main"."carts_dim__dbt_tmp" as (
    WITH carts_dim AS(
    SELECT * FROM "dev"."main"."stg_carts"
)
SELECT * FROM carts_dim
  );

[0m13:35:11.928076 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:11.929924 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:35:11.930218 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */
alter view "dev"."main"."carts_dim" rename to "carts_dim__dbt_backup"
[0m13:35:11.931002 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:11.932758 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:35:11.933957 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */
alter view "dev"."main"."carts_dim__dbt_tmp" rename to "carts_dim"
[0m13:35:11.934668 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:11.935496 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m13:35:11.935694 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:35:11.935853 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m13:35:11.943252 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:35:11.944687 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:35:11.944901 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

      drop view if exists "dev"."main"."carts_dim__dbt_backup" cascade
    
[0m13:35:11.947831 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:11.948649 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: Close
[0m13:35:11.949037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac0f4b1f-062b-41e2-83b5-aaaa3cdbb1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acc15d91790>]}
[0m13:35:11.949430 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.carts_dim ................................ [[32mOK[0m in 0.03s]
[0m13:35:11.949776 [debug] [Thread-1 (]: Finished running node model.store_pipeline.carts_dim
[0m13:35:11.950043 [debug] [Thread-1 (]: Began running node model.store_pipeline.products_dim
[0m13:35:11.950424 [info ] [Thread-1 (]: 5 of 7 START sql view model main.products_dim .................................. [RUN]
[0m13:35:11.950726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.carts_dim, now model.store_pipeline.products_dim)
[0m13:35:11.950941 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.products_dim
[0m13:35:11.952644 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.products_dim"
[0m13:35:11.953097 [debug] [Thread-1 (]: Began executing node model.store_pipeline.products_dim
[0m13:35:11.954957 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.products_dim"
[0m13:35:11.955363 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:35:11.955598 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: BEGIN
[0m13:35:11.955762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:11.957135 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:11.957422 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:35:11.957607 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

  
  create view "dev"."main"."products_dim__dbt_tmp" as (
    WITH products_dim AS(
    SELECT * FROM "dev"."main"."stg_products"
)
SELECT * FROM products_dim
  );

[0m13:35:11.958783 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:11.960726 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:35:11.960951 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */
alter view "dev"."main"."products_dim" rename to "products_dim__dbt_backup"
[0m13:35:11.961887 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:11.963516 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:35:11.963767 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */
alter view "dev"."main"."products_dim__dbt_tmp" rename to "products_dim"
[0m13:35:11.964274 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:11.965056 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m13:35:11.965256 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:35:11.965430 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m13:35:11.968466 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:11.969895 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:35:11.970166 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

      drop view if exists "dev"."main"."products_dim__dbt_backup" cascade
    
[0m13:35:11.972964 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:11.973898 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: Close
[0m13:35:11.974441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac0f4b1f-062b-41e2-83b5-aaaa3cdbb1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acc15e33ef0>]}
[0m13:35:11.974889 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.products_dim ............................. [[32mOK[0m in 0.02s]
[0m13:35:11.975273 [debug] [Thread-1 (]: Finished running node model.store_pipeline.products_dim
[0m13:35:11.975538 [debug] [Thread-1 (]: Began running node model.store_pipeline.users_dim
[0m13:35:11.975854 [info ] [Thread-1 (]: 6 of 7 START sql view model main.users_dim ..................................... [RUN]
[0m13:35:11.976320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.products_dim, now model.store_pipeline.users_dim)
[0m13:35:11.976566 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.users_dim
[0m13:35:11.978387 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.users_dim"
[0m13:35:11.978818 [debug] [Thread-1 (]: Began executing node model.store_pipeline.users_dim
[0m13:35:11.980818 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.users_dim"
[0m13:35:11.981475 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:35:11.982487 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: BEGIN
[0m13:35:11.982733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:11.983443 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:11.983645 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:35:11.983806 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

  
  create view "dev"."main"."users_dim__dbt_tmp" as (
    WITH users_dim AS (
    SELECT * FROM "dev"."main"."stg_users"
)
SELECT * FROM users_dim
  );

[0m13:35:11.984671 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:11.986502 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:35:11.986829 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */
alter view "dev"."main"."users_dim" rename to "users_dim__dbt_backup"
[0m13:35:11.987505 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:35:11.989419 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:35:11.989770 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */
alter view "dev"."main"."users_dim__dbt_tmp" rename to "users_dim"
[0m13:35:11.990526 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:11.991401 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m13:35:11.991594 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:35:11.991746 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m13:35:11.994803 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:11.997300 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:35:11.997559 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

      drop view if exists "dev"."main"."users_dim__dbt_backup" cascade
    
[0m13:35:12.000503 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:35:12.001365 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: Close
[0m13:35:12.001859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac0f4b1f-062b-41e2-83b5-aaaa3cdbb1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acc15dc8860>]}
[0m13:35:12.002299 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.users_dim ................................ [[32mOK[0m in 0.03s]
[0m13:35:12.002635 [debug] [Thread-1 (]: Finished running node model.store_pipeline.users_dim
[0m13:35:12.003313 [debug] [Thread-1 (]: Began running node model.store_pipeline.fact_sales
[0m13:35:12.003672 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fact_sales ................................... [RUN]
[0m13:35:12.004579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.users_dim, now model.store_pipeline.fact_sales)
[0m13:35:12.004976 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.fact_sales
[0m13:35:12.048700 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.fact_sales"
[0m13:35:12.049437 [debug] [Thread-1 (]: Began executing node model.store_pipeline.fact_sales
[0m13:35:12.061594 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.fact_sales"
[0m13:35:12.062285 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:35:12.062547 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: BEGIN
[0m13:35:12.062708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:12.063398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:35:12.063604 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:35:12.063796 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

  
    
    

    create  table
      "dev"."main"."fact_sales__dbt_tmp"
  
    as (
      
WITH carts AS(
    SELECT * FROM "dev"."main"."carts_dim"
),
users AS(
    SELECT * FROM "dev"."main"."users_dim"
),
products AS(
    SELECT * FROM "dev"."main"."products_dim"
)
SELECT u.user_id, c.cart_id, p.product_id, p.product_price, p.product_rating_count,
         p.product_rating_count, c.cart_date, (c.quantity * p.product_price) AS total_amount
FROM carts c 
JOIN users u ON c.user_id = u.user_id
JOIN products p ON c.product_id = p.product_id
    );
  
  
[0m13:35:12.065560 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

  
    
    

    create  table
      "dev"."main"."fact_sales__dbt_tmp"
  
    as (
      
WITH carts AS(
    SELECT * FROM "dev"."main"."carts_dim"
),
users AS(
    SELECT * FROM "dev"."main"."users_dim"
),
products AS(
    SELECT * FROM "dev"."main"."products_dim"
)
SELECT u.user_id, c.cart_id, p.product_id, p.product_price, p.product_rating_count,
         p.product_rating_count, c.cart_date, (c.quantity * p.product_price) AS total_amount
FROM carts c 
JOIN users u ON c.user_id = u.user_id
JOIN products p ON c.product_id = p.product_id
    );
  
  
[0m13:35:12.065804 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:35:12.066102 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: ROLLBACK
[0m13:35:12.068098 [debug] [Thread-1 (]: Failed to rollback 'model.store_pipeline.fact_sales'
[0m13:35:12.068433 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: Close
[0m13:35:12.069863 [debug] [Thread-1 (]: Runtime Error in model fact_sales (models/schema/fact_sales.sql)
  Binder Error: Values list "c" does not have a column named "quantity"
  
  LINE 22:          p.product_rating_count, c.cart_date, (c.quantity * p.product_price) AS total_amount
                                                          ^
[0m13:35:12.070208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac0f4b1f-062b-41e2-83b5-aaaa3cdbb1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acc15e50f50>]}
[0m13:35:12.070551 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model main.fact_sales .......................... [[31mERROR[0m in 0.07s]
[0m13:35:12.070959 [debug] [Thread-1 (]: Finished running node model.store_pipeline.fact_sales
[0m13:35:12.071393 [debug] [Thread-4 (]: Marking all children of 'model.store_pipeline.fact_sales' to be skipped because of status 'error'.  Reason: Runtime Error in model fact_sales (models/schema/fact_sales.sql)
  Binder Error: Values list "c" does not have a column named "quantity"
  
  LINE 22:          p.product_rating_count, c.cart_date, (c.quantity * p.product_price) AS total_amount
                                                          ^.
[0m13:35:12.073055 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:12.073237 [debug] [MainThread]: On master: BEGIN
[0m13:35:12.073368 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:35:12.073932 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:35:12.074187 [debug] [MainThread]: On master: COMMIT
[0m13:35:12.074359 [debug] [MainThread]: Using duckdb connection "master"
[0m13:35:12.074494 [debug] [MainThread]: On master: COMMIT
[0m13:35:12.074931 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:35:12.075127 [debug] [MainThread]: On master: Close
[0m13:35:12.075432 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:12.075596 [debug] [MainThread]: Connection 'model.store_pipeline.fact_sales' was properly closed.
[0m13:35:12.075787 [info ] [MainThread]: 
[0m13:35:12.075990 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m13:35:12.076801 [debug] [MainThread]: Command end result
[0m13:35:12.087179 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:35:12.088416 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:35:12.092269 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m13:35:12.092518 [info ] [MainThread]: 
[0m13:35:12.092779 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:35:12.093044 [info ] [MainThread]: 
[0m13:35:12.093334 [error] [MainThread]: [31mFailure in model fact_sales (models/schema/fact_sales.sql)[0m
[0m13:35:12.093595 [error] [MainThread]:   Runtime Error in model fact_sales (models/schema/fact_sales.sql)
  Binder Error: Values list "c" does not have a column named "quantity"
  
  LINE 22:          p.product_rating_count, c.cart_date, (c.quantity * p.product_price) AS total_amount
                                                          ^
[0m13:35:12.093815 [info ] [MainThread]: 
[0m13:35:12.094062 [info ] [MainThread]:   compiled code at target/compiled/store_pipeline/models/schema/fact_sales.sql
[0m13:35:12.094251 [info ] [MainThread]: 
[0m13:35:12.094445 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m13:35:12.095022 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7532026, "process_in_blocks": "8", "process_kernel_time": 0.142021, "process_mem_max_rss": "151844", "process_out_blocks": "2192", "process_user_time": 1.646556}
[0m13:35:12.095315 [debug] [MainThread]: Command `dbt run` failed at 13:35:12.095236 after 0.75 seconds
[0m13:35:12.095537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acc2167bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acc2351c2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7acc209ee6c0>]}
[0m13:35:12.095733 [debug] [MainThread]: Flushing usage events
[0m13:35:12.873603 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:01.349991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748efd429dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748efc63b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748efc63b1a0>]}


============================== 13:39:01.353524 | 486e8304-f5a4-4185-bf61-7e96cc601139 ==============================
[0m13:39:01.353524 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:39:01.353910 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error': 'None', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'printer_width': '80', 'empty': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'no_print': 'None', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'quiet': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'debug': 'False', 'use_colors': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'target_path': 'None', 'version_check': 'True', 'log_cache_events': 'False'}
[0m13:39:01.555258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '486e8304-f5a4-4185-bf61-7e96cc601139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748efef20200>]}
[0m13:39:01.607457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '486e8304-f5a4-4185-bf61-7e96cc601139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748efc6a59a0>]}
[0m13:39:01.610168 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:39:01.657712 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:39:01.771088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:39:01.771537 [debug] [MainThread]: Partial parsing: updated file: store_pipeline://models/stg/stg_carts.sql
[0m13:39:01.977835 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m13:39:01.989528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '486e8304-f5a4-4185-bf61-7e96cc601139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748ef25ee720>]}
[0m13:39:02.035309 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:39:02.037430 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:39:02.062139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '486e8304-f5a4-4185-bf61-7e96cc601139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748ef25d9610>]}
[0m13:39:02.062515 [info ] [MainThread]: Found 7 models, 3 sources, 444 macros
[0m13:39:02.062778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '486e8304-f5a4-4185-bf61-7e96cc601139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748ef2620320>]}
[0m13:39:02.063982 [info ] [MainThread]: 
[0m13:39:02.064248 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:39:02.064618 [info ] [MainThread]: 
[0m13:39:02.065550 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:39:02.069240 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:39:02.099141 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:39:02.099567 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:39:02.099791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:02.115434 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m13:39:02.116385 [debug] [ThreadPool]: On list_dev: Close
[0m13:39:02.117092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:39:02.117419 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:39:02.122856 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:39:02.123145 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:39:02.123346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:02.124464 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:39:02.125657 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:39:02.125967 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:39:02.126566 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:39:02.126802 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:39:02.126949 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:39:02.127395 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:39:02.127964 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:39:02.128150 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:39:02.128301 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:39:02.128671 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:39:02.128871 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:39:02.130118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:39:02.134261 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:39:02.134665 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:39:02.134881 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:02.135542 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:39:02.135741 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:39:02.135893 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:39:02.148241 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m13:39:02.149456 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:39:02.151310 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:39:02.151803 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:39:02.153788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '486e8304-f5a4-4185-bf61-7e96cc601139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748ef2b23a10>]}
[0m13:39:02.154135 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:02.154332 [debug] [MainThread]: On master: BEGIN
[0m13:39:02.154568 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:39:02.155132 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:39:02.155317 [debug] [MainThread]: On master: COMMIT
[0m13:39:02.155513 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:02.155670 [debug] [MainThread]: On master: COMMIT
[0m13:39:02.156066 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:39:02.156249 [debug] [MainThread]: On master: Close
[0m13:39:02.160573 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m13:39:02.161000 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_carts ..................................... [RUN]
[0m13:39:02.161381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m13:39:02.161614 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m13:39:02.167326 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m13:39:02.167830 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m13:39:02.193289 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_carts"
[0m13:39:02.194362 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:39:02.194929 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: BEGIN
[0m13:39:02.195339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:02.196501 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.196989 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:39:02.197391 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(cart_date AS TIMESTAMP) AS cart_date,
        CAST(quantity AS INT) AS quantity
FROM raw_carts
  );

[0m13:39:02.198813 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.203990 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:39:02.205084 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts" rename to "stg_carts__dbt_backup"
[0m13:39:02.206526 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.208563 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:39:02.208804 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts__dbt_tmp" rename to "stg_carts"
[0m13:39:02.209466 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:39:02.218703 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m13:39:02.219071 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:39:02.219276 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m13:39:02.223212 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:39:02.227291 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:39:02.227607 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

      drop view if exists "dev"."main"."stg_carts__dbt_backup" cascade
    
[0m13:39:02.231014 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:39:02.233158 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: Close
[0m13:39:02.235065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '486e8304-f5a4-4185-bf61-7e96cc601139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748ef2b490a0>]}
[0m13:39:02.235519 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_carts ................................ [[32mOK[0m in 0.07s]
[0m13:39:02.235902 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m13:39:02.236159 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m13:39:02.236452 [info ] [Thread-1 (]: 2 of 7 START sql view model main.stg_products .................................. [RUN]
[0m13:39:02.237101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m13:39:02.237518 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m13:39:02.240430 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m13:39:02.240889 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m13:39:02.242925 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_products"
[0m13:39:02.243319 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:39:02.243613 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: BEGIN
[0m13:39:02.243858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:02.245188 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.245550 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:39:02.245773 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH raw_products AS(
    SELECT * FROM "dev"."main"."products"
)
SELECT CAST(id AS INT) AS product_id, 
        CAST(title AS VARCHAR) AS product_title,
        CAST(price AS FLOAT) AS product_price,
        CAST(description AS VARCHAR) AS product_description,
        CAST(category AS VARCHAR) AS product_category,
        CAST(rating_rate AS FLOAT) AS product_rating_rate,
        CAST(rating_count AS INT) AS product_rating_count
FROM raw_products
  );

[0m13:39:02.246704 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.248670 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:39:02.248905 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m13:39:02.249423 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:39:02.251823 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:39:02.252179 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:39:02.253021 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.254169 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m13:39:02.254481 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:39:02.254726 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m13:39:02.258611 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:39:02.260478 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:39:02.260749 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m13:39:02.265835 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:39:02.267008 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: Close
[0m13:39:02.267516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '486e8304-f5a4-4185-bf61-7e96cc601139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748eda8934d0>]}
[0m13:39:02.267944 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.03s]
[0m13:39:02.268311 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m13:39:02.268555 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m13:39:02.268858 [info ] [Thread-1 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m13:39:02.269384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m13:39:02.269662 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m13:39:02.273932 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m13:39:02.274722 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m13:39:02.327077 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_users"
[0m13:39:02.327621 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:39:02.327856 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: BEGIN
[0m13:39:02.328048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:02.328690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.328907 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:39:02.329124 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    WITH raw_users AS(
    SELECT * FROM "dev"."main"."users"
)
SELECT CAST(id AS INT) AS user_id, 
        CAST(email AS VARCHAR) AS user_email,
        CAST(username AS VARCHAR) AS user_username,
        CAST(password AS VARCHAR) AS user_password,
        CAST(name_firstname AS VARCHAR) AS user_name_firstname,
        CAST(name_lastname AS VARCHAR) AS user_name_lastname,
        CAST(address_city AS VARCHAR) AS user_address_city,
        CAST(address_street AS VARCHAR) AS user_address_street,
        CAST(address_number AS INT) AS user_address_number,
        CAST(address_zipcode AS VARCHAR) AS user_address_zipcode,
        CAST(phone AS VARCHAR) AS user_phone
FROM raw_users
  );

[0m13:39:02.330206 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.332430 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:39:02.332691 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m13:39:02.333596 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.335289 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:39:02.335511 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:39:02.336069 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:39:02.337209 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m13:39:02.337507 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:39:02.337749 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m13:39:02.342570 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:39:02.345334 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:39:02.345699 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m13:39:02.348763 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:39:02.349810 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: Close
[0m13:39:02.350893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '486e8304-f5a4-4185-bf61-7e96cc601139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748efef20200>]}
[0m13:39:02.351358 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.08s]
[0m13:39:02.351739 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m13:39:02.351991 [debug] [Thread-1 (]: Began running node model.store_pipeline.carts_dim
[0m13:39:02.352413 [info ] [Thread-1 (]: 4 of 7 START sql view model main.carts_dim ..................................... [RUN]
[0m13:39:02.352994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_users, now model.store_pipeline.carts_dim)
[0m13:39:02.353205 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.carts_dim
[0m13:39:02.354790 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.carts_dim"
[0m13:39:02.355151 [debug] [Thread-1 (]: Began executing node model.store_pipeline.carts_dim
[0m13:39:02.357392 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.carts_dim"
[0m13:39:02.357898 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:39:02.358349 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: BEGIN
[0m13:39:02.358655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:02.359576 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.359812 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:39:02.359999 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

  
  create view "dev"."main"."carts_dim__dbt_tmp" as (
    WITH carts_dim AS(
    SELECT * FROM "dev"."main"."stg_carts"
)
SELECT * FROM carts_dim
  );

[0m13:39:02.360746 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.362568 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:39:02.362798 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */
alter view "dev"."main"."carts_dim" rename to "carts_dim__dbt_backup"
[0m13:39:02.363760 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.365667 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:39:02.365920 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */
alter view "dev"."main"."carts_dim__dbt_tmp" rename to "carts_dim"
[0m13:39:02.366776 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.367748 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m13:39:02.367988 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:39:02.368174 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m13:39:02.372470 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:39:02.374201 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:39:02.374514 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

      drop view if exists "dev"."main"."carts_dim__dbt_backup" cascade
    
[0m13:39:02.377655 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:39:02.378846 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: Close
[0m13:39:02.379410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '486e8304-f5a4-4185-bf61-7e96cc601139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748ef26b33b0>]}
[0m13:39:02.379808 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.carts_dim ................................ [[32mOK[0m in 0.03s]
[0m13:39:02.380175 [debug] [Thread-1 (]: Finished running node model.store_pipeline.carts_dim
[0m13:39:02.380430 [debug] [Thread-1 (]: Began running node model.store_pipeline.products_dim
[0m13:39:02.380811 [info ] [Thread-1 (]: 5 of 7 START sql view model main.products_dim .................................. [RUN]
[0m13:39:02.381140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.carts_dim, now model.store_pipeline.products_dim)
[0m13:39:02.381365 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.products_dim
[0m13:39:02.383094 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.products_dim"
[0m13:39:02.383587 [debug] [Thread-1 (]: Began executing node model.store_pipeline.products_dim
[0m13:39:02.386648 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.products_dim"
[0m13:39:02.387056 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:39:02.387275 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: BEGIN
[0m13:39:02.387454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:02.388075 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.388438 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:39:02.388659 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

  
  create view "dev"."main"."products_dim__dbt_tmp" as (
    WITH products_dim AS(
    SELECT * FROM "dev"."main"."stg_products"
)
SELECT * FROM products_dim
  );

[0m13:39:02.389733 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.391882 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:39:02.392141 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */
alter view "dev"."main"."products_dim" rename to "products_dim__dbt_backup"
[0m13:39:02.392993 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:39:02.394576 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:39:02.394863 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */
alter view "dev"."main"."products_dim__dbt_tmp" rename to "products_dim"
[0m13:39:02.395383 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:39:02.396274 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m13:39:02.396544 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:39:02.396770 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m13:39:02.401471 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:39:02.403152 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:39:02.403496 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

      drop view if exists "dev"."main"."products_dim__dbt_backup" cascade
    
[0m13:39:02.406893 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:39:02.407877 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: Close
[0m13:39:02.408336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '486e8304-f5a4-4185-bf61-7e96cc601139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748eda976780>]}
[0m13:39:02.408751 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.products_dim ............................. [[32mOK[0m in 0.03s]
[0m13:39:02.409107 [debug] [Thread-1 (]: Finished running node model.store_pipeline.products_dim
[0m13:39:02.409370 [debug] [Thread-1 (]: Began running node model.store_pipeline.users_dim
[0m13:39:02.409720 [info ] [Thread-1 (]: 6 of 7 START sql view model main.users_dim ..................................... [RUN]
[0m13:39:02.410281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.products_dim, now model.store_pipeline.users_dim)
[0m13:39:02.410599 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.users_dim
[0m13:39:02.412478 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.users_dim"
[0m13:39:02.412918 [debug] [Thread-1 (]: Began executing node model.store_pipeline.users_dim
[0m13:39:02.414801 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.users_dim"
[0m13:39:02.415180 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:39:02.415389 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: BEGIN
[0m13:39:02.415560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:02.416793 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.417115 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:39:02.417337 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

  
  create view "dev"."main"."users_dim__dbt_tmp" as (
    WITH users_dim AS (
    SELECT * FROM "dev"."main"."stg_users"
)
SELECT * FROM users_dim
  );

[0m13:39:02.418315 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.420458 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:39:02.420696 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */
alter view "dev"."main"."users_dim" rename to "users_dim__dbt_backup"
[0m13:39:02.421264 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:39:02.423146 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:39:02.423484 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */
alter view "dev"."main"."users_dim__dbt_tmp" rename to "users_dim"
[0m13:39:02.424544 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.425635 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m13:39:02.425877 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:39:02.426220 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m13:39:02.429822 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:39:02.431639 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:39:02.431896 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

      drop view if exists "dev"."main"."users_dim__dbt_backup" cascade
    
[0m13:39:02.435514 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:39:02.437307 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: Close
[0m13:39:02.437912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '486e8304-f5a4-4185-bf61-7e96cc601139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748eda977e90>]}
[0m13:39:02.438414 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.users_dim ................................ [[32mOK[0m in 0.03s]
[0m13:39:02.438839 [debug] [Thread-1 (]: Finished running node model.store_pipeline.users_dim
[0m13:39:02.439426 [debug] [Thread-1 (]: Began running node model.store_pipeline.fact_sales
[0m13:39:02.439786 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fact_sales ................................... [RUN]
[0m13:39:02.440264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.users_dim, now model.store_pipeline.fact_sales)
[0m13:39:02.440481 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.fact_sales
[0m13:39:02.442508 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.fact_sales"
[0m13:39:02.443068 [debug] [Thread-1 (]: Began executing node model.store_pipeline.fact_sales
[0m13:39:02.457216 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.fact_sales"
[0m13:39:02.457794 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:39:02.458264 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: BEGIN
[0m13:39:02.458516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:02.459329 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.459569 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:39:02.459769 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

  
    
    

    create  table
      "dev"."main"."fact_sales__dbt_tmp"
  
    as (
      
WITH carts AS(
    SELECT * FROM "dev"."main"."carts_dim"
),
users AS(
    SELECT * FROM "dev"."main"."users_dim"
),
products AS(
    SELECT * FROM "dev"."main"."products_dim"
)
SELECT u.user_id, c.cart_id, p.product_id, p.product_price, p.product_rating_count,
         p.product_rating_count, c.cart_date, (c.quantity * p.product_price) AS total_amount
FROM carts c 
JOIN users u ON c.user_id = u.user_id
JOIN products p ON c.product_id = p.product_id
    );
  
  
[0m13:39:02.473859 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m13:39:02.479159 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:39:02.479497 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fact_sales'
  
[0m13:39:02.480478 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.481288 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:39:02.481510 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fact_sales'
  
[0m13:39:02.482432 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:02.484981 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:39:02.485270 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */
alter table "dev"."main"."fact_sales" rename to "fact_sales__dbt_backup"
[0m13:39:02.486069 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:39:02.487709 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:39:02.487931 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */
alter table "dev"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m13:39:02.488464 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:39:02.492359 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: COMMIT
[0m13:39:02.492697 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:39:02.492895 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: COMMIT
[0m13:39:02.496786 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:39:02.498469 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:39:02.498723 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

      drop table if exists "dev"."main"."fact_sales__dbt_backup" cascade
    
[0m13:39:02.502367 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:39:02.503473 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: Close
[0m13:39:02.504307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '486e8304-f5a4-4185-bf61-7e96cc601139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748ef25fd1c0>]}
[0m13:39:02.504725 [info ] [Thread-1 (]: 7 of 7 OK created sql table model main.fact_sales .............................. [[32mOK[0m in 0.06s]
[0m13:39:02.505119 [debug] [Thread-1 (]: Finished running node model.store_pipeline.fact_sales
[0m13:39:02.506496 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:02.506728 [debug] [MainThread]: On master: BEGIN
[0m13:39:02.506899 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:39:02.507482 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:39:02.507693 [debug] [MainThread]: On master: COMMIT
[0m13:39:02.507915 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:02.508085 [debug] [MainThread]: On master: COMMIT
[0m13:39:02.508812 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:39:02.509082 [debug] [MainThread]: On master: Close
[0m13:39:02.509639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:02.509976 [debug] [MainThread]: Connection 'model.store_pipeline.fact_sales' was properly closed.
[0m13:39:02.510224 [info ] [MainThread]: 
[0m13:39:02.510545 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m13:39:02.511461 [debug] [MainThread]: Command end result
[0m13:39:02.521626 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:39:02.523459 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:39:02.527888 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m13:39:02.528139 [info ] [MainThread]: 
[0m13:39:02.528519 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:39:02.528773 [info ] [MainThread]: 
[0m13:39:02.529046 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m13:39:02.529745 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2255683, "process_in_blocks": "40328", "process_kernel_time": 0.34956, "process_mem_max_rss": "156188", "process_out_blocks": "3128", "process_user_time": 2.154267}
[0m13:39:02.530051 [debug] [MainThread]: Command `dbt run` succeeded at 13:39:02.529980 after 1.23 seconds
[0m13:39:02.530360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748efd175160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748efd599820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748edaa626c0>]}
[0m13:39:02.530682 [debug] [MainThread]: Flushing usage events
[0m13:39:03.573422 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:37.194161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90bcf447d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90bab1cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90bafc0860>]}


============================== 13:39:37.196714 | 131ab7fb-773e-454a-9ad9-563d45c76714 ==============================
[0m13:39:37.196714 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:39:37.197138 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_format': 'default', 'target_path': 'None', 'debug': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'no_print': 'None', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'profiles_dir': '/root/.dbt', 'quiet': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'partial_parse': 'True'}
[0m13:39:37.352677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '131ab7fb-773e-454a-9ad9-563d45c76714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90ba3f0740>]}
[0m13:39:37.394744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '131ab7fb-773e-454a-9ad9-563d45c76714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90b0817aa0>]}
[0m13:39:37.395753 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:39:37.436384 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:39:37.491348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:39:37.491596 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:39:37.495330 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m13:39:37.514738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '131ab7fb-773e-454a-9ad9-563d45c76714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90b0756ff0>]}
[0m13:39:37.553347 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:39:37.554352 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:39:37.562320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '131ab7fb-773e-454a-9ad9-563d45c76714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90b0479100>]}
[0m13:39:37.562625 [info ] [MainThread]: Found 7 models, 3 sources, 444 macros
[0m13:39:37.562876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '131ab7fb-773e-454a-9ad9-563d45c76714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90b044f9e0>]}
[0m13:39:37.564003 [info ] [MainThread]: 
[0m13:39:37.564282 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:39:37.564484 [info ] [MainThread]: 
[0m13:39:37.564776 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:39:37.567941 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:39:37.590086 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:39:37.590359 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:39:37.590519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:37.601085 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m13:39:37.602158 [debug] [ThreadPool]: On list_dev: Close
[0m13:39:37.602914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:39:37.603195 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:39:37.607568 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:39:37.607865 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:39:37.608080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:37.609085 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:39:37.609851 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:39:37.610026 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:39:37.610397 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:39:37.610564 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:39:37.610695 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:39:37.611116 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:39:37.611605 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:39:37.611782 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:39:37.611936 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:39:37.612357 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:39:37.612566 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:39:37.613960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:39:37.619167 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:39:37.619733 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:39:37.620040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:37.620774 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:39:37.620962 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:39:37.621100 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:39:37.627826 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m13:39:37.628803 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:39:37.629611 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:39:37.629829 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:39:37.631159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '131ab7fb-773e-454a-9ad9-563d45c76714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90b044b710>]}
[0m13:39:37.631445 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:37.631607 [debug] [MainThread]: On master: BEGIN
[0m13:39:37.631739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:39:37.632419 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:39:37.632737 [debug] [MainThread]: On master: COMMIT
[0m13:39:37.632928 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:37.633092 [debug] [MainThread]: On master: COMMIT
[0m13:39:37.633594 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:39:37.633776 [debug] [MainThread]: On master: Close
[0m13:39:37.636015 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m13:39:37.636340 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_carts ..................................... [RUN]
[0m13:39:37.636636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m13:39:37.636822 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m13:39:37.641288 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m13:39:37.641731 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m13:39:37.661798 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_carts"
[0m13:39:37.662297 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:39:37.662512 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: BEGIN
[0m13:39:37.662691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:37.664039 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.664371 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:39:37.664575 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(cart_date AS TIMESTAMP) AS cart_date,
        CAST(quantity AS INT) AS quantity
FROM raw_carts
  );

[0m13:39:37.665328 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.669088 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:39:37.669326 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts" rename to "stg_carts__dbt_backup"
[0m13:39:37.669946 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:39:37.671748 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:39:37.671997 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts__dbt_tmp" rename to "stg_carts"
[0m13:39:37.672651 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:39:37.679778 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m13:39:37.680038 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:39:37.680213 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m13:39:37.684590 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:39:37.687833 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:39:37.688118 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

      drop view if exists "dev"."main"."stg_carts__dbt_backup" cascade
    
[0m13:39:37.690708 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:39:37.692219 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: Close
[0m13:39:37.693272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '131ab7fb-773e-454a-9ad9-563d45c76714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90bcc573e0>]}
[0m13:39:37.693658 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_carts ................................ [[32mOK[0m in 0.06s]
[0m13:39:37.694112 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m13:39:37.694505 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m13:39:37.694883 [info ] [Thread-1 (]: 2 of 7 START sql view model main.stg_products .................................. [RUN]
[0m13:39:37.695455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m13:39:37.695669 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m13:39:37.697236 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m13:39:37.697599 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m13:39:37.699435 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_products"
[0m13:39:37.699809 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:39:37.700021 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: BEGIN
[0m13:39:37.700182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:37.700811 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.701034 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:39:37.701232 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH raw_products AS(
    SELECT * FROM "dev"."main"."products"
)
SELECT CAST(id AS INT) AS product_id, 
        CAST(title AS VARCHAR) AS product_title,
        CAST(price AS FLOAT) AS product_price,
        CAST(description AS VARCHAR) AS product_description,
        CAST(category AS VARCHAR) AS product_category,
        CAST(rating_rate AS FLOAT) AS product_rating_rate,
        CAST(rating_count AS INT) AS product_rating_count
FROM raw_products
  );

[0m13:39:37.702116 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.705823 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:39:37.706300 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m13:39:37.708125 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.710023 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:39:37.710239 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:39:37.710974 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.712041 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m13:39:37.712262 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:39:37.712464 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m13:39:37.716274 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:39:37.717829 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:39:37.718072 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m13:39:37.721566 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:39:37.722435 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: Close
[0m13:39:37.722848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '131ab7fb-773e-454a-9ad9-563d45c76714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90af710d40>]}
[0m13:39:37.723244 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.03s]
[0m13:39:37.723620 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m13:39:37.723860 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m13:39:37.724259 [info ] [Thread-1 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m13:39:37.724664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m13:39:37.724886 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m13:39:37.726843 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m13:39:37.727313 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m13:39:37.729417 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_users"
[0m13:39:37.730060 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:39:37.730313 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: BEGIN
[0m13:39:37.730565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:37.731315 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.731585 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:39:37.732036 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    WITH raw_users AS(
    SELECT * FROM "dev"."main"."users"
)
SELECT CAST(id AS INT) AS user_id, 
        CAST(email AS VARCHAR) AS user_email,
        CAST(username AS VARCHAR) AS user_username,
        CAST(password AS VARCHAR) AS user_password,
        CAST(name_firstname AS VARCHAR) AS user_name_firstname,
        CAST(name_lastname AS VARCHAR) AS user_name_lastname,
        CAST(address_city AS VARCHAR) AS user_address_city,
        CAST(address_street AS VARCHAR) AS user_address_street,
        CAST(address_number AS INT) AS user_address_number,
        CAST(address_zipcode AS VARCHAR) AS user_address_zipcode,
        CAST(phone AS VARCHAR) AS user_phone
FROM raw_users
  );

[0m13:39:37.733144 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.735101 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:39:37.735315 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m13:39:37.736053 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.737531 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:39:37.737731 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:39:37.738280 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:39:37.739112 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m13:39:37.739313 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:39:37.739470 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m13:39:37.742851 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:39:37.744473 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:39:37.744746 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m13:39:37.748246 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:39:37.749284 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: Close
[0m13:39:37.749751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '131ab7fb-773e-454a-9ad9-563d45c76714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90af989df0>]}
[0m13:39:37.750107 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.03s]
[0m13:39:37.750461 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m13:39:37.750903 [debug] [Thread-1 (]: Began running node model.store_pipeline.carts_dim
[0m13:39:37.751381 [info ] [Thread-1 (]: 4 of 7 START sql view model main.carts_dim ..................................... [RUN]
[0m13:39:37.751835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_users, now model.store_pipeline.carts_dim)
[0m13:39:37.752143 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.carts_dim
[0m13:39:37.753744 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.carts_dim"
[0m13:39:37.754126 [debug] [Thread-1 (]: Began executing node model.store_pipeline.carts_dim
[0m13:39:37.755970 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.carts_dim"
[0m13:39:37.756372 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:39:37.756600 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: BEGIN
[0m13:39:37.756862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:37.757532 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.757758 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:39:37.757925 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

  
  create view "dev"."main"."carts_dim__dbt_tmp" as (
    WITH carts_dim AS(
    SELECT * FROM "dev"."main"."stg_carts"
)
SELECT * FROM carts_dim
  );

[0m13:39:37.758665 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.760768 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:39:37.761099 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */
alter view "dev"."main"."carts_dim" rename to "carts_dim__dbt_backup"
[0m13:39:37.761954 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.763661 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:39:37.765001 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */
alter view "dev"."main"."carts_dim__dbt_tmp" rename to "carts_dim"
[0m13:39:37.765734 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:39:37.766553 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m13:39:37.766754 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:39:37.766917 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m13:39:37.769507 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:39:37.771156 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:39:37.771395 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

      drop view if exists "dev"."main"."carts_dim__dbt_backup" cascade
    
[0m13:39:37.774148 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:39:37.775033 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: Close
[0m13:39:37.775491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '131ab7fb-773e-454a-9ad9-563d45c76714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90af769af0>]}
[0m13:39:37.775873 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.carts_dim ................................ [[32mOK[0m in 0.02s]
[0m13:39:37.776291 [debug] [Thread-1 (]: Finished running node model.store_pipeline.carts_dim
[0m13:39:37.776530 [debug] [Thread-1 (]: Began running node model.store_pipeline.products_dim
[0m13:39:37.776901 [info ] [Thread-1 (]: 5 of 7 START sql view model main.products_dim .................................. [RUN]
[0m13:39:37.777190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.carts_dim, now model.store_pipeline.products_dim)
[0m13:39:37.777381 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.products_dim
[0m13:39:37.778849 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.products_dim"
[0m13:39:37.779220 [debug] [Thread-1 (]: Began executing node model.store_pipeline.products_dim
[0m13:39:37.780979 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.products_dim"
[0m13:39:37.781326 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:39:37.781519 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: BEGIN
[0m13:39:37.781760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:37.782480 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.782795 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:39:37.783004 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

  
  create view "dev"."main"."products_dim__dbt_tmp" as (
    WITH products_dim AS(
    SELECT * FROM "dev"."main"."stg_products"
)
SELECT * FROM products_dim
  );

[0m13:39:37.783977 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.786746 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:39:37.787214 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */
alter view "dev"."main"."products_dim" rename to "products_dim__dbt_backup"
[0m13:39:37.788129 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.790513 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:39:37.790822 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */
alter view "dev"."main"."products_dim__dbt_tmp" rename to "products_dim"
[0m13:39:37.791531 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:39:37.792788 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m13:39:37.793177 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:39:37.793389 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m13:39:37.796336 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:39:37.797754 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:39:37.797962 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

      drop view if exists "dev"."main"."products_dim__dbt_backup" cascade
    
[0m13:39:37.800624 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:39:37.801657 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: Close
[0m13:39:37.802124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '131ab7fb-773e-454a-9ad9-563d45c76714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90b0312b40>]}
[0m13:39:37.802514 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.products_dim ............................. [[32mOK[0m in 0.02s]
[0m13:39:37.802920 [debug] [Thread-1 (]: Finished running node model.store_pipeline.products_dim
[0m13:39:37.803318 [debug] [Thread-1 (]: Began running node model.store_pipeline.users_dim
[0m13:39:37.803729 [info ] [Thread-1 (]: 6 of 7 START sql view model main.users_dim ..................................... [RUN]
[0m13:39:37.804220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.products_dim, now model.store_pipeline.users_dim)
[0m13:39:37.804508 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.users_dim
[0m13:39:37.806012 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.users_dim"
[0m13:39:37.806452 [debug] [Thread-1 (]: Began executing node model.store_pipeline.users_dim
[0m13:39:37.808463 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.users_dim"
[0m13:39:37.808821 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:39:37.809014 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: BEGIN
[0m13:39:37.809179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:37.809817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.810019 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:39:37.810183 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

  
  create view "dev"."main"."users_dim__dbt_tmp" as (
    WITH users_dim AS (
    SELECT * FROM "dev"."main"."stg_users"
)
SELECT * FROM users_dim
  );

[0m13:39:37.810999 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.812819 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:39:37.813182 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */
alter view "dev"."main"."users_dim" rename to "users_dim__dbt_backup"
[0m13:39:37.813895 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:39:37.815617 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:39:37.816137 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */
alter view "dev"."main"."users_dim__dbt_tmp" rename to "users_dim"
[0m13:39:37.817137 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.818073 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m13:39:37.818290 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:39:37.818459 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m13:39:37.821475 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:39:37.823973 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:39:37.824211 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

      drop view if exists "dev"."main"."users_dim__dbt_backup" cascade
    
[0m13:39:37.829489 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:39:37.830560 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: Close
[0m13:39:37.831303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '131ab7fb-773e-454a-9ad9-563d45c76714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90af76fc20>]}
[0m13:39:37.831955 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.users_dim ................................ [[32mOK[0m in 0.03s]
[0m13:39:37.832513 [debug] [Thread-1 (]: Finished running node model.store_pipeline.users_dim
[0m13:39:37.833249 [debug] [Thread-1 (]: Began running node model.store_pipeline.fact_sales
[0m13:39:37.833610 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fact_sales ................................... [RUN]
[0m13:39:37.833940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.users_dim, now model.store_pipeline.fact_sales)
[0m13:39:37.834148 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.fact_sales
[0m13:39:37.879007 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.fact_sales"
[0m13:39:37.879507 [debug] [Thread-1 (]: Began executing node model.store_pipeline.fact_sales
[0m13:39:37.891282 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.fact_sales"
[0m13:39:37.891810 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:39:37.892095 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: BEGIN
[0m13:39:37.892269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:37.892891 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.893079 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:39:37.893239 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

  
    
    

    create  table
      "dev"."main"."fact_sales__dbt_tmp"
  
    as (
      
WITH carts AS(
    SELECT * FROM "dev"."main"."carts_dim"
),
users AS(
    SELECT * FROM "dev"."main"."users_dim"
),
products AS(
    SELECT * FROM "dev"."main"."products_dim"
)
SELECT u.user_id, c.cart_id, p.product_id, p.product_price, p.product_rating_count,
         p.product_rating_count, c.cart_date, (c.quantity * p.product_price) AS total_amount
FROM carts c 
JOIN users u ON c.user_id = u.user_id
JOIN products p ON c.product_id = p.product_id
    );
  
  
[0m13:39:37.898600 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:39:37.902099 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:39:37.902391 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fact_sales'
  
[0m13:39:37.903232 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.904112 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:39:37.904332 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fact_sales'
  
[0m13:39:37.905055 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:39:37.906822 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:39:37.907122 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */
alter table "dev"."main"."fact_sales" rename to "fact_sales__dbt_backup"
[0m13:39:37.907768 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:39:37.909581 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:39:37.909803 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */
alter table "dev"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m13:39:37.910349 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:39:37.914864 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: COMMIT
[0m13:39:37.915124 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:39:37.915309 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: COMMIT
[0m13:39:37.918813 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:39:37.920265 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:39:37.920478 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

      drop table if exists "dev"."main"."fact_sales__dbt_backup" cascade
    
[0m13:39:37.924043 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:39:37.924851 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: Close
[0m13:39:37.925387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '131ab7fb-773e-454a-9ad9-563d45c76714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90bac32030>]}
[0m13:39:37.925848 [info ] [Thread-1 (]: 7 of 7 OK created sql table model main.fact_sales .............................. [[32mOK[0m in 0.09s]
[0m13:39:37.926226 [debug] [Thread-1 (]: Finished running node model.store_pipeline.fact_sales
[0m13:39:37.927511 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:37.927713 [debug] [MainThread]: On master: BEGIN
[0m13:39:37.927938 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:39:37.928674 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:39:37.928866 [debug] [MainThread]: On master: COMMIT
[0m13:39:37.929026 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:37.929160 [debug] [MainThread]: On master: COMMIT
[0m13:39:37.929514 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:39:37.929692 [debug] [MainThread]: On master: Close
[0m13:39:37.929950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:37.930092 [debug] [MainThread]: Connection 'model.store_pipeline.fact_sales' was properly closed.
[0m13:39:37.930304 [info ] [MainThread]: 
[0m13:39:37.930499 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m13:39:37.931181 [debug] [MainThread]: Command end result
[0m13:39:37.942743 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:39:37.943884 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:39:37.947672 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m13:39:37.947898 [info ] [MainThread]: 
[0m13:39:37.948187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:39:37.948382 [info ] [MainThread]: 
[0m13:39:37.948595 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m13:39:37.949245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.80488753, "process_in_blocks": "0", "process_kernel_time": 0.190679, "process_mem_max_rss": "154284", "process_out_blocks": "2216", "process_user_time": 1.707644}
[0m13:39:37.949565 [debug] [MainThread]: Command `dbt run` succeeded at 13:39:37.949497 after 0.81 seconds
[0m13:39:37.949792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90bab1cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90bb2b3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90bafc0860>]}
[0m13:39:37.950036 [debug] [MainThread]: Flushing usage events
[0m13:39:38.813505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:38.225359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742a31c69af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742a31d7eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742a323eb200>]}


============================== 13:41:38.228280 | 0c4f578e-895e-474b-966b-ec93f2a0ba83 ==============================
[0m13:41:38.228280 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:41:38.228681 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'debug': 'False', 'use_colors': 'True', 'no_print': 'None', 'partial_parse': 'True', 'target_path': 'None', 'static_parser': 'True'}
[0m13:41:38.392664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c4f578e-895e-474b-966b-ec93f2a0ba83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742a31518d70>]}
[0m13:41:38.439247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c4f578e-895e-474b-966b-ec93f2a0ba83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742a323eb890>]}
[0m13:41:38.440451 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m13:41:38.483564 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:41:38.548998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:41:38.549527 [debug] [MainThread]: Partial parsing: updated file: store_pipeline://models/schema/fact_sales.sql
[0m13:41:38.725719 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m13:41:38.735281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c4f578e-895e-474b-966b-ec93f2a0ba83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742a274ea5a0>]}
[0m13:41:38.782834 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:41:38.784197 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:41:38.793501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c4f578e-895e-474b-966b-ec93f2a0ba83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742a275260f0>]}
[0m13:41:38.793876 [info ] [MainThread]: Found 7 models, 3 sources, 444 macros
[0m13:41:38.794174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c4f578e-895e-474b-966b-ec93f2a0ba83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742a314196a0>]}
[0m13:41:38.795645 [info ] [MainThread]: 
[0m13:41:38.795929 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:41:38.796208 [info ] [MainThread]: 
[0m13:41:38.796609 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:41:38.800132 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:41:38.826337 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:41:38.826694 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:41:38.826905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:38.840439 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m13:41:38.841702 [debug] [ThreadPool]: On list_dev: Close
[0m13:41:38.842607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:41:38.842963 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:41:38.848079 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:41:38.848413 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:41:38.848625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:41:38.849811 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:41:38.850757 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:41:38.850975 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:41:38.851610 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:41:38.851914 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:41:38.852145 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:41:38.852665 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:41:38.853246 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:41:38.853470 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:41:38.853628 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:41:38.854169 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:41:38.854380 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:41:38.855741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:41:38.859649 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:41:38.859884 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:41:38.860094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:41:38.860730 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:41:38.860925 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:41:38.861085 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:41:38.868791 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m13:41:38.869830 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:41:38.870547 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:41:38.870741 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:41:38.872313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c4f578e-895e-474b-966b-ec93f2a0ba83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742a276cc950>]}
[0m13:41:38.872647 [debug] [MainThread]: Using duckdb connection "master"
[0m13:41:38.872826 [debug] [MainThread]: On master: BEGIN
[0m13:41:38.872983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:38.873574 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:41:38.873790 [debug] [MainThread]: On master: COMMIT
[0m13:41:38.873967 [debug] [MainThread]: Using duckdb connection "master"
[0m13:41:38.874133 [debug] [MainThread]: On master: COMMIT
[0m13:41:38.874516 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:41:38.874705 [debug] [MainThread]: On master: Close
[0m13:41:38.877278 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m13:41:38.877634 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_carts ..................................... [RUN]
[0m13:41:38.877992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m13:41:38.878232 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m13:41:38.883351 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m13:41:38.883852 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m13:41:38.907116 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_carts"
[0m13:41:38.907711 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:41:38.908051 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: BEGIN
[0m13:41:38.908269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:38.909435 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:38.909745 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:41:38.909985 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(cart_date AS TIMESTAMP) AS cart_date,
        CAST(quantity AS INT) AS quantity
FROM raw_carts
  );

[0m13:41:38.910840 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:38.914936 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:41:38.915438 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts" rename to "stg_carts__dbt_backup"
[0m13:41:38.916157 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:41:38.918082 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:41:38.918332 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts__dbt_tmp" rename to "stg_carts"
[0m13:41:38.919063 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:41:38.927196 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m13:41:38.927462 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:41:38.927659 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m13:41:38.932905 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:41:38.936854 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m13:41:38.937242 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

      drop view if exists "dev"."main"."stg_carts__dbt_backup" cascade
    
[0m13:41:38.940288 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:41:38.942003 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: Close
[0m13:41:38.943222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c4f578e-895e-474b-966b-ec93f2a0ba83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742a27811550>]}
[0m13:41:38.943684 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_carts ................................ [[32mOK[0m in 0.06s]
[0m13:41:38.944172 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m13:41:38.944493 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m13:41:38.944848 [info ] [Thread-1 (]: 2 of 7 START sql view model main.stg_products .................................. [RUN]
[0m13:41:38.945505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m13:41:38.945805 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m13:41:38.947828 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m13:41:38.948269 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m13:41:38.950408 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_products"
[0m13:41:38.950807 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:41:38.951034 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: BEGIN
[0m13:41:38.951217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:38.951956 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:38.952249 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:41:38.952461 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH raw_products AS(
    SELECT * FROM "dev"."main"."products"
)
SELECT CAST(id AS INT) AS product_id, 
        CAST(title AS VARCHAR) AS product_title,
        CAST(price AS FLOAT) AS product_price,
        CAST(description AS VARCHAR) AS product_description,
        CAST(category AS VARCHAR) AS product_category,
        CAST(rating_rate AS FLOAT) AS product_rating_rate,
        CAST(rating_count AS INT) AS product_rating_count
FROM raw_products
  );

[0m13:41:38.953234 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:38.955121 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:41:38.955360 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m13:41:38.955923 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:41:38.957660 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:41:38.957896 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:41:38.958423 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:41:38.959615 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m13:41:38.959851 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:41:38.960051 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m13:41:38.962912 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:41:38.964747 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m13:41:38.965113 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m13:41:38.969034 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:41:38.970403 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: Close
[0m13:41:38.971047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c4f578e-895e-474b-966b-ec93f2a0ba83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742a243b7b30>]}
[0m13:41:38.971501 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.03s]
[0m13:41:38.972110 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m13:41:38.972572 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m13:41:38.972963 [info ] [Thread-1 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m13:41:38.973573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m13:41:38.974083 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m13:41:38.977399 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m13:41:38.977966 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m13:41:39.032537 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_users"
[0m13:41:39.033162 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:41:39.033438 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: BEGIN
[0m13:41:39.033629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:39.034388 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:39.034634 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:41:39.034838 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    WITH raw_users AS(
    SELECT * FROM "dev"."main"."users"
)
SELECT CAST(id AS INT) AS user_id, 
        CAST(email AS VARCHAR) AS user_email,
        CAST(username AS VARCHAR) AS user_username,
        CAST(password AS VARCHAR) AS user_password,
        CAST(name_firstname AS VARCHAR) AS user_name_firstname,
        CAST(name_lastname AS VARCHAR) AS user_name_lastname,
        CAST(address_city AS VARCHAR) AS user_address_city,
        CAST(address_street AS VARCHAR) AS user_address_street,
        CAST(address_number AS INT) AS user_address_number,
        CAST(address_zipcode AS VARCHAR) AS user_address_zipcode,
        CAST(phone AS VARCHAR) AS user_phone
FROM raw_users
  );

[0m13:41:39.035635 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:39.037528 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:41:39.037769 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m13:41:39.038352 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:41:39.040113 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:41:39.040346 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:41:39.040882 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:41:39.041766 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m13:41:39.041983 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:41:39.042188 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m13:41:39.046845 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:41:39.048536 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m13:41:39.048781 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m13:41:39.052582 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:41:39.053544 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: Close
[0m13:41:39.053991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c4f578e-895e-474b-966b-ec93f2a0ba83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742a275b7080>]}
[0m13:41:39.054428 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.08s]
[0m13:41:39.054801 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m13:41:39.055116 [debug] [Thread-1 (]: Began running node model.store_pipeline.carts_dim
[0m13:41:39.055466 [info ] [Thread-1 (]: 4 of 7 START sql view model main.carts_dim ..................................... [RUN]
[0m13:41:39.056090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_users, now model.store_pipeline.carts_dim)
[0m13:41:39.056509 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.carts_dim
[0m13:41:39.058083 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.carts_dim"
[0m13:41:39.058514 [debug] [Thread-1 (]: Began executing node model.store_pipeline.carts_dim
[0m13:41:39.061093 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.carts_dim"
[0m13:41:39.061669 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:41:39.062273 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: BEGIN
[0m13:41:39.062656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:39.063498 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:39.063803 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:41:39.064010 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

  
  create view "dev"."main"."carts_dim__dbt_tmp" as (
    WITH carts_dim AS(
    SELECT * FROM "dev"."main"."stg_carts"
)
SELECT * FROM carts_dim
  );

[0m13:41:39.065029 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:39.066965 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:41:39.067431 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */
alter view "dev"."main"."carts_dim" rename to "carts_dim__dbt_backup"
[0m13:41:39.068602 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:39.071596 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:41:39.071856 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */
alter view "dev"."main"."carts_dim__dbt_tmp" rename to "carts_dim"
[0m13:41:39.072769 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:39.073719 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m13:41:39.073936 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:41:39.074155 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m13:41:39.078522 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:41:39.080274 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m13:41:39.080552 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

      drop view if exists "dev"."main"."carts_dim__dbt_backup" cascade
    
[0m13:41:39.084076 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:41:39.085097 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: Close
[0m13:41:39.085959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c4f578e-895e-474b-966b-ec93f2a0ba83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742a27831d30>]}
[0m13:41:39.086416 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.carts_dim ................................ [[32mOK[0m in 0.03s]
[0m13:41:39.086836 [debug] [Thread-1 (]: Finished running node model.store_pipeline.carts_dim
[0m13:41:39.087172 [debug] [Thread-1 (]: Began running node model.store_pipeline.products_dim
[0m13:41:39.087631 [info ] [Thread-1 (]: 5 of 7 START sql view model main.products_dim .................................. [RUN]
[0m13:41:39.088256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.carts_dim, now model.store_pipeline.products_dim)
[0m13:41:39.088520 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.products_dim
[0m13:41:39.090852 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.products_dim"
[0m13:41:39.091437 [debug] [Thread-1 (]: Began executing node model.store_pipeline.products_dim
[0m13:41:39.094925 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.products_dim"
[0m13:41:39.095435 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:41:39.095756 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: BEGIN
[0m13:41:39.096022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:39.096909 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:39.097232 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:41:39.097480 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

  
  create view "dev"."main"."products_dim__dbt_tmp" as (
    WITH products_dim AS(
    SELECT * FROM "dev"."main"."stg_products"
)
SELECT * FROM products_dim
  );

[0m13:41:39.098413 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:39.100335 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:41:39.100619 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */
alter view "dev"."main"."products_dim" rename to "products_dim__dbt_backup"
[0m13:41:39.101338 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:41:39.103003 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:41:39.103515 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */
alter view "dev"."main"."products_dim__dbt_tmp" rename to "products_dim"
[0m13:41:39.104121 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:41:39.105039 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m13:41:39.105296 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:41:39.105486 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m13:41:39.108801 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:41:39.110501 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m13:41:39.110783 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

      drop view if exists "dev"."main"."products_dim__dbt_backup" cascade
    
[0m13:41:39.114852 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:41:39.116125 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: Close
[0m13:41:39.116671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c4f578e-895e-474b-966b-ec93f2a0ba83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742a242a7530>]}
[0m13:41:39.117121 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.products_dim ............................. [[32mOK[0m in 0.03s]
[0m13:41:39.117564 [debug] [Thread-1 (]: Finished running node model.store_pipeline.products_dim
[0m13:41:39.117838 [debug] [Thread-1 (]: Began running node model.store_pipeline.users_dim
[0m13:41:39.118245 [info ] [Thread-1 (]: 6 of 7 START sql view model main.users_dim ..................................... [RUN]
[0m13:41:39.118630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.products_dim, now model.store_pipeline.users_dim)
[0m13:41:39.118893 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.users_dim
[0m13:41:39.120735 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.users_dim"
[0m13:41:39.121149 [debug] [Thread-1 (]: Began executing node model.store_pipeline.users_dim
[0m13:41:39.123110 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.users_dim"
[0m13:41:39.123502 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:41:39.123811 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: BEGIN
[0m13:41:39.124094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:39.125054 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:39.125340 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:41:39.125603 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

  
  create view "dev"."main"."users_dim__dbt_tmp" as (
    WITH users_dim AS (
    SELECT * FROM "dev"."main"."stg_users"
)
SELECT * FROM users_dim
  );

[0m13:41:39.127016 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:39.129186 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:41:39.129470 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */
alter view "dev"."main"."users_dim" rename to "users_dim__dbt_backup"
[0m13:41:39.130135 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:41:39.132159 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:41:39.132612 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */
alter view "dev"."main"."users_dim__dbt_tmp" rename to "users_dim"
[0m13:41:39.133515 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:39.134520 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m13:41:39.134765 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:41:39.134996 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m13:41:39.139376 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:41:39.141043 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m13:41:39.141298 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

      drop view if exists "dev"."main"."users_dim__dbt_backup" cascade
    
[0m13:41:39.143992 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:41:39.144923 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: Close
[0m13:41:39.145376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c4f578e-895e-474b-966b-ec93f2a0ba83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742a31d7d8b0>]}
[0m13:41:39.145836 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.users_dim ................................ [[32mOK[0m in 0.03s]
[0m13:41:39.146259 [debug] [Thread-1 (]: Finished running node model.store_pipeline.users_dim
[0m13:41:39.147060 [debug] [Thread-1 (]: Began running node model.store_pipeline.fact_sales
[0m13:41:39.147431 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fact_sales ................................... [RUN]
[0m13:41:39.147814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.users_dim, now model.store_pipeline.fact_sales)
[0m13:41:39.148107 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.fact_sales
[0m13:41:39.150279 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.fact_sales"
[0m13:41:39.150733 [debug] [Thread-1 (]: Began executing node model.store_pipeline.fact_sales
[0m13:41:39.166209 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.fact_sales"
[0m13:41:39.166836 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:41:39.167108 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: BEGIN
[0m13:41:39.167303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:39.168174 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:39.168501 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:41:39.168753 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

  
    
    

    create  table
      "dev"."main"."fact_sales__dbt_tmp"
  
    as (
      
WITH carts AS(
    SELECT * FROM "dev"."main"."carts_dim"
),
users AS(
    SELECT * FROM "dev"."main"."users_dim"
),
products AS(
    SELECT * FROM "dev"."main"."products_dim"
)
SELECT u.user_id, c.cart_id, p.product_id, p.product_price, p.product_rating_count,
         p.product_rating_count, c.cart_date, (c.quantity * p.product_price) AS total_amount, p.product_category
FROM carts c 
JOIN users u ON c.user_id = u.user_id
JOIN products p ON c.product_id = p.product_id
    );
  
  
[0m13:41:39.176316 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:41:39.182174 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:41:39.182569 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fact_sales'
  
[0m13:41:39.183765 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:39.184847 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:41:39.185123 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fact_sales'
  
[0m13:41:39.186167 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:41:39.188292 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:41:39.188553 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */
alter table "dev"."main"."fact_sales" rename to "fact_sales__dbt_backup"
[0m13:41:39.189284 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:41:39.191086 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:41:39.191337 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */
alter table "dev"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m13:41:39.192069 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:41:39.195413 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: COMMIT
[0m13:41:39.195653 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:41:39.195870 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: COMMIT
[0m13:41:39.200755 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:41:39.202298 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m13:41:39.202550 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

      drop table if exists "dev"."main"."fact_sales__dbt_backup" cascade
    
[0m13:41:39.206727 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:41:39.207735 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: Close
[0m13:41:39.208722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c4f578e-895e-474b-966b-ec93f2a0ba83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742a2434bbc0>]}
[0m13:41:39.209153 [info ] [Thread-1 (]: 7 of 7 OK created sql table model main.fact_sales .............................. [[32mOK[0m in 0.06s]
[0m13:41:39.209560 [debug] [Thread-1 (]: Finished running node model.store_pipeline.fact_sales
[0m13:41:39.210905 [debug] [MainThread]: Using duckdb connection "master"
[0m13:41:39.211141 [debug] [MainThread]: On master: BEGIN
[0m13:41:39.211309 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:41:39.211981 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:41:39.212208 [debug] [MainThread]: On master: COMMIT
[0m13:41:39.212412 [debug] [MainThread]: Using duckdb connection "master"
[0m13:41:39.212598 [debug] [MainThread]: On master: COMMIT
[0m13:41:39.213026 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:41:39.213219 [debug] [MainThread]: On master: Close
[0m13:41:39.213517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:39.213680 [debug] [MainThread]: Connection 'model.store_pipeline.fact_sales' was properly closed.
[0m13:41:39.213894 [info ] [MainThread]: 
[0m13:41:39.214123 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m13:41:39.214980 [debug] [MainThread]: Command end result
[0m13:41:39.227282 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m13:41:39.228764 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m13:41:39.233410 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m13:41:39.233707 [info ] [MainThread]: 
[0m13:41:39.234034 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:41:39.234282 [info ] [MainThread]: 
[0m13:41:39.234529 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m13:41:39.235273 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0559584, "process_in_blocks": "0", "process_kernel_time": 0.152579, "process_mem_max_rss": "157912", "process_out_blocks": "3120", "process_user_time": 1.850518}
[0m13:41:39.235570 [debug] [MainThread]: Command `dbt run` succeeded at 13:41:39.235501 after 1.06 seconds
[0m13:41:39.235802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742a274dd9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742a33b24530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x742a314ca4e0>]}
[0m13:41:39.236113 [debug] [MainThread]: Flushing usage events
[0m13:41:40.540174 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:05.497302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e25d9138c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e25d6ce630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e25d913e60>]}


============================== 14:20:05.500693 | e8a1ec30-a3f8-43ed-8348-88fadffbd4c5 ==============================
[0m14:20:05.500693 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:20:05.501133 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'no_print': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'empty': 'False', 'profiles_dir': '/root/.dbt', 'write_json': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'target_path': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'use_experimental_parser': 'False', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'invocation_command': 'dbt run'}
[0m14:20:05.696037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8a1ec30-a3f8-43ed-8348-88fadffbd4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e253332330>]}
[0m14:20:05.749763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8a1ec30-a3f8-43ed-8348-88fadffbd4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e25330f7d0>]}
[0m14:20:05.751013 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:20:05.796989 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:20:05.867713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:20:05.868053 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:20:05.873142 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m14:20:05.893878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8a1ec30-a3f8-43ed-8348-88fadffbd4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e25cf2e930>]}
[0m14:20:05.942027 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m14:20:05.943236 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m14:20:05.954424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8a1ec30-a3f8-43ed-8348-88fadffbd4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e252fa4bc0>]}
[0m14:20:05.954808 [info ] [MainThread]: Found 7 models, 3 sources, 444 macros
[0m14:20:05.955088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8a1ec30-a3f8-43ed-8348-88fadffbd4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e252f17260>]}
[0m14:20:05.956388 [info ] [MainThread]: 
[0m14:20:05.956671 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:20:05.956839 [info ] [MainThread]: 
[0m14:20:05.957176 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:20:05.961468 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:20:05.988906 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:20:05.989223 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:20:05.989403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:06.002681 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m14:20:06.003832 [debug] [ThreadPool]: On list_dev: Close
[0m14:20:06.004587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:20:06.005245 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:20:06.011401 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:20:06.011793 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:20:06.011985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:06.013561 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:20:06.014568 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:20:06.014789 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:20:06.015537 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:20:06.015770 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:20:06.015936 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:20:06.016417 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:20:06.016941 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:20:06.017150 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:20:06.017310 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:20:06.017705 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:20:06.017924 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:20:06.019474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m14:20:06.024395 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:20:06.024707 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:20:06.024914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:06.026750 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:20:06.027249 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:20:06.027565 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:20:06.037183 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:20:06.038683 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:20:06.039834 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:20:06.040139 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:20:06.041834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8a1ec30-a3f8-43ed-8348-88fadffbd4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e25ce0e6f0>]}
[0m14:20:06.042174 [debug] [MainThread]: Using duckdb connection "master"
[0m14:20:06.042380 [debug] [MainThread]: On master: BEGIN
[0m14:20:06.042533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:20:06.043247 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:20:06.043484 [debug] [MainThread]: On master: COMMIT
[0m14:20:06.043667 [debug] [MainThread]: Using duckdb connection "master"
[0m14:20:06.043822 [debug] [MainThread]: On master: COMMIT
[0m14:20:06.044452 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:20:06.044792 [debug] [MainThread]: On master: Close
[0m14:20:06.048142 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m14:20:06.048637 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_carts ..................................... [RUN]
[0m14:20:06.049080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m14:20:06.049325 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m14:20:06.057085 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m14:20:06.057565 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m14:20:06.081925 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_carts"
[0m14:20:06.082517 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m14:20:06.082781 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: BEGIN
[0m14:20:06.082965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:06.083785 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.084029 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m14:20:06.084236 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

  
  create view "dev"."main"."stg_carts__dbt_tmp" as (
    WITH raw_carts AS(
    SELECT * FROM "dev"."main"."carts"
)
SELECT CAST(product_id AS INT) AS product_id,
        CAST(user_id AS INT) AS user_id,
        CAST(cart_id AS INT) AS cart_id,
        CAST(cart_date AS TIMESTAMP) AS cart_date,
        CAST(quantity AS INT) AS quantity
FROM raw_carts
  );

[0m14:20:06.085478 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.090276 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m14:20:06.090657 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts" rename to "stg_carts__dbt_backup"
[0m14:20:06.091779 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.093956 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m14:20:06.094277 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */
alter view "dev"."main"."stg_carts__dbt_tmp" rename to "stg_carts"
[0m14:20:06.094999 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:06.104770 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m14:20:06.105230 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m14:20:06.105546 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: COMMIT
[0m14:20:06.109694 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:20:06.113755 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_carts"
[0m14:20:06.114111 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_carts"} */

      drop view if exists "dev"."main"."stg_carts__dbt_backup" cascade
    
[0m14:20:06.118202 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:20:06.120378 [debug] [Thread-1 (]: On model.store_pipeline.stg_carts: Close
[0m14:20:06.121887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a1ec30-a3f8-43ed-8348-88fadffbd4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e25d2affb0>]}
[0m14:20:06.122369 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_carts ................................ [[32mOK[0m in 0.07s]
[0m14:20:06.122785 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m14:20:06.123075 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m14:20:06.123524 [info ] [Thread-1 (]: 2 of 7 START sql view model main.stg_products .................................. [RUN]
[0m14:20:06.123951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m14:20:06.124229 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m14:20:06.126624 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m14:20:06.127674 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m14:20:06.130535 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_products"
[0m14:20:06.131781 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m14:20:06.132185 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: BEGIN
[0m14:20:06.132459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:06.133390 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.133665 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m14:20:06.133894 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH raw_products AS(
    SELECT * FROM "dev"."main"."products"
)
SELECT CAST(id AS INT) AS product_id, 
        CAST(title AS VARCHAR) AS product_title,
        CAST(price AS FLOAT) AS product_price,
        CAST(description AS VARCHAR) AS product_description,
        CAST(category AS VARCHAR) AS product_category,
        CAST(rating_rate AS FLOAT) AS product_rating_rate,
        CAST(rating_count AS INT) AS product_rating_count
FROM raw_products
  );

[0m14:20:06.134798 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.138553 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m14:20:06.138902 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m14:20:06.139869 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.141685 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m14:20:06.141996 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:20:06.142684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:06.143781 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m14:20:06.144073 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m14:20:06.144376 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: COMMIT
[0m14:20:06.148687 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:20:06.150349 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_products"
[0m14:20:06.150599 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m14:20:06.154861 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:20:06.156130 [debug] [Thread-1 (]: On model.store_pipeline.stg_products: Close
[0m14:20:06.156732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a1ec30-a3f8-43ed-8348-88fadffbd4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e250527140>]}
[0m14:20:06.157186 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.03s]
[0m14:20:06.157567 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m14:20:06.157843 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m14:20:06.158464 [info ] [Thread-1 (]: 3 of 7 START sql view model main.stg_users ..................................... [RUN]
[0m14:20:06.158935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m14:20:06.159247 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m14:20:06.161111 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m14:20:06.161655 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m14:20:06.163589 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.stg_users"
[0m14:20:06.164000 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m14:20:06.164323 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: BEGIN
[0m14:20:06.164740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:06.165635 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.165928 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m14:20:06.166141 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

  
  create view "dev"."main"."stg_users__dbt_tmp" as (
    WITH raw_users AS(
    SELECT * FROM "dev"."main"."users"
)
SELECT CAST(id AS INT) AS user_id, 
        CAST(email AS VARCHAR) AS user_email,
        CAST(username AS VARCHAR) AS user_username,
        CAST(password AS VARCHAR) AS user_password,
        CAST(name_firstname AS VARCHAR) AS user_name_firstname,
        CAST(name_lastname AS VARCHAR) AS user_name_lastname,
        CAST(address_city AS VARCHAR) AS user_address_city,
        CAST(address_street AS VARCHAR) AS user_address_street,
        CAST(address_number AS INT) AS user_address_number,
        CAST(address_zipcode AS VARCHAR) AS user_address_zipcode,
        CAST(phone AS VARCHAR) AS user_phone
FROM raw_users
  );

[0m14:20:06.167210 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.169278 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m14:20:06.169611 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users" rename to "stg_users__dbt_backup"
[0m14:20:06.170470 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.173089 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m14:20:06.173405 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */
alter view "dev"."main"."stg_users__dbt_tmp" rename to "stg_users"
[0m14:20:06.174180 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.175229 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m14:20:06.175488 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m14:20:06.175667 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: COMMIT
[0m14:20:06.178988 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:20:06.180833 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.stg_users"
[0m14:20:06.181080 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.stg_users"} */

      drop view if exists "dev"."main"."stg_users__dbt_backup" cascade
    
[0m14:20:06.183638 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:20:06.184691 [debug] [Thread-1 (]: On model.store_pipeline.stg_users: Close
[0m14:20:06.185371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a1ec30-a3f8-43ed-8348-88fadffbd4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e252304f80>]}
[0m14:20:06.185999 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.stg_users ................................ [[32mOK[0m in 0.03s]
[0m14:20:06.186467 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m14:20:06.186746 [debug] [Thread-1 (]: Began running node model.store_pipeline.carts_dim
[0m14:20:06.187375 [info ] [Thread-1 (]: 4 of 7 START sql view model main.carts_dim ..................................... [RUN]
[0m14:20:06.187738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_users, now model.store_pipeline.carts_dim)
[0m14:20:06.187956 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.carts_dim
[0m14:20:06.189706 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.carts_dim"
[0m14:20:06.190107 [debug] [Thread-1 (]: Began executing node model.store_pipeline.carts_dim
[0m14:20:06.192459 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.carts_dim"
[0m14:20:06.193026 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m14:20:06.193280 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: BEGIN
[0m14:20:06.193477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:06.194229 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.194503 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m14:20:06.194719 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

  
  create view "dev"."main"."carts_dim__dbt_tmp" as (
    WITH carts_dim AS(
    SELECT * FROM "dev"."main"."stg_carts"
)
SELECT * FROM carts_dim
  );

[0m14:20:06.195609 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.197707 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m14:20:06.198100 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */
alter view "dev"."main"."carts_dim" rename to "carts_dim__dbt_backup"
[0m14:20:06.199341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.201278 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m14:20:06.202584 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */
alter view "dev"."main"."carts_dim__dbt_tmp" rename to "carts_dim"
[0m14:20:06.203663 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.205988 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m14:20:06.206393 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m14:20:06.206620 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: COMMIT
[0m14:20:06.211067 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:20:06.212998 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.carts_dim"
[0m14:20:06.213351 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.carts_dim"} */

      drop view if exists "dev"."main"."carts_dim__dbt_backup" cascade
    
[0m14:20:06.216292 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:20:06.217334 [debug] [Thread-1 (]: On model.store_pipeline.carts_dim: Close
[0m14:20:06.218427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a1ec30-a3f8-43ed-8348-88fadffbd4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e250569d90>]}
[0m14:20:06.219321 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.carts_dim ................................ [[32mOK[0m in 0.03s]
[0m14:20:06.219763 [debug] [Thread-1 (]: Finished running node model.store_pipeline.carts_dim
[0m14:20:06.220029 [debug] [Thread-1 (]: Began running node model.store_pipeline.products_dim
[0m14:20:06.220574 [info ] [Thread-1 (]: 5 of 7 START sql view model main.products_dim .................................. [RUN]
[0m14:20:06.220950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.carts_dim, now model.store_pipeline.products_dim)
[0m14:20:06.221173 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.products_dim
[0m14:20:06.222972 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.products_dim"
[0m14:20:06.223564 [debug] [Thread-1 (]: Began executing node model.store_pipeline.products_dim
[0m14:20:06.225742 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.products_dim"
[0m14:20:06.226376 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m14:20:06.226688 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: BEGIN
[0m14:20:06.226868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:06.227696 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.227994 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m14:20:06.228187 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

  
  create view "dev"."main"."products_dim__dbt_tmp" as (
    WITH products_dim AS(
    SELECT * FROM "dev"."main"."stg_products"
)
SELECT * FROM products_dim
  );

[0m14:20:06.229023 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.231670 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m14:20:06.232141 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */
alter view "dev"."main"."products_dim" rename to "products_dim__dbt_backup"
[0m14:20:06.233093 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.235031 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m14:20:06.235344 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */
alter view "dev"."main"."products_dim__dbt_tmp" rename to "products_dim"
[0m14:20:06.235995 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:06.236919 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m14:20:06.237142 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m14:20:06.237325 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: COMMIT
[0m14:20:06.240686 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:20:06.242333 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.products_dim"
[0m14:20:06.242582 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.products_dim"} */

      drop view if exists "dev"."main"."products_dim__dbt_backup" cascade
    
[0m14:20:06.245803 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:20:06.247331 [debug] [Thread-1 (]: On model.store_pipeline.products_dim: Close
[0m14:20:06.248045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a1ec30-a3f8-43ed-8348-88fadffbd4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2530bcb00>]}
[0m14:20:06.248594 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.products_dim ............................. [[32mOK[0m in 0.03s]
[0m14:20:06.249052 [debug] [Thread-1 (]: Finished running node model.store_pipeline.products_dim
[0m14:20:06.249381 [debug] [Thread-1 (]: Began running node model.store_pipeline.users_dim
[0m14:20:06.249793 [info ] [Thread-1 (]: 6 of 7 START sql view model main.users_dim ..................................... [RUN]
[0m14:20:06.250333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.products_dim, now model.store_pipeline.users_dim)
[0m14:20:06.250715 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.users_dim
[0m14:20:06.254416 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.users_dim"
[0m14:20:06.255201 [debug] [Thread-1 (]: Began executing node model.store_pipeline.users_dim
[0m14:20:06.258549 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.users_dim"
[0m14:20:06.259122 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m14:20:06.259470 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: BEGIN
[0m14:20:06.259823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:06.260856 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.261149 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m14:20:06.261346 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

  
  create view "dev"."main"."users_dim__dbt_tmp" as (
    WITH users_dim AS (
    SELECT * FROM "dev"."main"."stg_users"
)
SELECT * FROM users_dim
  );

[0m14:20:06.262429 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.264775 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m14:20:06.265174 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */
alter view "dev"."main"."users_dim" rename to "users_dim__dbt_backup"
[0m14:20:06.266422 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.268567 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m14:20:06.268974 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */
alter view "dev"."main"."users_dim__dbt_tmp" rename to "users_dim"
[0m14:20:06.269834 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:20:06.270928 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m14:20:06.271614 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m14:20:06.272116 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: COMMIT
[0m14:20:06.275499 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:20:06.278439 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.users_dim"
[0m14:20:06.278811 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.users_dim"} */

      drop view if exists "dev"."main"."users_dim__dbt_backup" cascade
    
[0m14:20:06.281819 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:20:06.282924 [debug] [Thread-1 (]: On model.store_pipeline.users_dim: Close
[0m14:20:06.283523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a1ec30-a3f8-43ed-8348-88fadffbd4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e2505a05c0>]}
[0m14:20:06.283971 [info ] [Thread-1 (]: 6 of 7 OK created sql view model main.users_dim ................................ [[32mOK[0m in 0.03s]
[0m14:20:06.284372 [debug] [Thread-1 (]: Finished running node model.store_pipeline.users_dim
[0m14:20:06.285482 [debug] [Thread-1 (]: Began running node model.store_pipeline.fact_sales
[0m14:20:06.286039 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fact_sales ................................... [RUN]
[0m14:20:06.286459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.users_dim, now model.store_pipeline.fact_sales)
[0m14:20:06.286704 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.fact_sales
[0m14:20:06.341319 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.fact_sales"
[0m14:20:06.341901 [debug] [Thread-1 (]: Began executing node model.store_pipeline.fact_sales
[0m14:20:06.356820 [debug] [Thread-1 (]: Writing runtime sql for node "model.store_pipeline.fact_sales"
[0m14:20:06.357483 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m14:20:06.357792 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: BEGIN
[0m14:20:06.358028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:06.358803 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.359062 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m14:20:06.359336 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

  
    
    

    create  table
      "dev"."main"."fact_sales__dbt_tmp"
  
    as (
      
WITH carts AS(
    SELECT * FROM "dev"."main"."carts_dim"
),
users AS(
    SELECT * FROM "dev"."main"."users_dim"
),
products AS(
    SELECT * FROM "dev"."main"."products_dim"
)
SELECT u.user_id, c.cart_id, p.product_id, p.product_price, p.product_rating_count,
         p.product_rating_count, c.cart_date, (c.quantity * p.product_price) AS total_amount, p.product_category
FROM carts c 
JOIN users u ON c.user_id = u.user_id
JOIN products p ON c.product_id = p.product_id
    );
  
  
[0m14:20:06.366787 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m14:20:06.371431 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m14:20:06.372025 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fact_sales'
  
[0m14:20:06.373090 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.374151 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m14:20:06.374441 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fact_sales'
  
[0m14:20:06.376388 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:20:06.378857 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m14:20:06.379269 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */
alter table "dev"."main"."fact_sales" rename to "fact_sales__dbt_backup"
[0m14:20:06.380298 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.382484 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m14:20:06.382774 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */
alter table "dev"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m14:20:06.383623 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:20:06.388429 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: COMMIT
[0m14:20:06.388795 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m14:20:06.389004 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: COMMIT
[0m14:20:06.392429 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:20:06.394143 [debug] [Thread-1 (]: Using duckdb connection "model.store_pipeline.fact_sales"
[0m14:20:06.394412 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "node_id": "model.store_pipeline.fact_sales"} */

      drop table if exists "dev"."main"."fact_sales__dbt_backup" cascade
    
[0m14:20:06.397336 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:20:06.398525 [debug] [Thread-1 (]: On model.store_pipeline.fact_sales: Close
[0m14:20:06.399599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a1ec30-a3f8-43ed-8348-88fadffbd4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e25eb3b5c0>]}
[0m14:20:06.400067 [info ] [Thread-1 (]: 7 of 7 OK created sql table model main.fact_sales .............................. [[32mOK[0m in 0.11s]
[0m14:20:06.400447 [debug] [Thread-1 (]: Finished running node model.store_pipeline.fact_sales
[0m14:20:06.401571 [debug] [MainThread]: Using duckdb connection "master"
[0m14:20:06.401824 [debug] [MainThread]: On master: BEGIN
[0m14:20:06.401996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:20:06.402653 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:20:06.402896 [debug] [MainThread]: On master: COMMIT
[0m14:20:06.403154 [debug] [MainThread]: Using duckdb connection "master"
[0m14:20:06.403404 [debug] [MainThread]: On master: COMMIT
[0m14:20:06.404181 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:20:06.404618 [debug] [MainThread]: On master: Close
[0m14:20:06.405185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:06.405487 [debug] [MainThread]: Connection 'model.store_pipeline.fact_sales' was properly closed.
[0m14:20:06.405813 [info ] [MainThread]: 
[0m14:20:06.406119 [info ] [MainThread]: Finished running 1 table model, 6 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m14:20:06.407039 [debug] [MainThread]: Command end result
[0m14:20:06.420371 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m14:20:06.421726 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m14:20:06.426221 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m14:20:06.426552 [info ] [MainThread]: 
[0m14:20:06.426847 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:06.427106 [info ] [MainThread]: 
[0m14:20:06.427376 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m14:20:06.428026 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.97989607, "process_in_blocks": "0", "process_kernel_time": 0.319325, "process_mem_max_rss": "154608", "process_out_blocks": "2216", "process_user_time": 2.177217}
[0m14:20:06.428349 [debug] [MainThread]: Command `dbt run` succeeded at 14:20:06.428280 after 0.98 seconds
[0m14:20:06.428581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e25defbb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e250524b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e250526e10>]}
[0m14:20:06.428805 [debug] [MainThread]: Flushing usage events
[0m14:20:07.541865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:21:49.248298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0667d02ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0667517b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0669ab5bb0>]}


============================== 14:21:49.252105 | 18316c2d-d94b-4240-b095-559e2e1bb143 ==============================
[0m14:21:49.252105 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:21:49.252572 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'no_print': 'None', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'partial_parse': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'profiles_dir': '/root/.dbt', 'introspect': 'True', 'version_check': 'True', 'target_path': 'None', 'quiet': 'False', 'use_colors': 'True', 'invocation_command': 'dbt docs serve', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'indirect_selection': 'eager'}
[0m14:21:49.521614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18316c2d-d94b-4240-b095-559e2e1bb143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0666f8fb30>]}
[0m14:21:49.567306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18316c2d-d94b-4240-b095-559e2e1bb143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d065d5434a0>]}
[0m14:21:51.019641 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m14:21:51.023375 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m14:21:51.024366 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.8171182, "process_in_blocks": "110608", "process_kernel_time": 0.315327, "process_mem_max_rss": "130824", "process_out_blocks": "3360", "process_user_time": 1.261309}
[0m14:21:51.025051 [debug] [MainThread]: Command `dbt docs serve` failed at 14:21:51.024968 after 1.82 seconds
[0m14:21:51.025299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0667f0cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0666f73380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d065d351c40>]}
[0m14:21:51.025538 [debug] [MainThread]: Flushing usage events
[0m14:21:51.921781 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:21:59.662155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e5445dc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e544fc9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e544fc8dd0>]}


============================== 14:21:59.664599 | 3b97d8b5-74f0-4cbc-b8d9-0b034e6ea55a ==============================
[0m14:21:59.664599 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:21:59.665131 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'debug': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'no_print': 'None', 'empty': 'None', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'write_json': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error': 'None', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/root/.dbt'}
[0m14:21:59.846404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b97d8b5-74f0-4cbc-b8d9-0b034e6ea55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e5440d4a10>]}
[0m14:21:59.899852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b97d8b5-74f0-4cbc-b8d9-0b034e6ea55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e546839b50>]}
[0m14:22:00.170528 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:22:00.218991 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:22:00.318468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:22:00.318823 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:22:00.323481 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m14:22:00.344774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b97d8b5-74f0-4cbc-b8d9-0b034e6ea55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e538b00290>]}
[0m14:22:00.357268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b97d8b5-74f0-4cbc-b8d9-0b034e6ea55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e538b42f30>]}
[0m14:22:00.357643 [info ] [MainThread]: Found 7 models, 3 sources, 444 macros
[0m14:22:00.357926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b97d8b5-74f0-4cbc-b8d9-0b034e6ea55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e538918950>]}
[0m14:22:00.359365 [info ] [MainThread]: 
[0m14:22:00.359684 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:22:00.359923 [info ] [MainThread]: 
[0m14:22:00.360322 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:22:00.364275 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:22:00.406121 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:22:00.406457 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:22:00.406643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:00.424667 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m14:22:00.425087 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:22:00.425314 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:22:00.441640 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m14:22:00.443571 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:22:00.445398 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:22:00.445823 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:22:00.447662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b97d8b5-74f0-4cbc-b8d9-0b034e6ea55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e53a4bcbf0>]}
[0m14:22:00.450139 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m14:22:00.450506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m14:22:00.450728 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m14:22:00.456536 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m14:22:00.457577 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m14:22:00.458287 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m14:22:00.458587 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m14:22:00.459240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m14:22:00.459542 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m14:22:00.461478 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m14:22:00.462080 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m14:22:00.462584 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m14:22:00.462844 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m14:22:00.463248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m14:22:00.463707 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m14:22:00.465596 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m14:22:00.466011 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m14:22:00.466577 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m14:22:00.466879 [debug] [Thread-1 (]: Began running node model.store_pipeline.carts_dim
[0m14:22:00.467258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_users, now model.store_pipeline.carts_dim)
[0m14:22:00.467646 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.carts_dim
[0m14:22:00.469890 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.carts_dim"
[0m14:22:00.470605 [debug] [Thread-1 (]: Began executing node model.store_pipeline.carts_dim
[0m14:22:00.471116 [debug] [Thread-1 (]: Finished running node model.store_pipeline.carts_dim
[0m14:22:00.471398 [debug] [Thread-1 (]: Began running node model.store_pipeline.products_dim
[0m14:22:00.471728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.carts_dim, now model.store_pipeline.products_dim)
[0m14:22:00.472305 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.products_dim
[0m14:22:00.474351 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.products_dim"
[0m14:22:00.474785 [debug] [Thread-1 (]: Began executing node model.store_pipeline.products_dim
[0m14:22:00.475275 [debug] [Thread-1 (]: Finished running node model.store_pipeline.products_dim
[0m14:22:00.475531 [debug] [Thread-1 (]: Began running node model.store_pipeline.users_dim
[0m14:22:00.475880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.products_dim, now model.store_pipeline.users_dim)
[0m14:22:00.476110 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.users_dim
[0m14:22:00.477809 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.users_dim"
[0m14:22:00.478230 [debug] [Thread-1 (]: Began executing node model.store_pipeline.users_dim
[0m14:22:00.478671 [debug] [Thread-1 (]: Finished running node model.store_pipeline.users_dim
[0m14:22:00.479375 [debug] [Thread-1 (]: Began running node model.store_pipeline.fact_sales
[0m14:22:00.479666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.users_dim, now model.store_pipeline.fact_sales)
[0m14:22:00.479875 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.fact_sales
[0m14:22:00.482102 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.fact_sales"
[0m14:22:00.482504 [debug] [Thread-1 (]: Began executing node model.store_pipeline.fact_sales
[0m14:22:00.482940 [debug] [Thread-1 (]: Finished running node model.store_pipeline.fact_sales
[0m14:22:00.484097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:00.484316 [debug] [MainThread]: Connection 'model.store_pipeline.fact_sales' was properly closed.
[0m14:22:00.485160 [debug] [MainThread]: Command end result
[0m14:22:00.534746 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m14:22:00.536761 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m14:22:00.541799 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m14:22:00.543460 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m14:22:00.543696 [info ] [MainThread]: Building catalog
[0m14:22:00.551019 [debug] [ThreadPool]: Acquiring new duckdb connection 'dev.information_schema'
[0m14:22:00.556649 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m14:22:00.557012 [debug] [ThreadPool]: On dev.information_schema: BEGIN
[0m14:22:00.557202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:00.558143 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:22:00.558374 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m14:22:00.558564 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "dev.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dev'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dev'
    )
    select
        'dev' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m14:22:00.569069 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:22:00.571860 [debug] [ThreadPool]: On dev.information_schema: ROLLBACK
[0m14:22:00.572594 [debug] [ThreadPool]: Failed to rollback 'dev.information_schema'
[0m14:22:00.572824 [debug] [ThreadPool]: On dev.information_schema: Close
[0m14:22:00.583294 [debug] [MainThread]: Wrote artifact CatalogArtifact to /root/airflow/dags/store_pipeline/target/catalog.json
[0m14:22:00.594097 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m14:22:00.595332 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m14:22:00.595590 [info ] [MainThread]: Catalog written to /root/airflow/dags/store_pipeline/target/catalog.json
[0m14:22:00.596363 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.97873586, "process_in_blocks": "13544", "process_kernel_time": 0.161175, "process_mem_max_rss": "151660", "process_out_blocks": "5344", "process_user_time": 1.544928}
[0m14:22:00.596754 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:22:00.596680 after 0.98 seconds
[0m14:22:00.596958 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:22:00.597112 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.
[0m14:22:00.597333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e5453ea180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e544b12900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e544218ce0>]}
[0m14:22:00.597546 [debug] [MainThread]: Flushing usage events
[0m14:22:01.328697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:22:46.063290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d16fef42090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d16fed27fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d16fed276e0>]}


============================== 14:22:46.065950 | 8e69c60c-781d-4146-89c3-aa1a14ab5797 ==============================
[0m14:22:46.065950 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:22:46.066584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'write_json': 'True', 'profiles_dir': '/root/.dbt', 'log_cache_events': 'False', 'target_path': 'None', 'static_parser': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'debug': 'False', 'partial_parse': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False'}
[0m14:22:46.229918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e69c60c-781d-4146-89c3-aa1a14ab5797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d16fdf45910>]}
[0m14:22:46.277042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e69c60c-781d-4146-89c3-aa1a14ab5797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d16fdf5a360>]}
[0m14:22:47.729063 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m14:22:47.730338 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m14:22:47.731144 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.7099518, "process_in_blocks": "0", "process_kernel_time": 0.183196, "process_mem_max_rss": "131156", "process_out_blocks": "3360", "process_user_time": 1.235512}
[0m14:22:47.731569 [debug] [MainThread]: Command `dbt docs serve` failed at 14:22:47.731492 after 1.71 seconds
[0m14:22:47.731796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d16febdc830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d16f4256ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d16f43314f0>]}
[0m14:22:47.732110 [debug] [MainThread]: Flushing usage events
[0m14:22:48.545447 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:22:51.617359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bd1804f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bd3de5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bd1ed9c40>]}


============================== 14:22:51.620116 | ecfd58d1-346a-4e77-af4f-70006f6164b6 ==============================
[0m14:22:51.620116 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:22:51.620666 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt docs generate', 'quiet': 'False', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'target_path': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'no_print': 'None', 'use_colors': 'True', 'empty': 'None', 'static_parser': 'True', 'printer_width': '80', 'log_format': 'default'}
[0m14:22:51.795656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecfd58d1-346a-4e77-af4f-70006f6164b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bd22ac7a0>]}
[0m14:22:51.842344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecfd58d1-346a-4e77-af4f-70006f6164b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bd1804f80>]}
[0m14:22:51.843461 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:22:51.883511 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:22:51.947711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:22:51.948027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:22:51.952410 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m14:22:51.971288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecfd58d1-346a-4e77-af4f-70006f6164b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bd1447440>]}
[0m14:22:51.982987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecfd58d1-346a-4e77-af4f-70006f6164b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bc7464380>]}
[0m14:22:51.983357 [info ] [MainThread]: Found 7 models, 3 sources, 444 macros
[0m14:22:51.983623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecfd58d1-346a-4e77-af4f-70006f6164b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bc745ffb0>]}
[0m14:22:51.985373 [info ] [MainThread]: 
[0m14:22:51.985814 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:22:51.986052 [info ] [MainThread]: 
[0m14:22:51.986440 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:22:51.990062 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:22:52.017025 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:22:52.017394 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:22:52.017614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:52.028640 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m14:22:52.028956 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:22:52.029153 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:22:52.037505 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:22:52.038843 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:22:52.039602 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:22:52.039791 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:22:52.041307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecfd58d1-346a-4e77-af4f-70006f6164b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bc78a0a70>]}
[0m14:22:52.043604 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m14:22:52.043920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m14:22:52.044213 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m14:22:52.048984 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m14:22:52.049392 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m14:22:52.049822 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m14:22:52.050071 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m14:22:52.050344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m14:22:52.050642 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m14:22:52.053319 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m14:22:52.053798 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m14:22:52.054247 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m14:22:52.054504 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m14:22:52.054800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m14:22:52.055049 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m14:22:52.056940 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m14:22:52.057614 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m14:22:52.058035 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m14:22:52.058282 [debug] [Thread-1 (]: Began running node model.store_pipeline.carts_dim
[0m14:22:52.058553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_users, now model.store_pipeline.carts_dim)
[0m14:22:52.058795 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.carts_dim
[0m14:22:52.060613 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.carts_dim"
[0m14:22:52.060975 [debug] [Thread-1 (]: Began executing node model.store_pipeline.carts_dim
[0m14:22:52.061463 [debug] [Thread-1 (]: Finished running node model.store_pipeline.carts_dim
[0m14:22:52.061713 [debug] [Thread-1 (]: Began running node model.store_pipeline.products_dim
[0m14:22:52.062076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.carts_dim, now model.store_pipeline.products_dim)
[0m14:22:52.062303 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.products_dim
[0m14:22:52.063858 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.products_dim"
[0m14:22:52.064504 [debug] [Thread-1 (]: Began executing node model.store_pipeline.products_dim
[0m14:22:52.064992 [debug] [Thread-1 (]: Finished running node model.store_pipeline.products_dim
[0m14:22:52.065300 [debug] [Thread-1 (]: Began running node model.store_pipeline.users_dim
[0m14:22:52.065585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.products_dim, now model.store_pipeline.users_dim)
[0m14:22:52.065835 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.users_dim
[0m14:22:52.067648 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.users_dim"
[0m14:22:52.068206 [debug] [Thread-1 (]: Began executing node model.store_pipeline.users_dim
[0m14:22:52.068605 [debug] [Thread-1 (]: Finished running node model.store_pipeline.users_dim
[0m14:22:52.069369 [debug] [Thread-1 (]: Began running node model.store_pipeline.fact_sales
[0m14:22:52.069630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.users_dim, now model.store_pipeline.fact_sales)
[0m14:22:52.069844 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.fact_sales
[0m14:22:52.071839 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.fact_sales"
[0m14:22:52.072257 [debug] [Thread-1 (]: Began executing node model.store_pipeline.fact_sales
[0m14:22:52.072717 [debug] [Thread-1 (]: Finished running node model.store_pipeline.fact_sales
[0m14:22:52.073588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:52.073787 [debug] [MainThread]: Connection 'model.store_pipeline.fact_sales' was properly closed.
[0m14:22:52.074495 [debug] [MainThread]: Command end result
[0m14:22:52.117067 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m14:22:52.118487 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m14:22:52.122981 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m14:22:52.124822 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m14:22:52.125049 [info ] [MainThread]: Building catalog
[0m14:22:52.131799 [debug] [ThreadPool]: Acquiring new duckdb connection 'dev.information_schema'
[0m14:22:52.136149 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m14:22:52.136431 [debug] [ThreadPool]: On dev.information_schema: BEGIN
[0m14:22:52.136634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:52.137566 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:22:52.137814 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m14:22:52.138028 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "dev.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dev'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dev'
    )
    select
        'dev' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m14:22:52.145292 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:22:52.148698 [debug] [ThreadPool]: On dev.information_schema: ROLLBACK
[0m14:22:52.149531 [debug] [ThreadPool]: Failed to rollback 'dev.information_schema'
[0m14:22:52.149778 [debug] [ThreadPool]: On dev.information_schema: Close
[0m14:22:52.158686 [debug] [MainThread]: Wrote artifact CatalogArtifact to /root/airflow/dags/store_pipeline/target/catalog.json
[0m14:22:52.169776 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m14:22:52.171360 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m14:22:52.171666 [info ] [MainThread]: Catalog written to /root/airflow/dags/store_pipeline/target/catalog.json
[0m14:22:52.172566 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.59592485, "process_in_blocks": "0", "process_kernel_time": 0.203443, "process_mem_max_rss": "150540", "process_out_blocks": "5352", "process_user_time": 1.482233}
[0m14:22:52.172929 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:22:52.172853 after 0.60 seconds
[0m14:22:52.173123 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:22:52.173267 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.
[0m14:22:52.173446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bd23bbc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bd1b24590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744bc76a2e40>]}
[0m14:22:52.173652 [debug] [MainThread]: Flushing usage events
[0m14:22:53.063381 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:18.922735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fb6690bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fb65da8e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fb66be1040>]}


============================== 14:23:18.925302 | b034ac87-373b-4b2d-b92d-7237750f7185 ==============================
[0m14:23:18.925302 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:23:18.925730 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/root/.dbt', 'write_json': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'warn_error': 'None', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'partial_parse': 'True', 'no_print': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'fail_fast': 'False', 'printer_width': '80', 'introspect': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'target_path': 'None'}
[0m14:23:19.085654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b034ac87-373b-4b2d-b92d-7237750f7185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fb6441be00>]}
[0m14:23:19.132885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b034ac87-373b-4b2d-b92d-7237750f7185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fb5a737380>]}
[0m14:23:20.445942 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m14:23:20.447897 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m14:23:20.448758 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.5683297, "process_in_blocks": "0", "process_kernel_time": 0.182124, "process_mem_max_rss": "131352", "process_out_blocks": "3360", "process_user_time": 1.219812}
[0m14:23:20.449083 [debug] [MainThread]: Command `dbt docs serve` failed at 14:23:20.449018 after 1.57 seconds
[0m14:23:20.449303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fb646eb5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fb5a6bc350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73fb5a6a1e20>]}
[0m14:23:20.449547 [debug] [MainThread]: Flushing usage events
[0m14:23:21.299317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:32.328394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e7480a660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e767a1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e768e5880>]}


============================== 14:23:32.331832 | 8a9f7ec8-fa18-42b1-a89c-222320eeb99c ==============================
[0m14:23:32.331832 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:23:32.332526 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'profiles_dir': '/root/.dbt', 'log_format': 'default', 'write_json': 'True', 'introspect': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'version_check': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'no_print': 'None', 'use_colors': 'True', 'invocation_command': 'dbt docs serve', 'fail_fast': 'False'}
[0m14:23:32.501485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a9f7ec8-fa18-42b1-a89c-222320eeb99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e73d6b5c0>]}
[0m14:23:32.548321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a9f7ec8-fa18-42b1-a89c-222320eeb99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e74438920>]}
[0m14:23:34.284931 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m14:23:34.286395 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m14:23:34.287338 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 2.0020244, "process_in_blocks": "0", "process_kernel_time": 0.216649, "process_mem_max_rss": "130904", "process_out_blocks": "3352", "process_user_time": 1.304142}
[0m14:23:34.287714 [debug] [MainThread]: Command `dbt docs serve` failed at 14:23:34.287634 after 2.00 seconds
[0m14:23:34.287959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e74975160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e6a1d0bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4e6a1d0ad0>]}
[0m14:23:34.288194 [debug] [MainThread]: Flushing usage events
[0m14:23:35.093146 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:40.292028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78481c9a1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78481cba9b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78481d4119d0>]}


============================== 14:23:40.296153 | eeb60168-e9f3-44e8-a45f-e1e4ea9785e1 ==============================
[0m14:23:40.296153 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:23:40.296767 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'static_parser': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_colors': 'True', 'version_check': 'True', 'introspect': 'True', 'partial_parse': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs serve', 'empty': 'None', 'printer_width': '80', 'quiet': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/root/.dbt', 'cache_selected_only': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error': 'None'}
[0m14:23:40.523443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eeb60168-e9f3-44e8-a45f-e1e4ea9785e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78481edae3c0>]}
[0m14:23:40.588160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eeb60168-e9f3-44e8-a45f-e1e4ea9785e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78481cf7b0e0>]}
[0m14:23:43.091937 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m14:23:43.094229 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m14:23:43.095100 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 2.8698657, "process_in_blocks": "0", "process_kernel_time": 0.255937, "process_mem_max_rss": "131388", "process_out_blocks": "3352", "process_user_time": 1.507632}
[0m14:23:43.095538 [debug] [MainThread]: Command `dbt docs serve` failed at 14:23:43.095446 after 2.87 seconds
[0m14:23:43.095823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78481cece4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78482077f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78481c44d490>]}
[0m14:23:43.096077 [debug] [MainThread]: Flushing usage events
[0m14:23:43.871661 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:50.451754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e375e743950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e37601e5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e375e741ee0>]}


============================== 14:23:50.454107 | b3d93809-3d86-47b5-946a-8c6b606448eb ==============================
[0m14:23:50.454107 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:23:50.454483 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'debug': 'False', 'target_path': 'None', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'no_print': 'None', 'introspect': 'True', 'warn_error': 'None', 'empty': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs serve', 'printer_width': '80', 'write_json': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_format': 'default'}
[0m14:23:50.611801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3d93809-3d86-47b5-946a-8c6b606448eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e375e2665a0>]}
[0m14:23:50.656054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3d93809-3d86-47b5-946a-8c6b606448eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e375e6edfa0>]}
[0m14:23:51.923994 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m14:23:51.925179 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m14:23:51.925904 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.5130789, "process_in_blocks": "0", "process_kernel_time": 0.193334, "process_mem_max_rss": "131268", "process_out_blocks": "3360", "process_user_time": 1.202971}
[0m14:23:51.926237 [debug] [MainThread]: Command `dbt docs serve` failed at 14:23:51.926167 after 1.51 seconds
[0m14:23:51.926462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e375f2dc500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3754560b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e37545609e0>]}
[0m14:23:51.926690 [debug] [MainThread]: Flushing usage events
[0m14:23:52.836462 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:55.205031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bb93d0d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bb955e5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bb95a16cf0>]}


============================== 14:23:55.207443 | ab82fb84-b34e-409b-904d-32b4e32b809e ==============================
[0m14:23:55.207443 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:23:55.207815 [debug] [MainThread]: running dbt with arguments {'log_path': '/root/airflow/dags/store_pipeline/logs', 'quiet': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt docs generate', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': '/root/.dbt', 'log_format': 'default', 'use_colors': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False'}
[0m14:23:55.372764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab82fb84-b34e-409b-904d-32b4e32b809e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bb929a6930>]}
[0m14:23:55.419564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab82fb84-b34e-409b-904d-32b4e32b809e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bb94a9f4d0>]}
[0m14:23:55.420788 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:23:55.457498 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:23:55.519085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:23:55.519545 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:23:55.524017 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m14:23:55.545030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab82fb84-b34e-409b-904d-32b4e32b809e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bb88f4bd10>]}
[0m14:23:55.554803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab82fb84-b34e-409b-904d-32b4e32b809e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bb88b750a0>]}
[0m14:23:55.555131 [info ] [MainThread]: Found 7 models, 3 sources, 444 macros
[0m14:23:55.555415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab82fb84-b34e-409b-904d-32b4e32b809e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bb92b3e000>]}
[0m14:23:55.556936 [info ] [MainThread]: 
[0m14:23:55.557272 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:23:55.557498 [info ] [MainThread]: 
[0m14:23:55.557861 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:23:55.561237 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:23:55.587789 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:23:55.588238 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:23:55.588477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:55.600271 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m14:23:55.600625 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:23:55.600823 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:23:55.608816 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:23:55.610020 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:23:55.610796 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:23:55.611014 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:23:55.612565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab82fb84-b34e-409b-904d-32b4e32b809e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bb88f49d00>]}
[0m14:23:55.614811 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m14:23:55.615131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m14:23:55.615393 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m14:23:55.620156 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m14:23:55.620661 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m14:23:55.621120 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m14:23:55.621394 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m14:23:55.621658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m14:23:55.621877 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m14:23:55.623443 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m14:23:55.624057 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m14:23:55.624529 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m14:23:55.624807 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m14:23:55.625100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m14:23:55.625508 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m14:23:55.627542 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m14:23:55.627927 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m14:23:55.628346 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m14:23:55.628621 [debug] [Thread-1 (]: Began running node model.store_pipeline.carts_dim
[0m14:23:55.628891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_users, now model.store_pipeline.carts_dim)
[0m14:23:55.629133 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.carts_dim
[0m14:23:55.631009 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.carts_dim"
[0m14:23:55.631380 [debug] [Thread-1 (]: Began executing node model.store_pipeline.carts_dim
[0m14:23:55.631781 [debug] [Thread-1 (]: Finished running node model.store_pipeline.carts_dim
[0m14:23:55.632022 [debug] [Thread-1 (]: Began running node model.store_pipeline.products_dim
[0m14:23:55.632292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.carts_dim, now model.store_pipeline.products_dim)
[0m14:23:55.632520 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.products_dim
[0m14:23:55.634110 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.products_dim"
[0m14:23:55.634627 [debug] [Thread-1 (]: Began executing node model.store_pipeline.products_dim
[0m14:23:55.635037 [debug] [Thread-1 (]: Finished running node model.store_pipeline.products_dim
[0m14:23:55.635283 [debug] [Thread-1 (]: Began running node model.store_pipeline.users_dim
[0m14:23:55.635660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.products_dim, now model.store_pipeline.users_dim)
[0m14:23:55.635881 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.users_dim
[0m14:23:55.637414 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.users_dim"
[0m14:23:55.637749 [debug] [Thread-1 (]: Began executing node model.store_pipeline.users_dim
[0m14:23:55.638147 [debug] [Thread-1 (]: Finished running node model.store_pipeline.users_dim
[0m14:23:55.638852 [debug] [Thread-1 (]: Began running node model.store_pipeline.fact_sales
[0m14:23:55.639099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.users_dim, now model.store_pipeline.fact_sales)
[0m14:23:55.639329 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.fact_sales
[0m14:23:55.641820 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.fact_sales"
[0m14:23:55.642272 [debug] [Thread-1 (]: Began executing node model.store_pipeline.fact_sales
[0m14:23:55.642756 [debug] [Thread-1 (]: Finished running node model.store_pipeline.fact_sales
[0m14:23:55.643812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:55.644048 [debug] [MainThread]: Connection 'model.store_pipeline.fact_sales' was properly closed.
[0m14:23:55.645012 [debug] [MainThread]: Command end result
[0m14:23:55.688099 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m14:23:55.689401 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m14:23:55.694149 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m14:23:55.695902 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m14:23:55.696100 [info ] [MainThread]: Building catalog
[0m14:23:55.702968 [debug] [ThreadPool]: Acquiring new duckdb connection 'dev.information_schema'
[0m14:23:55.707464 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m14:23:55.707774 [debug] [ThreadPool]: On dev.information_schema: BEGIN
[0m14:23:55.707982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:55.708667 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:23:55.708854 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m14:23:55.709058 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "dev.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dev'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dev'
    )
    select
        'dev' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m14:23:55.714194 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m14:23:55.717936 [debug] [ThreadPool]: On dev.information_schema: ROLLBACK
[0m14:23:55.718876 [debug] [ThreadPool]: Failed to rollback 'dev.information_schema'
[0m14:23:55.719380 [debug] [ThreadPool]: On dev.information_schema: Close
[0m14:23:55.729007 [debug] [MainThread]: Wrote artifact CatalogArtifact to /root/airflow/dags/store_pipeline/target/catalog.json
[0m14:23:55.740286 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m14:23:55.741443 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m14:23:55.741767 [info ] [MainThread]: Catalog written to /root/airflow/dags/store_pipeline/target/catalog.json
[0m14:23:55.742659 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.579277, "process_in_blocks": "0", "process_kernel_time": 0.158169, "process_mem_max_rss": "151140", "process_out_blocks": "5344", "process_user_time": 1.506773}
[0m14:23:55.742994 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:23:55.742927 after 0.58 seconds
[0m14:23:55.743187 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:23:55.743336 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.
[0m14:23:55.743505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bb93a08ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bb93257a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bb92ad04d0>]}
[0m14:23:55.743756 [debug] [MainThread]: Flushing usage events
[0m14:23:56.571353 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:58.643435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a2b349b140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a2b2abb020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a2b2f08e00>]}


============================== 14:23:58.646194 | 2618e917-5400-46fa-87c5-3d455e02a13d ==============================
[0m14:23:58.646194 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:23:58.646874 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'quiet': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'empty': 'None', 'target_path': 'None', 'printer_width': '80', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'no_print': 'None', 'invocation_command': 'dbt docs serve', 'use_colors': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'log_format': 'default', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'fail_fast': 'False'}
[0m14:23:58.813412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2618e917-5400-46fa-87c5-3d455e02a13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a2b30b9be0>]}
[0m14:23:58.859370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2618e917-5400-46fa-87c5-3d455e02a13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a2b26b6c30>]}
[0m14:24:00.759359 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m14:24:00.761570 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m14:24:00.762498 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 2.158018, "process_in_blocks": "0", "process_kernel_time": 0.215266, "process_mem_max_rss": "131100", "process_out_blocks": "3352", "process_user_time": 1.186076}
[0m14:24:00.762829 [debug] [MainThread]: Command `dbt docs serve` failed at 14:24:00.762759 after 2.16 seconds
[0m14:24:00.763059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a2b3057290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a2a8501f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a2a87714c0>]}
[0m14:24:00.763416 [debug] [MainThread]: Flushing usage events
[0m14:24:01.406925 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:26.618160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96f4b0f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96f45a2a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96f4413e00>]}


============================== 14:24:26.620768 | 9b867c58-ccd3-47ce-846d-a3a21a7c39c9 ==============================
[0m14:24:26.620768 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:24:26.621152 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'introspect': 'True', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'debug': 'False', 'use_colors': 'True', 'profiles_dir': '/root/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'partial_parse': 'True', 'printer_width': '80', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'cache_selected_only': 'False'}
[0m14:24:26.784014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b867c58-ccd3-47ce-846d-a3a21a7c39c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96f6372630>]}
[0m14:24:26.829360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b867c58-ccd3-47ce-846d-a3a21a7c39c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96f45a2a20>]}
[0m14:24:28.377664 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m14:24:28.378908 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m14:24:28.379737 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.8018314, "process_in_blocks": "0", "process_kernel_time": 0.190531, "process_mem_max_rss": "131244", "process_out_blocks": "3360", "process_user_time": 1.219403}
[0m14:24:28.380111 [debug] [MainThread]: Command `dbt docs serve` failed at 14:24:28.380036 after 1.80 seconds
[0m14:24:28.380355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96f3f9f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96f7bd1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96f39c5f70>]}
[0m14:24:28.380633 [debug] [MainThread]: Flushing usage events
[0m14:24:29.448218 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:33.484929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e768dcea090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e768e320e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e768dce96a0>]}


============================== 14:24:33.487537 | 003f5a4e-3e1e-4207-bf63-0a40317d4bb0 ==============================
[0m14:24:33.487537 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:24:33.488004 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'no_print': 'None', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'introspect': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'version_check': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'fail_fast': 'False', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'debug': 'False', 'target_path': 'None', 'log_cache_events': 'False'}
[0m14:24:33.643746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '003f5a4e-3e1e-4207-bf63-0a40317d4bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e76838161e0>]}
[0m14:24:33.690800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '003f5a4e-3e1e-4207-bf63-0a40317d4bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e768e296840>]}
[0m14:24:33.692013 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:24:33.734183 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:24:33.798486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:24:33.798870 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:24:33.803136 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m14:24:33.824421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '003f5a4e-3e1e-4207-bf63-0a40317d4bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7683701970>]}
[0m14:24:33.835118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '003f5a4e-3e1e-4207-bf63-0a40317d4bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e768348d400>]}
[0m14:24:33.835494 [info ] [MainThread]: Found 7 models, 3 sources, 444 macros
[0m14:24:33.835809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '003f5a4e-3e1e-4207-bf63-0a40317d4bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7683701340>]}
[0m14:24:33.837252 [info ] [MainThread]: 
[0m14:24:33.837543 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:24:33.838216 [info ] [MainThread]: 
[0m14:24:33.839063 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:24:33.843671 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:24:33.870662 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:24:33.871056 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:24:33.871309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:33.884222 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m14:24:33.884754 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:24:33.884982 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:24:33.893235 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:24:33.894518 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:24:33.895349 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:24:33.895660 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:24:33.897332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '003f5a4e-3e1e-4207-bf63-0a40317d4bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e768d3dee10>]}
[0m14:24:33.899887 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m14:24:33.900180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m14:24:33.900378 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m14:24:33.906034 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m14:24:33.906586 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m14:24:33.907159 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m14:24:33.907449 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m14:24:33.907723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m14:24:33.907944 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m14:24:33.909447 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m14:24:33.910024 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m14:24:33.910514 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m14:24:33.911009 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m14:24:33.911422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m14:24:33.911829 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m14:24:33.913602 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m14:24:33.914002 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m14:24:33.914460 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m14:24:33.914787 [debug] [Thread-1 (]: Began running node model.store_pipeline.carts_dim
[0m14:24:33.915195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_users, now model.store_pipeline.carts_dim)
[0m14:24:33.915447 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.carts_dim
[0m14:24:33.917209 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.carts_dim"
[0m14:24:33.917898 [debug] [Thread-1 (]: Began executing node model.store_pipeline.carts_dim
[0m14:24:33.918362 [debug] [Thread-1 (]: Finished running node model.store_pipeline.carts_dim
[0m14:24:33.918632 [debug] [Thread-1 (]: Began running node model.store_pipeline.products_dim
[0m14:24:33.918941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.carts_dim, now model.store_pipeline.products_dim)
[0m14:24:33.919212 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.products_dim
[0m14:24:33.921021 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.products_dim"
[0m14:24:33.921372 [debug] [Thread-1 (]: Began executing node model.store_pipeline.products_dim
[0m14:24:33.921764 [debug] [Thread-1 (]: Finished running node model.store_pipeline.products_dim
[0m14:24:33.922034 [debug] [Thread-1 (]: Began running node model.store_pipeline.users_dim
[0m14:24:33.922377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.products_dim, now model.store_pipeline.users_dim)
[0m14:24:33.922600 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.users_dim
[0m14:24:33.924138 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.users_dim"
[0m14:24:33.924548 [debug] [Thread-1 (]: Began executing node model.store_pipeline.users_dim
[0m14:24:33.924996 [debug] [Thread-1 (]: Finished running node model.store_pipeline.users_dim
[0m14:24:33.925678 [debug] [Thread-1 (]: Began running node model.store_pipeline.fact_sales
[0m14:24:33.925937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.users_dim, now model.store_pipeline.fact_sales)
[0m14:24:33.926132 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.fact_sales
[0m14:24:33.928189 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.fact_sales"
[0m14:24:33.928534 [debug] [Thread-1 (]: Began executing node model.store_pipeline.fact_sales
[0m14:24:33.928938 [debug] [Thread-1 (]: Finished running node model.store_pipeline.fact_sales
[0m14:24:33.929858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:33.930064 [debug] [MainThread]: Connection 'model.store_pipeline.fact_sales' was properly closed.
[0m14:24:33.930917 [debug] [MainThread]: Command end result
[0m14:24:33.974670 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m14:24:33.975936 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m14:24:33.980815 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m14:24:33.982456 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m14:24:33.982677 [info ] [MainThread]: Building catalog
[0m14:24:33.989128 [debug] [ThreadPool]: Acquiring new duckdb connection 'dev.information_schema'
[0m14:24:33.993784 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m14:24:33.994119 [debug] [ThreadPool]: On dev.information_schema: BEGIN
[0m14:24:33.994298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:33.995278 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:24:33.995519 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m14:24:33.995860 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "dev.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dev'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dev'
    )
    select
        'dev' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m14:24:34.002198 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m14:24:34.005016 [debug] [ThreadPool]: On dev.information_schema: ROLLBACK
[0m14:24:34.005657 [debug] [ThreadPool]: Failed to rollback 'dev.information_schema'
[0m14:24:34.005919 [debug] [ThreadPool]: On dev.information_schema: Close
[0m14:24:34.015181 [debug] [MainThread]: Wrote artifact CatalogArtifact to /root/airflow/dags/store_pipeline/target/catalog.json
[0m14:24:34.026586 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m14:24:34.027877 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m14:24:34.028102 [info ] [MainThread]: Catalog written to /root/airflow/dags/store_pipeline/target/catalog.json
[0m14:24:34.028820 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.5834955, "process_in_blocks": "0", "process_kernel_time": 0.202993, "process_mem_max_rss": "151288", "process_out_blocks": "5344", "process_user_time": 1.463242}
[0m14:24:34.029153 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:24:34.029078 after 0.58 seconds
[0m14:24:34.029346 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:24:34.029494 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.
[0m14:24:34.029691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e768dce96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e768e2949e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e768299b860>]}
[0m14:24:34.029918 [debug] [MainThread]: Flushing usage events
[0m14:24:34.857125 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:37.483733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c30e4fa97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c30e562e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c30e48d6750>]}


============================== 14:24:37.486508 | 19d5d6fd-9de3-47d3-8291-e8bbe3102acd ==============================
[0m14:24:37.486508 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:24:37.487067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': '/root/.dbt', 'partial_parse': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'static_parser': 'True', 'debug': 'False', 'fail_fast': 'False', 'empty': 'None', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'log_format': 'default', 'cache_selected_only': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'use_colors': 'True'}
[0m14:24:37.646694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19d5d6fd-9de3-47d3-8291-e8bbe3102acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c30da8fbda0>]}
[0m14:24:37.692753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19d5d6fd-9de3-47d3-8291-e8bbe3102acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c30e48d7470>]}
[0m14:24:38.949274 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m14:24:38.951009 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m14:24:38.951819 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.5102615, "process_in_blocks": "0", "process_kernel_time": 0.16234, "process_mem_max_rss": "131356", "process_out_blocks": "3352", "process_user_time": 1.207147}
[0m14:24:38.952183 [debug] [MainThread]: Command `dbt docs serve` failed at 14:24:38.952111 after 1.51 seconds
[0m14:24:38.952421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c30e4e27a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c30da91eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c30da955f70>]}
[0m14:24:38.952641 [debug] [MainThread]: Flushing usage events
[0m14:24:39.773763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:04.894358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78833588cef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78833566a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78833544d820>]}


============================== 14:25:04.896702 | 57f3f7a2-96a7-4c89-b162-165af93c7e74 ==============================
[0m14:25:04.896702 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:25:04.897079 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'empty': 'None', 'debug': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs serve', 'profiles_dir': '/root/.dbt', 'target_path': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'version_check': 'True', 'fail_fast': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'write_json': 'True', 'partial_parse': 'True', 'use_colors': 'True'}
[0m14:25:05.053599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57f3f7a2-96a7-4c89-b162-165af93c7e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788334c3bbf0>]}
[0m14:25:05.099987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57f3f7a2-96a7-4c89-b162-165af93c7e74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788334d4aa20>]}
[0m14:25:06.319559 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m14:25:06.320883 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m14:25:06.321669 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.4672906, "process_in_blocks": "0", "process_kernel_time": 0.123361, "process_mem_max_rss": "131120", "process_out_blocks": "3360", "process_user_time": 1.220853}
[0m14:25:06.322318 [debug] [MainThread]: Command `dbt docs serve` failed at 14:25:06.322206 after 1.47 seconds
[0m14:25:06.322581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7883355d2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78832b1c5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788334d3b350>]}
[0m14:25:06.322840 [debug] [MainThread]: Flushing usage events
[0m14:25:07.192994 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:10.146058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770a1a5d67e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770a19e81b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770a1a185cd0>]}


============================== 14:25:10.148438 | d80bb2cc-0e33-4e21-96d9-ded7843e4d04 ==============================
[0m14:25:10.148438 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:25:10.149004 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'write_json': 'True', 'fail_fast': 'False', 'target_path': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'no_print': 'None', 'version_check': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt docs serve', 'warn_error': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'profiles_dir': '/root/.dbt', 'log_format': 'default', 'cache_selected_only': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'debug': 'False'}
[0m14:25:10.307893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd80bb2cc-0e33-4e21-96d9-ded7843e4d04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770a1989ec60>]}
[0m14:25:10.353824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd80bb2cc-0e33-4e21-96d9-ded7843e4d04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770a1c03d670>]}
[0m14:25:11.651594 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m14:25:11.652798 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m14:25:11.653614 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.5478091, "process_in_blocks": "0", "process_kernel_time": 0.123463, "process_mem_max_rss": "131016", "process_out_blocks": "3352", "process_user_time": 1.222285}
[0m14:25:11.653965 [debug] [MainThread]: Command `dbt docs serve` failed at 14:25:11.653888 after 1.55 seconds
[0m14:25:11.654205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770a19f685c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770a1a185a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770a0fc59fd0>]}
[0m14:25:11.654456 [debug] [MainThread]: Flushing usage events
[0m14:25:12.397987 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:14.294532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772035ea1460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772035717aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772035d7d1f0>]}


============================== 14:25:14.299705 | cfe7d253-8e17-4a37-9b2d-cf6c60af99eb ==============================
[0m14:25:14.299705 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:25:14.300178 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'invocation_command': 'dbt docs serve', 'use_colors': 'True', 'static_parser': 'True', 'version_check': 'True', 'empty': 'None', 'introspect': 'True', 'write_json': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'fail_fast': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'partial_parse': 'True', 'profiles_dir': '/root/.dbt'}
[0m14:25:14.467990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfe7d253-8e17-4a37-9b2d-cf6c60af99eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772034dc6e70>]}
[0m14:25:14.517494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfe7d253-8e17-4a37-9b2d-cf6c60af99eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77202b35cf20>]}
[0m14:25:16.954277 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m14:25:16.956085 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m14:25:16.956972 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 2.7067757, "process_in_blocks": "0", "process_kernel_time": 0.175565, "process_mem_max_rss": "131460", "process_out_blocks": "3344", "process_user_time": 1.308383}
[0m14:25:16.957359 [debug] [MainThread]: Command `dbt docs serve` failed at 14:25:16.957285 after 2.71 seconds
[0m14:25:16.957637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7720353fc260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772034e343b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77202b24a0c0>]}
[0m14:25:16.957880 [debug] [MainThread]: Flushing usage events
[0m14:25:17.772287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:29.796162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b749085a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7490adcce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7490adf5c0>]}


============================== 14:25:29.798624 | e15251e3-3226-4b1d-9452-766f354ab2d0 ==============================
[0m14:25:29.798624 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:25:29.799046 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'target_path': 'None', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt docs generate', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'empty': 'None', 'debug': 'False', 'log_format': 'default', 'write_json': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'profiles_dir': '/root/.dbt', 'log_cache_events': 'False', 'partial_parse': 'True'}
[0m14:25:29.956054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e15251e3-3226-4b1d-9452-766f354ab2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7485f30320>]}
[0m14:25:30.002931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e15251e3-3226-4b1d-9452-766f354ab2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7490efd580>]}
[0m14:25:30.003950 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:25:30.043596 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:25:30.108022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:30.108324 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:30.112595 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.store_pipeline.example
[0m14:25:30.130526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e15251e3-3226-4b1d-9452-766f354ab2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7485fee390>]}
[0m14:25:30.140646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e15251e3-3226-4b1d-9452-766f354ab2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7485d52ea0>]}
[0m14:25:30.141050 [info ] [MainThread]: Found 7 models, 3 sources, 444 macros
[0m14:25:30.141330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e15251e3-3226-4b1d-9452-766f354ab2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7485fc5040>]}
[0m14:25:30.142816 [info ] [MainThread]: 
[0m14:25:30.143190 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:25:30.143808 [info ] [MainThread]: 
[0m14:25:30.144528 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:25:30.148311 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:25:30.178923 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:25:30.179307 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:25:30.179536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:30.189818 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:25:30.190157 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:25:30.190338 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:25:30.197805 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:25:30.198847 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:25:30.199588 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:25:30.199785 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:25:30.201358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e15251e3-3226-4b1d-9452-766f354ab2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7485d0c440>]}
[0m14:25:30.203798 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_carts
[0m14:25:30.204077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.store_pipeline.stg_carts)
[0m14:25:30.204279 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_carts
[0m14:25:30.209760 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_carts"
[0m14:25:30.210379 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_carts
[0m14:25:30.210882 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_carts
[0m14:25:30.211149 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_products
[0m14:25:30.211411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_carts, now model.store_pipeline.stg_products)
[0m14:25:30.211624 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_products
[0m14:25:30.213248 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_products"
[0m14:25:30.213871 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_products
[0m14:25:30.214311 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_products
[0m14:25:30.214551 [debug] [Thread-1 (]: Began running node model.store_pipeline.stg_users
[0m14:25:30.214787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_products, now model.store_pipeline.stg_users)
[0m14:25:30.214990 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.stg_users
[0m14:25:30.216713 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.stg_users"
[0m14:25:30.217403 [debug] [Thread-1 (]: Began executing node model.store_pipeline.stg_users
[0m14:25:30.217824 [debug] [Thread-1 (]: Finished running node model.store_pipeline.stg_users
[0m14:25:30.218057 [debug] [Thread-1 (]: Began running node model.store_pipeline.carts_dim
[0m14:25:30.218393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.stg_users, now model.store_pipeline.carts_dim)
[0m14:25:30.218639 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.carts_dim
[0m14:25:30.221248 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.carts_dim"
[0m14:25:30.222127 [debug] [Thread-1 (]: Began executing node model.store_pipeline.carts_dim
[0m14:25:30.222699 [debug] [Thread-1 (]: Finished running node model.store_pipeline.carts_dim
[0m14:25:30.223005 [debug] [Thread-1 (]: Began running node model.store_pipeline.products_dim
[0m14:25:30.223313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.carts_dim, now model.store_pipeline.products_dim)
[0m14:25:30.223563 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.products_dim
[0m14:25:30.225475 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.products_dim"
[0m14:25:30.225849 [debug] [Thread-1 (]: Began executing node model.store_pipeline.products_dim
[0m14:25:30.226230 [debug] [Thread-1 (]: Finished running node model.store_pipeline.products_dim
[0m14:25:30.226458 [debug] [Thread-1 (]: Began running node model.store_pipeline.users_dim
[0m14:25:30.226742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.products_dim, now model.store_pipeline.users_dim)
[0m14:25:30.227099 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.users_dim
[0m14:25:30.228887 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.users_dim"
[0m14:25:30.229262 [debug] [Thread-1 (]: Began executing node model.store_pipeline.users_dim
[0m14:25:30.229646 [debug] [Thread-1 (]: Finished running node model.store_pipeline.users_dim
[0m14:25:30.230402 [debug] [Thread-1 (]: Began running node model.store_pipeline.fact_sales
[0m14:25:30.230673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.store_pipeline.users_dim, now model.store_pipeline.fact_sales)
[0m14:25:30.230888 [debug] [Thread-1 (]: Began compiling node model.store_pipeline.fact_sales
[0m14:25:30.232828 [debug] [Thread-1 (]: Writing injected SQL for node "model.store_pipeline.fact_sales"
[0m14:25:30.233264 [debug] [Thread-1 (]: Began executing node model.store_pipeline.fact_sales
[0m14:25:30.233651 [debug] [Thread-1 (]: Finished running node model.store_pipeline.fact_sales
[0m14:25:30.235003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:30.235652 [debug] [MainThread]: Connection 'model.store_pipeline.fact_sales' was properly closed.
[0m14:25:30.237241 [debug] [MainThread]: Command end result
[0m14:25:30.283842 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m14:25:30.285141 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m14:25:30.290050 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/airflow/dags/store_pipeline/target/run_results.json
[0m14:25:30.291842 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m14:25:30.292104 [info ] [MainThread]: Building catalog
[0m14:25:30.300002 [debug] [ThreadPool]: Acquiring new duckdb connection 'dev.information_schema'
[0m14:25:30.304196 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m14:25:30.304556 [debug] [ThreadPool]: On dev.information_schema: BEGIN
[0m14:25:30.304944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:30.305641 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:25:30.305819 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m14:25:30.305975 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "store_pipeline", "target_name": "dev", "connection_name": "dev.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dev'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dev'
    )
    select
        'dev' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m14:25:30.310715 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m14:25:30.313901 [debug] [ThreadPool]: On dev.information_schema: ROLLBACK
[0m14:25:30.314617 [debug] [ThreadPool]: Failed to rollback 'dev.information_schema'
[0m14:25:30.314853 [debug] [ThreadPool]: On dev.information_schema: Close
[0m14:25:30.325092 [debug] [MainThread]: Wrote artifact CatalogArtifact to /root/airflow/dags/store_pipeline/target/catalog.json
[0m14:25:30.336494 [debug] [MainThread]: Wrote artifact WritableManifest to /root/airflow/dags/store_pipeline/target/manifest.json
[0m14:25:30.337889 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/airflow/dags/store_pipeline/target/semantic_manifest.json
[0m14:25:30.338175 [info ] [MainThread]: Catalog written to /root/airflow/dags/store_pipeline/target/catalog.json
[0m14:25:30.338968 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.5845497, "process_in_blocks": "0", "process_kernel_time": 0.162116, "process_mem_max_rss": "150980", "process_out_blocks": "5344", "process_user_time": 1.471521}
[0m14:25:30.339316 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:25:30.339248 after 0.59 seconds
[0m14:25:30.339502 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:25:30.339681 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.
[0m14:25:30.339864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b748fd17860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b748fd173e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7484f6a390>]}
[0m14:25:30.340089 [debug] [MainThread]: Flushing usage events
[0m14:25:31.196264 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:36.065245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a65024c2cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6501d97b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6501e0ee40>]}


============================== 14:25:36.067761 | 9b18cedf-3c4d-45fe-bc8f-44671823471c ==============================
[0m14:25:36.067761 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:25:36.068127 [debug] [MainThread]: running dbt with arguments {'log_path': '/root/airflow/dags/store_pipeline/logs', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'no_print': 'None', 'printer_width': '80', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'empty': 'None', 'profiles_dir': '/root/.dbt', 'write_json': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'version_check': 'True', 'indirect_selection': 'eager'}
[0m14:25:36.223500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b18cedf-3c4d-45fe-bc8f-44671823471c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a65016503b0>]}
[0m14:25:36.268668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b18cedf-3c4d-45fe-bc8f-44671823471c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6501653710>]}
[0m14:25:44.249107 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m14:25:44.250361 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m14:25:44.251242 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 8.2255535, "process_in_blocks": "0", "process_kernel_time": 0.265261, "process_mem_max_rss": "130904", "process_out_blocks": "3360", "process_user_time": 1.283523}
[0m14:25:44.251631 [debug] [MainThread]: Command `dbt docs serve` failed at 14:25:44.251549 after 8.23 seconds
[0m14:25:44.251900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6501c03bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a64f7a785c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a64f7bd8950>]}
[0m14:25:44.252156 [debug] [MainThread]: Flushing usage events
[0m14:25:45.223004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:55.563850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b52948da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b5177f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b518231a0>]}


============================== 14:25:55.566446 | 51fb67d4-495f-4d60-85d8-c0cf9541fc08 ==============================
[0m14:25:55.566446 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:25:55.566820 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'quiet': 'False', 'version_check': 'True', 'write_json': 'True', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'cache_selected_only': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs serve', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_format': 'default', 'static_parser': 'True', 'no_print': 'None', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'printer_width': '80', 'empty': 'None', 'log_cache_events': 'False', 'fail_fast': 'False'}
[0m14:25:55.722812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51fb67d4-495f-4d60-85d8-c0cf9541fc08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b51cfba40>]}
[0m14:25:55.769355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51fb67d4-495f-4d60-85d8-c0cf9541fc08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b519c1d60>]}
[0m14:25:57.051217 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m14:25:57.052384 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m14:25:57.053135 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.5297111, "process_in_blocks": "0", "process_kernel_time": 0.136334, "process_mem_max_rss": "131140", "process_out_blocks": "3360", "process_user_time": 1.273879}
[0m14:25:57.053471 [debug] [MainThread]: Command `dbt docs serve` failed at 14:25:57.053396 after 1.53 seconds
[0m14:25:57.053695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b53204cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b50e2d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785b5169bfb0>]}
[0m14:25:57.053914 [debug] [MainThread]: Flushing usage events
[0m14:25:57.832351 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:26:31.343087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bad8b42db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bad9962000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bad9e62c30>]}


============================== 14:26:31.345509 | 89f19dbf-54f4-4561-bc70-40975eb59329 ==============================
[0m14:26:31.345509 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:26:31.345889 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'printer_width': '80', 'target_path': 'None', 'no_print': 'None', 'invocation_command': 'dbt docs serve', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_path': '/root/airflow/dags/store_pipeline/logs', 'write_json': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'partial_parse': 'True', 'quiet': 'False', 'log_format': 'default', 'log_cache_events': 'False'}
[0m14:26:31.501083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89f19dbf-54f4-4561-bc70-40975eb59329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bad792a0f0>]}
[0m14:26:31.548765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89f19dbf-54f4-4561-bc70-40975eb59329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bad6d64950>]}
[0m14:28:31.800070 [error] [MainThread]: Encountered an error:

[0m14:28:31.801547 [error] [MainThread]: Traceback (most recent call last):
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/root/env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m14:28:31.802745 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 116.09513, "process_in_blocks": "0", "process_kernel_time": 0.228921, "process_mem_max_rss": "131760", "process_out_blocks": "3368", "process_user_time": 1.235314}
[0m14:28:31.803385 [debug] [MainThread]: Command `dbt docs serve` failed at 14:28:31.803302 after 116.10 seconds
[0m14:28:31.803658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bad7472030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bad78183e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bad7e04fe0>]}
[0m14:28:31.803884 [debug] [MainThread]: Flushing usage events
